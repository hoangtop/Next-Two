"use strict";function FocusControllerProvider(a){function b(a,b){return angular.isFunction(b)?(a.push(b),!0):!1}function c(a,b){var c=a.indexOf(b);return c>-1?(a.splice(c,1),!0):!1}function d(a,c){return b(o,a)?(a.order=c||0,o.sort(e),!0):!1}function e(a,b){return a.order-b.order}function f(a){return b(p,a)}function g(a){return c(o,a)}function h(a){return c(p,a)}function i(){return angular.copy(n)}var j=".focus-controller",k="group:",l=a.DEFAULT.DEPTH,m={},n=a.DEFAULT.KEY_MAP,o=[],p=[],q=!1;m[a.DEFAULT.DEPTH]=a.DEFAULT.GROUP,this.setInitialDepth=function(a){return l=a,this},this.setInitialGroupOfDepth=function(b,c){var d={};return void 0===c&&(c=b,b=a.DEFAULT.DEPTH),angular.isObject(c)?d=c:d[b]=c,angular.extend(m,d),this},this.setKeyMap=function(a){return angular.extend(n,a),this},this.getKeyMap=i,this.addBeforeKeydownHandler=d,this.addAfterKeydownHandler=f,this.removeBeforeKeydownHandler=g,this.removeAfterKeydownHandler=h,this.setFocusWhenDisabled=function(a){return q=a,this},this.isFocusWhenDisabled=function(){return q},this.$get=["$rootScope","$window","$document","$timeout","$animate","FocusUtil","nearestFocusableFinder",function(b,c,e,r,s,t,u){function v(a){var b,c,d,e;if(H){if(c=t.getData(H).nextFocus[a],void 0===c)return u.getNearest(H,a);if(c){if(0===c.indexOf(k))return c.replace(k,"");if(d=u.$$get(c),t.isVisible(d)&&(e=t.getData(d),(!e.disabled||q)&&t.getData(H).depth===e.depth))return d}return null}return b=C(L),b?b:w()}function w(a,b){return C(K,a,b)||u.getInitial(D(a),E(b))}function x(a,b){var c;t.isFocusable(a=t.getElement(a))&&(c=t.getData(a),c.depth===I&&(A(a,"blurred",[b]),a===H&&(B(L,a),H=null)))}function y(a,b){var c;t.isFocusable(a=t.getElement(a))&&a!==H&&(c=t.getData(a),c.depth!==I||c.disabled&&!q||(H&&x(H,b),A(a,"focused",[b]),J=c.group,H=a))}function z(a,b){t.isFocusable(a=t.getElement(a))&&t.isVisible(a)?a!==H||t.getData(a).disabled?y(a,b):A(a,"selected",[b]):(a=C(L),a?y(a,b):y(a=w(),b))}function A(a,b,c){a&&jQuery(a).trigger(b,c)}function B(a,b,c,d){c=D(c),d=E(d),a[c]=a[c]||{},a[c][d]=b}function C(a,b,c){var d;return b=D(b),c=E(c),!t.isVisible(d=a[b]&&a[b][c])||t.getData(d).disabled&&!q?null:d}function D(a){return void 0===a?I:a}function E(a){return void 0===a?J:a}function F(a){return a?angular.isString(a)?u.$$get(a):a:H}function G(a,b,c){var d;t.isFocusable(a=t.getElement(a))&&(d=t.getData(a),d.disabled!==b&&(d.disabled=b,t.setData(a,d),c&&c(a)))}var H,I=l,J=m[l]||a.DEFAULT.GROUP,K={},L={},M={getCurrentDepth:function(){return I},getCurrentGroup:function(){return J},getCurrentFocusItem:function(){return H},setDepth:function(b,c,d){var e,f;return angular.isNumber(b)&&I!==b&&(e=d===!1?w(b,f=m[b]||a.DEFAULT.GROUP):C(L,b,f=c||m[b]||a.DEFAULT.GROUP)||w(b,f),e&&(x(H),I=b,J=f,y(e))),this},setGroup:function(a){var b;return a&&J!==a&&(b=C(L,I,a)||w(I,a))&&(x(H),J=a,y(b)),this},focus:function(a,b){return y(F(a),b),this},blur:function(a,b){return x(F(a),b),this},select:function(a,b){return z(F(a),b),this},enable:function(a){return G(F(a),!1,function(a){s.removeClass(a,"disabled")}),this},disable:function(a){return G(F(a),!0,function(a){a===H&&x(H,jQuery.Event("disabled")),s.addClass(a,"disabled")}),this},addBeforeKeydownHandler:d,addAfterKeydownHandler:f,removeBeforeKeydownHandler:g,removeAfterKeydownHandler:h,getKeyMap:i,$$getNextFocusItem:v,$$getInitialFocusItem:w,$$setInitialFocusItem:function(a){var b;return t.isFocusable(a=t.getElement(a))&&(b=t.getData(a),b.initialFocus&&B(K,a,b.depth,b.group)),this}};return jQuery(c).on("load",function(a){r(function(){y(C(K),a)})}),e.on("keydown"+j,function(c){var d,e=c.keyCode||c.which||c.charCode;if(o.some(function(a){return a({event:c,previousFocusedItem:C(L),currentFocusItem:H},M)===!1}))return void b.$applyAsync();switch(e){case n.LEFT:d=v(a.DIRECTION.LEFT);break;case n.RIGHT:d=v(a.DIRECTION.RIGHT);break;case n.UP:d=v(a.DIRECTION.UP);break;case n.DOWN:d=v(a.DIRECTION.DOWN);break;case n.ENTER:z(H,c)}d&&(angular.isString(d)?M.setGroup(d):(x(H,c),y(d,c))),p.forEach(function(a){a({event:c,previousFocusedItem:C(L),currentFocusItem:H},M)}),b.$applyAsync()}),b.$on("$destroy",function(){e.off(j)}),M}]}function NearestFocusableFinderProvider(a,b){function c(a){var b=jQuery(a),c=b.offset();return{left:c.left,top:c.top,width:b.width(),height:b.height()}}var d={},e=[],f=a.DEFAULT.DISTANCE_CALCULATION_STRATEGY;d[a.DEFAULT.DISTANCE_CALCULATION_STRATEGY]=function(){function b(b,c){var d={x:b.left,y:b.top};switch(c){case a.DIRECTION.RIGHT:d.x+=b.width;case a.DIRECTION.LEFT:d.y+=b.height/2;break;case a.DIRECTION.DOWN:d.y+=b.height;case a.DIRECTION.UP:d.x+=b.width/2}return d}function c(b,c,d){switch(d){case a.DIRECTION.LEFT:return b.x>=c.x;case a.DIRECTION.RIGHT:return b.x<=c.x;case a.DIRECTION.UP:return b.y>=c.y;case a.DIRECTION.DOWN:return b.y<=c.y}return!1}var d={left:"right",right:"left",up:"down",down:"up"};return function(a,e,f){var g=b(a,f),h=b(e,d[f]);return c(g,h,f)?Math.sqrt(Math.pow(g.x-h.x,2)+Math.pow(g.y-h.y,2)):1/0}}(),this.registerDistanceCalculationStrategy=function(a,b,c){if(c===!1&&angular.isFunction(d[a]))throw new Error('The given name "'+a+'" is already registered. If you want to override it, please do not pass the third parameter.');return d[a]=b,this},this.useDistanceCalculationStrategy=function(b){return b?angular.isFunction(d[b])?f=b:void 0:f=a.DEFAULT.DISTANCE_CALCULATION_STRATEGY,this},this.getRegisteredDistanceCalculationStrategies=function(){return Object.keys(d)},this.getCurrentDistanceCalculationStrategy=function(){return f},this.addBeforeDistanceCalculationHandler=function(a){return angular.isFunction(a)?(e.push(a),!0):!1},this.removeBeforeDistanceCalculationHandler=function(a){var b=e.indexOf(a);return b>-1?(e.splice(b,1),!0):!1},this.$get=["$rootScope","$document","FocusUtil",function(g,h,i){var j,k=Array.prototype.slice,l={},m={getInitial:function(c,d){var e;return c=c||a.DEFAULT.DEPTH,d=d||a.DEFAULT.GROUP,Object.keys(l).some(function(a){var f=l[a],g=i.getData(f);return!i.isVisible(f)||g.disabled&&!b.isFocusWhenDisabled()||g.depth!==c||g.group!==d?void 0:(e=f,!0)}),e},getNearest:function(a,g){var h,j,k,m,n,o=1/0;return i.isFocusable(a=i.getElement(a))&&(n=i.getData(a))&&(k=c(a),Object.keys(l).forEach(function(p){var q=l[p],r=i.getData(q);if(q!==a&&i.isVisible(q)&&(!r.disabled||b.isFocusWhenDisabled())&&n.depth===r.depth){if(e.some(function(a){return a(q)===!1}))return;m=c(q),h=d[f](k,m,g),o>h&&(j=q,o=h)}})),j},$$put:function(a,b){var c;return i.isFocusable(a=i.getElement(a))&&(c=i.setData(a,b))&&(l[c]=i.getElement(a)),this},$$get:function(a){return l[a]},$$remove:function(a){var b,c;return angular.isString(a)||(a=i.getData(a)),a&&(b=a.name,c=l[b],c&&delete l[b]),c}};return window.MutationObserver&&(j=new MutationObserver(function(a){a.forEach(function(a){"childList"===a.type&&k.call(a.removedNodes).forEach(function(a){i.isElement(a)&&i.isFocusable(a)&&i.unbindEvent(m.$$remove(a))})})}),j.observe(h[0],{childList:!0,subtree:!0}),g.$on("$destroy",function(){j.disconnect()})),m}]}function ListItemLoaderProvider(a){function b(a){this.url=a.url,this.method=a.method||"JSONP",this.headers=a.headers,this.parameterNames=angular.extend({},e,a.parameterNames||{}),this.loadingCount=a.loadingCount,this.thresholdCount=a.thresholdCount,this.onGetTotalCount=a.getTotalCount||angular.noop,this.onGetItems=a.getItems||angular.identity,this.onBeforeLoad=a.onBeforeLoad||angular.noop,this.onAfterLoad=a.onAfterLoad||angular.noop,this.items=[],this.totalCount,this.loading=!1,this.offset=0,this.http,this.initiailzed=!1}function c(a,b,c){var d=0,e=[];for(b=b||0,c=c||a.length;c>b;)e[d++]=a[b++];return e}var d={},e={page:"page",offset:"offset",count:"count",callback:"callback"};a.addBeforeKeydownHandler(function(){return Object.keys(d).some(function(a){return d[a].isLoading()?!0:void 0})?!1:void 0},-1e3),b.prototype.isInitialized=function(){return this.initiailzed},b.prototype.isLoading=function(){return this.loading},b.prototype.getTotalCount=function(){return this.totalCount},b.prototype.getCurrentCount=function(){return this.items.length},b.prototype.getLoadingCount=function(){return this.loadingCount},b.prototype.setLoadingCount=function(a){return this.loadingCount||(this.loadingCount=a),this},b.prototype.getThresholdCount=function(){return this.thresholdCount},b.prototype.setThresholdCount=function(a){return this.thresholdCount||(this.thresholdCount=a),this},b.prototype.getOffset=function(){return this.offset},b.prototype.setOffset=function(a){return this.offset=a,this},b.prototype.setHttp=function(a){return this.http=a,this},b.prototype.initialize=function(a){this.initiailzed||this.loading||this.request(function(b,c,d){if(this.append(b),this.offset+=this.loadingCount,this.totalCount=this.onGetTotalCount(c,d),null==this.totalCount)throw new Error('Check the "getTotalCount" callback function. It should return total item count as a number.');this.initiailzed=!0,(a||angular.noop)(b,this.totalCount,c,d,this)}.bind(this))},b.prototype.beforeRequest=function(){this.loading=!0,this.onBeforeLoad(this)},b.prototype.afterRequest=function(a,b){if(this.onAfterLoad(a,b,this),this.loading=!1,!this.initiailzed)throw new Error("Fail to request. Please check the given url or connection.")},b.prototype.request=function(a){this.loading||(this.beforeRequest(),this.http({url:this.url,method:this.method,headers:this.headers,params:this.getParams()}).success(function(b,c){var d=this.onGetItems(b);d&&d.length>0&&(a||angular.noop)(d,b,c,this),this.afterRequest(b,c)}.bind(this)).error(function(a,b){this.afterRequest(a,b)}.bind(this)))},b.prototype.getParams=function(){var a={};return a[this.parameterNames.page]=Math.floor(this.offset/this.loadingCount)+1,a[this.parameterNames.offset]=this.offset,a[this.parameterNames.count]=this.loadingCount,a[this.parameterNames.callback]="JSON_CALLBACK",a},b.prototype.isNeededForPrevious=function(a){var b=this.offset-2*this.loadingCount;return b>0&&a<b+this.thresholdCount},b.prototype.isNeededForNext=function(a){var b=this.getCurrentCount();return b<this.getTotalCount()&&b-this.thresholdCount<a},b.prototype.get=function(a){if(!this.initiailzed)throw new Error("Do not ready to use. Please use after initializing properly. Also verify whether the given url is available or not.");return this.items[a]},b.prototype.prepend=function(a){var b;this.offset>0&&(b=[],b.length=this.offset-2*this.loadingCount,this.items=b.concat(a).concat(c(this.items,this.offset-this.loadingCount,this.offset)))},b.prototype.append=function(a){var b,d;this.offset>this.loadingCount?(d=this.offset-this.loadingCount,b=[],b.length=d,this.items=b.concat(c(this.items,d)).concat(a)):this.items=this.items.concat(a)},this.register=function(a,c){if(d[a])throw new Error("The given name "+a+" already has been registered.");return d[a]=new b(c||{}),this},this.unregister=function(a){return delete d[a],this},this.$get=["$http",function(a){return{get:function(b){var c=d[b];return c&&!c.isInitialized()&&c.setHttp(a),c}}}]}function Controller($rootScope,$scope,$state,$timeout,$document,FocusUtil,FocusConstant,focusController,CONSTANT,DataService,$http,UltilService,VideoService,Principal,LoginService,Auth,toaster){function main(){setInternetConnectionTimer(),processKeydownEvent(),$timeout(function(){DataService.getChannelList().then(function(channelList){allChannelList=channelList,updateCategoryListData(channelList,0,!0),isChannelListLoaded=!0,isChannelListLoaded&&isVodListLoaded&&isSeriesVodLoaded&&processSpotlightVodList()},function(response){}),DataService.getMenuCategories().then(function(menus){$scope.menuArray=menus,noCategoryInHome=menus[0].children.length;for(var homeCategoryNameList=[],index=1;index<menus[0].children.length;index++){var menuItem=menus[0].children[index];homeCategoryNameList.push({index:index,name:menuItem["this"].name[0].text})}$scope.homeCategoryNameList=homeCategoryNameList;for(var index=1;index<menus[0].children.length;index++){var menuItem=menus[0].children[index];UltilService.isSeriesCategory(menuItem)?processSeriesVODList(index,menuItem,UltilService.getVodCategoryId(menuItem)):processVODList(menuItem,index)}$scope.focusedMenu=menus[0]},function(){})},CONSTANT.EFFECT_DELAY_TIME)}function setInternetConnectionTimer(){setInterval(function(){isOnline=navigator.onLine,isOnline?lastOnlineStatus||(lastOnlineStatus=!0,$timeout(function(){$scope.warning.show=!1},300)):(lastOnlineStatus=!1,showNetworkDisconnectedWarning())},1500)}function processSpotlightVodList(){if(!isGotSpotlight){var vodIdList="";angular.forEach(CONSTANT.SPOTLIGHT_VOD_LIST,function(item,key){vodIdList=vodIdList+item.vodId+","}),vodIdList=vodIdList.substr(0,vodIdList.length-1),DataService.getVodMoreInfoByProgramIdList(vodIdList).then(function(spotlightVodList){$timeout(function(){$scope.isInitCompleted=!0,$scope.isOverviewDark=!1,spotlightVodList[0].bigPhotoUrl=CONSTANT.SPOTLIGHT_VOD_LIST[0].img,spotlightVodList[0].photoUrl=CONSTANT.SPOTLIGHT_VOD_LIST[0].img,spotlightVodList[0].isSpotlight=!0,currentSpotlight=spotlightVodList[0],$scope.overview=spotlightVodList[0],$scope.lastOverview=$scope.overview,focusController.focus("btnView")},4e3)},function(){}),isGotSpotlight=!0}}function processVODList(menuItem,index){DataService.getVodListByCategoryId(UltilService.getVodCategoryId(menuItem)).then(function(response){var vodList=response;vodList&&(updateCategoryListData(vodList,index,!0),isVodListLoaded=!0,isChannelListLoaded&&isVodListLoaded&&isSeriesVodLoaded&&processSpotlightVodList())},function(response){setTimeout(function(){processVODList(menuItem,index)},200)})}function processSeriesVODList(index,menuItem,categoryId){DataService.getSeriesVodList(categoryId,16).then(function(response){var seriesVodList=response;seriesVodList&&(updateCategoryListData(seriesVodList,index,!0),isSeriesVodLoaded=!0,isChannelListLoaded&&isVodListLoaded&&isSeriesVodLoaded&&processSpotlightVodList())},function(response){setTimeout(function(){processSeriesVODList(index,menuItem,categoryId)},200)})}function onScrollStart(){isScrolling=!0}function onScrollFinish(){isScrolling=!1,updateOverview()}function toggleIsPlaying(isPlaying){$scope.$applyAsync(function(){$scope.isPlaying=isPlaying})}function onVodFocused($event,category,data,$index){if(currentCategoryInHome=category,$scope.currentDepth===$scope.DEPTH.INDEX){$scope.episodePlaylist=[],$scope.currentDetailRelatedList=null,$scope.currentDetailEpisodeList=null,$scope.currentDepthZone=$scope.DEPTH_ZONE.INDEX.CATEGORY;var scrollCount=category;if(moveContainer(category,"list-category",-CONSTANT.SCROLL_HEIGHT_OF_INDEX*scrollCount+160),!data||!data||data.loaded===!1)return;var item=data;currentItemData=item,("undefined"==typeof $scope.currentDetailOverview||null===$scope.currentDetailOverview||"undefined"!=typeof $scope.currentDetailOverview&&item.program.id!==$scope.currentDetailOverview.program.id)&&setVodDetailPackground(currentItemData.bigPhotoUrl),$scope.currentDetailOverview=null,isScrolling===!1&&updateOverview(),lastFocusedGroup=FocusUtil.getData($event.currentTarget).group}}function onRelatedVodFocused($event,category,data,$index){$scope.bgGradient1=CONSTANT.CATEGORY_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.CATEGORY_BG_GRADIENT2,$scope.bgSize=CONSTANT.CATEGORY_BG_SIZE,currentItemData=data,$timeout(function(){$scope.bgImgCoverOpacity=0,$scope.bgImgUrl=currentItemData.photoUrl},400),isScrolling===!1&&updateOverview()}function onCategoryVodFocused($event,data,element,$index){if(data&&data&&data.loaded!==!1){$scope.isVodCategoryOpened=!0,currentItemData=data,isScrolling===!1&&updateOverview();var itemHeight,vodList=$scope.selectedSidebarCategory.vodListByCategory,showElements=$(".category-vod-item:not(.item-fadeout)"),hideElements=$(".category-vod-item.item-fadeout"),isItemInView=!1,isItemBeforeView=!1,isItemAfterView=!1,isLoadMoreItems=!1,noItemPerRow=8,noItemInView=2;$scope.currentDepthZone===$scope.DEPTH_ZONE.CATEGORY.VOD?(noItemPerRow=8,itemHeight=307,noItemInView=2):(noItemPerRow=5,itemHeight=177,noItemInView=3);for(var currentRowCount=Math.floor($index/noItemPerRow),index=0;noItemPerRow*noItemInView>index;index++)showElements[index]&&showElements[index].id==="category-vod-item-"+$index&&(isItemInView=!0);for(var index=0;index<hideElements.length;index++)hideElements[index].id==="category-vod-item-"+$index&&(isItemBeforeView=!0);if(isItemInView||isItemBeforeView||(isItemAfterView=!0),$scope.currentDepthZone===$scope.DEPTH_ZONE.CATEGORY.VOD&&vodList.length-$index<=noItemPerRow&&vodList.length-$index>0&&isItemAfterView&&(isLoadMoreItems=!0),isLoadMoreItems)getMoreVodsInCategory(function(){moveCategoryVodContainer($scope.currentDepthZone===$scope.DEPTH_ZONE.CATEGORY.VOD?-(currentRowCount-1)*itemHeight-5:-(currentRowCount-2)*(itemHeight+7));for(var index=0;noItemPerRow>index;index++){var ele=showElements[index];$(ele).addClass("item-fadeout")}});else if(isItemAfterView&&!isLoadMoreItems){moveCategoryVodContainer($scope.currentDepthZone===$scope.DEPTH_ZONE.CATEGORY.VOD?-(currentRowCount-1)*itemHeight-5:-(currentRowCount-2)*(itemHeight+7));for(var index=0;noItemPerRow>index;index++){var ele=showElements[index];$(ele).addClass("item-fadeout")}}else if(isItemBeforeView){moveCategoryVodContainer(-currentRowCount*(itemHeight+7));for(var index=$index-$index%noItemPerRow;$index-$index%noItemPerRow+noItemPerRow>index;index++){var ele=$("#category-vod-item-"+index);ele.removeClass("item-fadeout")}}setMenuFocusedPackground("images/menu_bg_focused_"+$scope.selectedCategoryMenuIndex+".jpg"),lastFocusedGroup=FocusUtil.getData($event.currentTarget).group,categoryVodFocusedGroup=FocusUtil.getData($event.currentTarget).group}}function onEpisodeVodFocused($event,category,data,$index){data&&data.item&&data.item.loaded!==!1&&($scope.bgGradient1=CONSTANT.CATEGORY_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.CATEGORY_BG_GRADIENT2,$scope.bgSize=CONSTANT.CATEGORY_BG_SIZE,currentItemData=data.item,$timeout(function(){$scope.bgImgCoverOpacity=0,$scope.bgImgUrl=currentItemData.photoUrl},400),isScrolling===!1&&updateOverview())}function onCategoryMenuFocused($event,category,data,$index){if($scope.currentDepth===$scope.DEPTH.INDEX){if($scope.currentDepthZone=$scope.DEPTH_ZONE.INDEX.CATEGORY,!data||!data.item||data.item.loaded===!1)return;currentItemData=data.item,$scope.focusedMenu=currentItemData,setMenuFocusedPackground("images/menu_bg_focused_"+$index+".jpg"),categoryVodFocusedGroup="",lastFocusedGroup=FocusUtil.getData($event.currentTarget).group,categoryMenuFocusedGroup=FocusUtil.getData($event.currentTarget).group}}function onChannelFocused($event,category,data,$index){if($scope.currentDepth===$scope.DEPTH.INDEX){$scope.isOverviewDark=!1,$scope.bgImgCoverOpacity=.3,$scope.bgImgCoverWidth="100%",$scope.currentDepthZone=$scope.DEPTH_ZONE.INDEX.CHANNEL;if(moveContainer(category,"list-category",-72),!data||!data.item||data.item.loaded===!1)return;$scope.overview=data.item,currentItemData=data.item,$scope.bgImgUrl=CONSTANT.SPOTLIGHT_BG_IMG_URL,$scope.bgGradient1=CONSTANT.SPOTLIGHT_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.SPOTLIGHT_BG_GRADIENT2,$scope.bgSize=CONSTANT.SPOTLIGHT_BG_SIZE}}function onVodBlurred($event,category,data){}function onCategoryMenuSelected($event,category,data,$index){data&&data.item&&data.item.loaded!==!1&&(0===$index?moveToSpotlightDown():1===$index?($scope.overview=null,$scope.sidebarCategories=CONSTANT.CHANNEL_CATEGORY_LIST,$scope.selectedCategoryMenu=data.item["this"].name[0].text,$scope.selectedCategoryMenuIndex=$index,$scope.vodListByCategory=[],$scope.isMainLoaderShown=!0,changeDepth($scope.DEPTH.CATEGORY,function(){$timeout(function(){focusController.focus(document.getElementById("sidebar-category-item-0"))},300)}),$scope.currentDepthZone=$scope.DEPTH_ZONE.CATEGORY.CHANNEL,lastFocusedGroup=FocusUtil.getData($event.currentTarget).group):($scope.overview=null,$scope.sidebarCategories=data.item.children,$scope.selectedCategoryMenu=data.item["this"].name[0].text,$scope.selectedCategoryMenuIndex=$index,$scope.vodListByCategory=[],$scope.isMainLoaderShown=!0,changeDepth($scope.DEPTH.CATEGORY,function(){focusController.focus(document.getElementById("sidebar-category-item-0"))}),$scope.currentDepthZone=$scope.DEPTH_ZONE.CATEGORY.VOD,lastFocusedGroup=FocusUtil.getData($event.currentTarget).group))}function setSpotlightPackground(bgrUrl,callback){$scope.bgImgCoverOpacity=1,$scope.bgImgCoverWidth="100%",$timeout(function(){$scope.bgGradient1=CONSTANT.SPOTLIGHT_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.SPOTLIGHT_BG_GRADIENT2,$scope.bgSize=CONSTANT.SPOTLIGHT_BG_SIZE,$scope.bgImgCoverOpacity=0,bgrUrl?$scope.bgImgUrl=bgrUrl:$scope.bgImgUrl=CONSTANT.SPOTLIGHT_BG_IMG_URL,callback&&callback()},CONSTANT.EFFECT_DELAY_TIME)}function moveToSpotlightDown(){$scope.currentDepthZone=$scope.DEPTH_ZONE.INDEX.SPOTLIGHT,setSpotlightPackground(currentSpotlight.bigPhotoUrl,function(){focusController.focus("btnView")}),$(".menu-container ").css({transform:"translate3d(0,-1080px,0)"}),$(".overview-container ").css({transform:"translate3d(0,0px,0)"}),$(".list-category").css({transform:"translate3d(0,0px,0)"})}function moveToCategoryMenu(){$(".menu-container ").css({transform:"translate3d(0,0px,0)"}),$(".overview-container ").css({transform:"translate3d(0,1080px,0)"}),$(".list-category").css({transform:"translate3d(0,1080px,0)"})}function setVodDetailPackground(bgrUrl){$scope.bgGradient1=CONSTANT.VOD_DETAIL_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.VOD_DETAIL_BG_GRADIENT2,$scope.bgSize=CONSTANT.VOD_DETAIL_BG_SIZE,$scope.bgImgCoverOpacity=1,$scope.bgImgCoverWidth="100%",$timeout(function(){$scope.bgImgCoverOpacity=0,bgrUrl?$scope.bgImgUrl=bgrUrl:$scope.bgImgUrl=CONSTANT.VOD_DETAIL_BG_IMG_URL},400)}function setMenuFocusedPackground(bgrUrl){$scope.bgGradient1=CONSTANT.MENU_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.MENU_BG_GRADIENT2,$scope.bgSize=CONSTANT.MENU_BG_SIZE,$scope.bgImgCoverOpacity=1,$scope.bgImgCoverWidth="100%",$timeout(function(){$scope.bgImgCoverOpacity=0,bgrUrl?$scope.bgImgUrl=bgrUrl:$scope.bgImgUrl=CONSTANT.MENU_BG_IMG_URL},400)}function onSidebarCategoryFocused($event,item,$index){if($scope.isVodCategoryOpened=!1,item)if($scope.selectedSidebarCategory=item,$scope.vodListByCategory=[],$scope.isVodCategoryOpened=!1,moveCategoryVodContainer(0),$(".item-fadeout").removeClass("item-fadeout"),item.vodListByCategory&&item.vodListByCategory.length>0)$scope.vodListByCategory=item.vodListByCategory,$scope.overview=null,$scope.isMainLoaderShown=!1;else{var offset=0,limit=24;if($scope.currentDepthZone===$scope.DEPTH_ZONE.CATEGORY.CHANNEL){if(0===$index)$scope.vodListByCategory=allChannelList,item.vodListByCategory=allChannelList;else{var tempChannelList=[];angular.forEach(allChannelList,function(channelItem,key){var configServices=","+$scope.selectedSidebarCategory.CONFIG_SERVICES+",";configServices.indexOf(","+channelItem.service_id+",")>=0&&tempChannelList.push(channelItem),$scope.vodListByCategory=tempChannelList,item.vodListByCategory=tempChannelList})}$scope.overview=null,$scope.isMainLoaderShown=!1}else retrieveVodListInCategory($scope.selectedSidebarCategory,limit,offset)}}function getMoreVodsInCategory(callback){var selectedSidebarCategory=$scope.selectedSidebarCategory,offset=selectedSidebarCategory.vodListByCategory.length,limit=offset+24;retrieveVodListInCategory(selectedSidebarCategory,limit,offset,callback)}function retrieveVodListInCategory(sidebarCategory,limit,offset,callback){var cb=callback||angular.noop;$scope.isMainLoaderShown=!0,UltilService.isSeriesCategory(sidebarCategory)?DataService.getCategorySeriesVodListByCategoryId(UltilService.getVodCategoryId(sidebarCategory),limit,offset).then(function(response){var seriesVodList=response;return seriesVodList?($scope.vodListByCategory=$scope.vodListByCategory.concat(seriesVodList),sidebarCategory.vodListByCategory=$scope.vodListByCategory,$scope.overview=null,$scope.isMainLoaderShown=!1,cb()):void 0},function(response){setTimeout(function(){},200)}):DataService.getCategoryVodListByCategoryId(UltilService.getVodCategoryId(sidebarCategory),limit,offset).then(function(response){var vodList=response;return vodList?($scope.vodListByCategory=$scope.vodListByCategory.concat(vodList),sidebarCategory.vodListByCategory=$scope.vodListByCategory,$scope.overview=null,$scope.isMainLoaderShown=!1,cb()):void 0},function(response){setTimeout(function(){},200)})}function onChannelSelected($event,category,data){data&&data.item&&data.item.loaded!==!1&&($scope.channelOverview=data.item,$scope.overview=data.item,VideoService.stopStream(video),video=$("#videoMainPlay")[0],$scope.isMediaLoaderHidden=!1,changeDepth($scope.DEPTH.PLAYER),$scope.isPlayerShown=!0,VideoService.playChannelStream($scope.overview,video).then(function(response){$timeout(function(){$scope.isMediaLoaderHidden=!0},0)},function(errorData){"ENCRYPTED_CONTENT_ERROR"===errorData.name&&($scope.isMediaLoaderHidden=!0,$scope.back(),toaster.clear("*"),toaster.pop({type:"error",title:"Nội dung không hỗ trợ",body:"Nội dung chưa được hỗ trợ trên TV. Vui lòng xem nội dung trên Set-Top-Box hoặc ứng dụng Viettel trên điện thoại!",timeout:1e4}),toaster.clear(toastInstance))}),lastFocusedGroup=FocusUtil.getData($event.currentTarget).group)}function onChannelBlurred($event,category,data){$scope.isOverviewDark=!0,$scope.channelWatchPreviewLoaded=!1}function onVodSelected($event,category,item,$index){item.loaded!==!1&&goToVodDetailPage(item,$event)}function onCategoryVodSelected($event,item,$index){item.loaded!==!1&&($scope.isMainLoaderShown=!0,$scope.currentDepthZone===$scope.DEPTH_ZONE.CATEGORY.CHANNEL?(VideoService.stopStream(video),video=$("#videoMainPlay")[0],$scope.isMainLoaderShown=!0,changeDepth($scope.DEPTH.PLAYER),VideoService.playChannelStream(item,video).then(function(response){$timeout(function(){$scope.isMainLoaderShown=!1},300)},function(response){}),lastFocusedGroup=FocusUtil.getData($event.currentTarget).group):(lastFocusedGroup=FocusUtil.getData($event.currentTarget).group,categoryVodFocusedGroup=FocusUtil.getData($event.currentTarget).group,lastDepth=$scope.DEPTH.CATEGORY,$scope.lastDepthZone="",goToVodDetailPage(item,$event)))}function onRelatedVodSelected($event,category,item,$index){item.loaded!==!1&&playVOD(item)}function onEpisodeVodSelected($event,category,data,$index){data&&data.item&&data.item.loaded!==!1&&playVOD(data.item)}function goToVodDetailPage(vod,$event){$scope.currentItemData=null;var depth;depth=$scope.DEPTH.DETAIL,depth&&changeDepth(depth),detailPlayFocusedGroup=FocusUtil.getData($event.currentTarget).group,"VOD_LIST_CATEGORY"!==lastFocusedGroup?updateRelatedEpisodeListInDetail(vod):(vod.relateds=[],vod.episodes=[],vod.isVodInSeries?DataService.getRelatedVodList(vod.program.programId).then(function(relatedVodList){vod.relateds=relatedVodList;var seriesId=vod.program.series.id;DataService.getEpisodesInSeries(seriesId).then(function(episodeVodList){vod.episodes=episodeVodList,updateRelatedEpisodeListInDetail(vod)},function(response){})},function(response){}):vod.isSeries?DataService.getEpisodeListBySeriesId(vod.id).then(function(episodeVodList){vod=episodeVodList[0],vod=UltilService.transformVOD(vod),vod.episodes=episodeVodList,DataService.getRelatedVodList(vod.program.id).then(function(relatedVodList){vod.relateds=relatedVodList,updateRelatedEpisodeListInDetail(vod)})},function(response){}):DataService.getRelatedVodList(vod.program.id).then(function(relatedVodList){vod.relateds=relatedVodList,updateRelatedEpisodeListInDetail(vod)},function(response){}))}function updateRelatedEpisodeListInDetail(vod){$scope.relatedPlaylist=vod.relateds,$scope.episodePlaylist=vod.episodes,$scope.currentDetailRelatedList=$scope.relatedPlaylist,$scope.currentDetailOverview=vod,currentItemData=vod,$scope.isRelatedShown=!1,$scope.isEpisodeShown=!1,$scope.isEpisodeBtnNotShown=!0,$scope.relatedPlaylist.length>0?($scope.isRelatedShown=!0,$scope.episodePlaylist.length>0?$scope.isEpisodeBtnNotShown=!1:$scope.isEpisodeBtnNotShown=!0):($scope.isRelatedShown=!1,$scope.episodePlaylist.length>0?($scope.isEpisodeShown=!0,$scope.isEpisodeBtnNotShown=!0):($scope.isEpisodeShown=!1,$scope.isEpisodeBtnNotShown=!1)),updateOverview(),$scope.lastDepthZone!==$scope.DEPTH_ZONE.INDEX.SPOTLIGHT&&vod.isSpotlight!==!0&&setVodDetailPackground(vod.bigPhotoUrl),vod.isSpotlight===!0&&$scope.lastDepthZone!==$scope.DEPTH_ZONE.INDEX.SPOTLIGHT&&setSpotlightPackground(vod.bigPhotoUrl),$scope.isMainLoaderShown=!1,$timeout(function(){$("#list-related-vod").trigger("reload"),$("#list-episode-vod").trigger("reload")},0)}function btnVodPlayFocusInDetail($event,$originalEvent){$scope.isOverviewDark=!1,$scope.currentDetailOverview&&($scope.overview=$scope.currentDetailOverview),$scope.currentDetailRelatedList&&($scope.relatedPlaylist=$scope.currentDetailRelatedList),$scope.currentDetailEpisodeList&&($scope.episodePlaylist=$scope.currentDetailEpisodeList),$scope.lastDepthZone!==$scope.DEPTH_ZONE.INDEX.SPOTLIGHT&&lastDepth!==$scope.DEPTH.PLAYER&&lastDepth!==$scope.DEPTH.CATEGORY&&updateRelatedEpisodeListInDetail($scope.currentDetailOverview),lastDepth=$scope.DEPTH.DETAIL,lastFocusedGroup=FocusUtil.getData($event.currentTarget).group,$scope.lastDepthZone=$scope.DEPTH_ZONE.DETAIL.SPOTLIGHT}function btnVodEpisodeFocusInDetail($event,$originalEvent){$scope.isOverviewDark=!1,$scope.isEpisodeShown=!0,$scope.isRelatedShown=!1,$scope.currentDetailOverview&&($scope.overview=$scope.currentDetailOverview),$scope.currentDetailEpisodeList&&($scope.episodePlaylist=$scope.currentDetailEpisodeList)}function btnVodRelatedFocusInDetail($event,$originalEvent){$scope.isOverviewDark=!1,$scope.isEpisodeShown=!1,$scope.relatedPlaylist.length>0&&($scope.isRelatedShown=!0)}function buttonFocusInSpotLight($event,$originalEvent){$scope.isOverviewDark=!1,$scope.lastDepthZone=$scope.DEPTH_ZONE.INDEX.SPOTLIGHT,$scope.overview=$scope.lastOverview,$scope.currentCategory="",$scope.currentDetailOverview=null}function playVOD(vod){$scope.isAuthenticated()?(video=$("#videoMainPlay")[0],$rootScope.isAppLoadedAfterLogin?(lastDepth=$scope.DEPTH.DETAIL,playVODStream(vod,video)):DataService.getVodDetails($scope.overview.program.id).then(function(responseVod){$scope.overview=responseVod,lastDepth=$scope.DEPTH.DETAIL,playVODStream($scope.overview,video)},function(response){})):LoginService.openLoginPage(function(){lastDepth=$scope.DEPTH.DETAIL,changeDepth($scope.DEPTH.LOGIN),focusController.focus("btnLogin")})}function btnVodPlaySelected($event){lastFocusedGroup=FocusUtil.getData($event.currentTarget).group,playVOD($scope.overview)}function btnViewMoreSelected($event,item){$scope.isMainLoaderShown=!0,$scope.lastDepthZone=$scope.DEPTH_ZONE.INDEX.SPOTLIGHT,goToVodDetailPage(item,$event),lastFocusedGroup=FocusUtil.getData($event.currentTarget).group,$timeout(function(){$scope.isMainLoaderShown=!1},200)}function playVODStream(vod,video){if($scope.currentDepth!==$scope.DEPTH.PLAYER){$scope.isPlayDisabled=!0;var playable=!1;vod.isExclusivePackage?vod.isPurchasedExclusive&&(playable=!0):(vod.isFreeNoPair||vod.isWifiPackage||vod.isPurchasedPackage)&&(playable=!0),playable?($scope.isMediaLoaderHidden=!1,changeDepth($scope.DEPTH.PLAYER),VideoService.playVODStream(vod,video).then(function(response){$timeout(function(){$scope.isMediaLoaderHidden=!0},1e3)},function(errorData){"ENCRYPTED_CONTENT_ERROR"===errorData.name&&($scope.isMediaLoaderHidden=!0,$scope.back(),toaster.clear("*"),toaster.pop({type:"error",title:"Nội dung không hỗ trợ",body:"Nội dung chưa được hỗ trợ trên TV. Vui lòng xem nội dung trên Set-Top-Box hoặc ứng dụng Viettel trên điện thoại!",timeout:1e4}),toaster.clear(toastInstance))})):(toaster.clear("*"),toaster.pop({type:"warning",title:"Không xem được Video",body:"Bạn cần mua gói dịch vụ trên ứng dụng ViettelTV phiên bản cho Mobile để tiếp tục xem Video!",timeout:1e4}),$scope.isMediaLoaderHidden=!0)}}function selectLoginCancelButton(event){$scope.back()}function selectLoginButton(event){event.preventDefault(),$scope.isMainLoaderShown=!0,Auth.login({username:$scope.login.username,password:$scope.login.password}).then(function(response){$scope.isMainLoaderShown=!1,response.data.error?($scope.authenticationError=!0,
toaster.clear("*"),toaster.pop({type:"error",title:"Đăng nhập không thành công",body:"Số điện thoại hoặc mật khẩu không đúng!",timeout:1e4}),toaster.clear(toastInstance)):(removeKeyboardListenerFunc(),$scope.authenticationError=!1,LoginService.closeLoginPage(),Principal.identity().then(function(account){$scope.isAuthenticated=Principal.isAuthenticated,toaster.clear("*"),toaster.pop({type:"success",title:"Đăng nhập thành công",timeout:2e3})}),changeDepth($scope.DEPTH.DETAIL))})["catch"](function(){$scope.authenticationError=!0})}function processKeydownEvent(){focusController.addBeforeKeydownHandler(function(context){var e=context.event;if(end=(new Date).getTime(),200>end-start)return e.preventDefault(),void e.stopPropagation();if(start=(new Date).getTime(),isOnline&&($scope.isChannel=!1,$scope.isInitCompleted!==!1)){if($scope.currentDepth!==$scope.DEPTH.PLAYER||$scope.overview.channel)$scope.overview&&$scope.overview.channel&&($scope.isChannel=!0,$scope.setting.channel=!0);else{if(context.event.keyCode!==CONSTANT.KEY_CODE.RETURN&&$scope.showMediaController===!1)return $scope.isMediaLoaderHidden&&$timeout(function(){$scope.setMediaControllerTimer()},500),!1;$scope.isChannel=!1}if($scope.currentDepth===$scope.DEPTH.INDEX){$scope.currentFocusItem=focusController.getCurrentFocusItem();var currentCategory=$($scope.currentFocusItem).parents(".list-area");switch(context.event.keyCode){case CONSTANT.KEY_CODE.UP:if(currentCategory.length>0&&removeFadeoutUpClassToItem(currentCategory),currentCategory.parent().prev().find(".list-area").length>0&&removeFadeoutUpClassToItem(currentCategory.parent().prev().find(".list-area")),$($scope.currentFocusItem).parents(".list-area").parent().is(":first-child"))return $scope.lastDepthZone=$scope.currentDepthZone,$scope.currentDepthZone=$scope.DEPTH_ZONE.INDEX.SPOTLIGHT,$scope.overview=$scope.lastOverview,setSpotlightPackground(currentSpotlight.bigPhotoUrl,function(){focusController.focus("btnView")}),$(".list-category").css({transform:"translate3d(0, 0px, 0)"}),!1;$($scope.currentFocusItem).hasClass("btn-view")&&moveToCategoryMenu();break;case CONSTANT.KEY_CODE.DOWN:if($($scope.currentFocusItem).parents(".list-area.channel").length>0&&VideoService.stopStream(video),currentCategory.length>0&&noCategoryInHome-2>=currentCategoryInHome&&addFadeoutUpClassToItem(currentCategory),$($scope.currentFocusItem).parents(".category-menu-list").length>0)return $scope.bgImgCoverOpacity=1,moveToSpotlightDown(),!1;break;case CONSTANT.KEY_CODE.RETURN:case CONSTANT.KEY_CODE.BACK:case CONSTANT.KEY_CODE.ESC:$scope.back()}}else if($scope.currentDepth===$scope.DEPTH.CATEGORY)switch($scope.currentFocusItem=focusController.getCurrentFocusItem(),context.event.keyCode){case CONSTANT.KEY_CODE.UP:"sidebar-category-item-0"===$scope.currentFocusItem.id&&$scope.back();break;case CONSTANT.KEY_CODE.DOWN:break;case CONSTANT.KEY_CODE.RETURN:case CONSTANT.KEY_CODE.BACK:case CONSTANT.KEY_CODE.ESC:$scope.back()}else switch(context.event.keyCode){case CONSTANT.KEY_CODE.UP:break;case CONSTANT.KEY_CODE.DOWN:break;case CONSTANT.KEY_CODE.RETURN:case CONSTANT.KEY_CODE.BACK:case CONSTANT.KEY_CODE.ESC:$scope.back()}}})}function setMediaControllerTimer(){$scope.showMediaController=!0,mediaControllerTimer&&$timeout.cancel(mediaControllerTimer),mediaControllerTimer=$timeout(function(){$scope.showMediaController=!1,mediaControllerTimer=null},CONSTANT.MEDIA_CONTROLLER_TIMEOUT)}function changeDepth(depth,callback){lastDepth=$scope.currentDepth,$scope.currentDepth=depth,$timeout(function(){focusController.setDepth(depth),depth===$scope.DEPTH.DETAIL&&focusController.focus("btnPlay"),callback&&callback()},CONSTANT.EFFECT_DELAY_TIME)}function updateCategoryListData(response,category,reload){$scope.dataCategory[category]=response,$timeout(function(){reload&&$("#list-"+category).trigger("reload")},0)}function updateOverview(){$scope.overview=currentItemData,$scope.isOverviewDark=!1}function moveContainer(category,regionId,targetTop){category!==$scope.currentCategory&&($("."+regionId).css({transform:"translate3d(0, "+targetTop+"px, 0)"}),$scope.currentCategory=category)}function moveCategoryVodContainer(targetTop){$(".category-container").css({transform:"translate3d(0, "+targetTop+"px, 0)"})}function showExitConfirmDialog(){$timeout(function(){$scope.dialog.show=!0,$scope.dialog.isConfirm=!0,$scope.dialog.message="Bạn có muốn thoát ứng dụng ViettelTV không?",$scope.dialog.title="Thoát ứng dụng"},CONSTANT.EFFECT_DELAY_TIME)}function showNetworkDisconnectedWarning(){$timeout(function(){$scope.warning.show=!0,$scope.warning.message="Mất kết nối Internet. Vui lòng kiểm tra lại kết nối",$scope.warning.title="Mất kết nối"},CONSTANT.EFFECT_DELAY_TIME)}function back(){var focusClass,targetDepth;switch($scope.currentDepth){case $scope.DEPTH.INDEX:return void($scope.dialog.show?$scope.dialog.show=!1:showExitConfirmDialog());case $scope.DEPTH.DETAIL:"VOD_LIST_CATEGORY"===categoryVodFocusedGroup?($scope.bgImgUrl="",$scope.relatedPlaylist=[CONSTANT.ITEM],targetDepth=$scope.DEPTH.CATEGORY,$scope.currentDepth=$scope.DEPTH.CATEGORY,$timeout(function(){focusController.setDepth(targetDepth,categoryVodFocusedGroup)},CONSTANT.EFFECT_DELAY_TIME)):($scope.relatedPlaylist=[CONSTANT.ITEM],targetDepth=$scope.DEPTH.INDEX,$scope.currentDepth=$scope.DEPTH.INDEX,$timeout(function(){focusController.setDepth(targetDepth,lastFocusedGroup)},CONSTANT.EFFECT_DELAY_TIME));break;case $scope.DEPTH.PLAYER:$scope.showMediaController=!1,mediaControllerTimer=null,VideoService.stopStream(video),targetDepth=lastDepth,$timeout(function(){focusController.setDepth(targetDepth,lastFocusedGroup),lastDepth=$scope.DEPTH.PLAYER},CONSTANT.EFFECT_DELAY_TIME),focusClass=".btn-resume";break;case $scope.DEPTH.LOGIN:LoginService.closeLoginPage(),targetDepth=lastDepth,focusClass=".btn-resume",$timeout(function(){focusController.setDepth(targetDepth,lastFocusedGroup)},CONSTANT.EFFECT_DELAY_TIME);break;case $scope.DEPTH.CATEGORY:var currentGroup=focusController.getCurrentGroup();"VOD_LIST_CATEGORY"===currentGroup?(targetDepth=$scope.DEPTH.CATEGORY,$timeout(function(){focusController.setGroup("SIDEBAR_CATEGORY")},150)):(targetDepth=$scope.DEPTH.INDEX,$timeout(function(){focusController.setDepth(targetDepth,categoryMenuFocusedGroup)},CONSTANT.EFFECT_DELAY_TIME)),focusClass=".btn-resume";break;default:targetDepth=$scope.DEPTH.INDEX}$scope.currentDepth=targetDepth}function addFadeoutUpClassToItem(item){item.addClass("list-fadeout-up")}function removeFadeoutUpClassToItem(item){item.removeClass("list-fadeout-up")}$scope.onScrollFinish=onScrollFinish,$scope.toggleIsPlaying=toggleIsPlaying,$scope.onVodFocused=onVodFocused,$scope.onScrollStart=onScrollStart,$scope.onRelatedVodFocused=onRelatedVodFocused,$scope.onCategoryVodFocused=onCategoryVodFocused,$scope.onEpisodeVodFocused=onEpisodeVodFocused,$scope.onCategoryMenuFocused=onCategoryMenuFocused,$scope.onChannelFocused=onChannelFocused,$scope.onVodBlurred=onVodBlurred,$scope.onCategoryMenuSelected=onCategoryMenuSelected,$scope.onSidebarCategoryFocused=onSidebarCategoryFocused,$scope.onChannelSelected=onChannelSelected,$scope.onChannelBlurred=onChannelBlurred,$scope.onVodSelected=onVodSelected,$scope.onCategoryVodSelected=onCategoryVodSelected,$scope.onRelatedVodSelected=onRelatedVodSelected,$scope.onEpisodeVodSelected=onEpisodeVodSelected,$scope.btnVodPlayFocusInDetail=btnVodPlayFocusInDetail,$scope.btnVodEpisodeFocusInDetail=btnVodEpisodeFocusInDetail,$scope.btnVodRelatedFocusInDetail=btnVodRelatedFocusInDetail,$scope.buttonFocusInSpotLight=buttonFocusInSpotLight,$scope.btnVodPlaySelected=btnVodPlaySelected,$scope.btnViewMoreSelected=btnViewMoreSelected,$scope.selectLoginCancelButton=selectLoginCancelButton,$scope.selectLoginButton=selectLoginButton,$scope.setMediaControllerTimer=setMediaControllerTimer,$scope.back=back,$scope.CATEGORY=CONSTANT.CATEGORY,$scope.DEPTH={INDEX:1,DETAIL:2,CATEGORY:3,PLAYER:4,LOGIN:5,DIALOG:6,WARNING:7,ALERT:8},$scope.DEPTH_ZONE={INDEX:{SPOTLIGHT:1,CHANNEL:2,CATEGORY:3},DETAIL:{SPOTLIGHT:4,CHANNEL:5,CATEGORY:6},CATEGORY:{VOD:7,CHANNEL:8}},$scope.currentCategory=CONSTANT.CATEGORY.COLORS,$scope.currentDepth=$scope.DEPTH.INDEX,$scope.currentDepthZone=$scope.DEPTH_ZONE.INDEX.SPOTLIGHT;var currentCategoryInHome;$scope.isOverviewDark=!0,$scope.showMediaController=!1;var lastDepth=$scope.currentDepth,items=($scope.currentDepthZone,CONSTANT.ITEMS);CONSTANT.ITEM;$scope.dataCategory=[items,items,items,items,items,items,items,items,items,items,items],$scope.relatedPlaylist=items,$scope.episodePlaylist=items;$scope.vodListByCategory=[],$scope.isVodCategoryOpened=!1,$scope.bgImgUrl=CONSTANT.SPOTLIGHT_BG_IMG_URL,$scope.bgGradient1=CONSTANT.SPOTLIGHT_BG_GRADIENT1,$scope.bgGradient2=CONSTANT.SPOTLIGHT_BG_GRADIENT2,$scope.bgSize=CONSTANT.SPOTLIGHT_BG_SIZE,$scope.isAuthenticated=Principal.isAuthenticated,$timeout(function(){$scope.bgImgCoverOpacity=0,$scope.bgImgUrl=CONSTANT.SPOTLIGHT_BG_IMG_URL},400),$scope.login={username:"",password:""},$scope.CATEGORY_MENU=CONSTANT.PREPARED_DATA.CATEGORY_MENUS;var video;$scope.menuArray=[],$scope.headerMenus=[],$scope.homeCategoryNameList=[],$scope.homeCategoryDataMap={},$scope.isMediaLoaderHidden=!0,$scope.isMainLoaderShown=!1,$scope.selectedSidebarCategory=null;var currentSpotlight=null,allChannelList=null,noCategoryInHome=0,isOnline=!0,isChannelListLoaded=!1,isVodListLoaded=!1,isSeriesVodLoaded=!1;main();var lastFocusedGroup,categoryMenuFocusedGroup,categoryVodFocusedGroup,detailPlayFocusedGroup,currentItemData,lastOnlineStatus=!0,isGotSpotlight=!1,isScrolling=!1;$scope.isPlayerShown=!1,$scope.isRelatedShown=!1,$scope.isPlayDisabled=!1,$scope.isChannel=!1,$scope.setting={subTitle:!0};var mediaControllerTimer,start=(new Date).getTime(),end=(new Date).getTime();$scope.dialog={show:!1,center:!0,isConfirm:!0,focusOption:{depth:$scope.DEPTH.DIALOG},onSelectButton:function(buttonIndex,$event){$scope.dialog.isConfirm&&0===buttonIndex?tizen.application.getCurrentApplication().exit():$scope.dialog.show=!1}},$scope.alert={show:!1,center:!0,focusOption:{depth:$scope.DEPTH.ALERT},onSelectButton:function(buttonIndex,$event){$scope.dialog.show=!1}},$scope.warning={show:!1,center:!0,isConfirm:!0,focusOption:{depth:$scope.DEPTH.WARNING}}}angular.module("caph.focus",[],["$provide","$compileProvider",function(a,b){function c(a){return a&&a+""}function d(a){var b=jQuery(a).data(),d={};return Object.keys(i.DIRECTION).forEach(function(a){var e=i.DIRECTION[a],f="focusableNextFocus"+h(e),g=b[f];(g||null===g)&&(d[e]=c(g))}),{depth:b.focusableDepth,group:c(b.focusableGroup),name:c(b.focusableName),initialFocus:b.focusableInitialFocus,disabled:b.focusableDisabled,nextFocus:d}}function e(a,b){return a=jQuery(a),a.data({focusableDepth:angular.isNumber(b.depth)?b.depth:i.DEFAULT.DEPTH,focusableGroup:b.group||i.DEFAULT.GROUP,focusableName:b.name||k.get(),focusableInitialFocus:b.initialFocus===!0,focusableDisabled:b.disabled===!0}),b.nextFocus&&Object.keys(b.nextFocus).forEach(function(c){var d="focusableNextFocus"+h(c),e=b.nextFocus[c];(e||null===e)&&a.data(d,e)}),a.data("focusableName")}function f(a){return a&&a instanceof jQuery?a[0]:a}function g(a){return!(!a||a.nodeType!==Node.ELEMENT_NODE)}function h(a){return a?a.charAt(0).toUpperCase()+a.substr(1):a}var i={DIRECTION:{LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down"},DEFAULT:{DEPTH:0,GROUP:"default",KEY_MAP:{LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13},DISTANCE_CALCULATION_STRATEGY:"default"}},j=0,k={get:function(){return"focusable-"+j++}},l=".focusable",m={mouseover:"focus",mouseout:"blur"};"undefined"!=typeof window.Hammer?(m.tap="select",m.doubletap="select"):m.click="select";var n=["focused","blurred","selected"],o={NameGenerator:k,isFocusable:function(a){return g(a=f(a))&&null!==a.getAttribute("focusable")},isElement:function(a){return g(f(a))},isVisible:function(a){if(g(a=f(a))){for(;a;){if("none"===jQuery.css(a,"display")||"hidden"===jQuery.css(a,"visibility"))return!1;a=a.parentElement}return!0}return!1},getElement:function(a){return g(a=f(a))?a:null},getData:function(a){return o.isFocusable(a)?d(f(a)):null},setData:function(a,b){return o.isFocusable(a)?e(a=f(a),b&&angular.extend(d(a),b)||d(a)):null},bindMouseEvent:function(a,b){return o.isElement(a)&&Object.keys(m).forEach(function(c){jQuery(a).on(c+l,{method:m[c]},b)}),this},bindFocusableEvent:function(a,b){return o.isElement(a)&&n.forEach(function(c){jQuery(a).on(c+l,b)}),this},unbindEvent:function(a){return o.isElement(a)&&jQuery(a).off(l),this}};a.constant("FocusConstant",i),a.constant("FocusUtil",o),a.provider({focusController:FocusControllerProvider,nearestFocusableFinder:NearestFocusableFinderProvider}),b.directive("focusable",focusableDirective)}]),FocusControllerProvider.$inject=["FocusConstant"];var focusableDirective=["$parse","$interpolate","$animate","FocusUtil","nearestFocusableFinder","focusController",function(a,b,c,d,e,f){function g(a,b){return angular.isString(a)&&0===a.indexOf(b)}function h(a,b){return angular.isString(a)&&a.indexOf(b)===a.length-b.length}function i(a,b){switch(b){case"focused":c.addClass(a,j);break;case"blurred":c.removeClass(a,j)}}var j="focused",k="disabled",l=[{focusableDepth:function(a){return 1*a}},{focusableGroup:angular.identity},{focusableName:angular.identity},{focusableInitialFocus:function(a){return"true"===a}},{focusableDisabled:function(a){return"true"===a}},{focusableNextFocusLeft:angular.identity},{focusableNextFocusRight:angular.identity},{focusableNextFocusUp:angular.identity},{focusableNextFocusDown:angular.identity}];return{restrict:"A",scope:!0,link:function(j,m,n){j.$applyAsync(function(a){var d=m.data();l.forEach(function(c){var e=Object.keys(c)[0],f=d[e];f&&g(f,b.startSymbol())&&h(f,b.endSymbol())&&m.data(e,c[e](b(f)(a)))}),e.$$put(m[0],a.$eval(n.focusable)),f.$$setInitialFocusItem(m[0]),d.focusableDisabled&&c.addClass(m,k)}),d.bindMouseEvent(m[0],function(a){var b=a.currentTarget||a.target;f.$$ignoreMouseEvent!==!0&&d.getData(b).depth===f.getCurrentDepth()&&f[a.data.method](b,a)}),d.bindFocusableEvent(m[0],function(b,c){j.$applyAsync(function(d){i(m,b.type),(a(n[n.$normalize("on-"+b.type)])||angular.noop)(d,{$event:b,$originalEvent:c})})}),j.$on("$destroy",function(){d.unbindEvent(e.$$remove(m[0])),m.remove()}),"undefined"!=typeof window.Hammer&&(Hammer.defaults.domEvents=!0,new Hammer(m[0]))}}}];NearestFocusableFinderProvider.$inject=["FocusConstant","focusControllerProvider"];var caphButtonDirective=["$parse","focusController","FocusUtil",function(a,b,c){return{restrict:"E",transclude:!0,template:'<div class="{{buttonClass}}" focusable ng-transclude on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)"></div>',scope:!0,link:function(b,d,e){var f=!1,g=d.find("div"),h=b.$eval(e.toggle)||{};b.buttonClass=e.buttonClass||"caph-button";var i=b.$eval(e.focusOption);e.$observe("buttonClass",function(a){b.buttonClass=a}),i&&c.setData(g,i),b.focus=function(c,d){(a(e.onFocused)||angular.noop)(b.$parent,{$event:c,$originalEvent:d})},b.blur=function(c,d){(a(e.onBlurred)||angular.noop)(b.$parent,{$event:c,$originalEvent:d})},b.select=function(c,d){h?(f=!f,(a(e.onSelected)||angular.noop)(b.$parent,{$event:c,$selected:f,$originalEvent:d}),g.toggleClass("selected")):(a(e.onSelected)||angular.noop)(b.$parent,{$event:c,$originalEvent:d})}}}}],caphCheckboxDirective=["$parse","focusController","FocusUtil",function(a,b,c){return{restrict:"E",transclude:!0,template:'<div class="{{checkboxClass}}"focusable ng-transclude on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)" ng-class="{checked : checked}">{{check}}</div>',scope:!0,link:function(b,d,e){b.checked=b.$eval(e.checked)||!1,b.checkboxClass=e["class"]||"caph-checkbox",e.$observe("checkboxClass",function(a){b.checkboxClass=a});var f=d.find("div"),g=b.$eval(e.focusOption);g&&c.setData(f,g),b.focus=function(c,d){(a(e.onFocused)||angular.noop)(b.$parent,{$event:c,$originalEvent:d})},b.blur=function(c,d){(a(e.onBlurred)||angular.noop)(b.$parent,{$event:c,$originalEvent:d})},b.select=function(c,d){b.checked=!b.checked,(a(e.onSelected)||angular.noop)(b.$parent,{$event:c,$checked:b.checked,$originalEvent:d})}}}}],caphTranscludeDirective=[function(){return{restrict:"A",link:function(a,b,c,d,e){var f=c.caphTransclude;e(function(a){if(f){var c="";for(var d in a)if(a[d].tagName&&f.toLowerCase()===a[d].tagName.toLowerCase()){c=a[d];break}b.empty(),b.append(c)}else b.empty(),b.append(a)})}}}],caphContextMenuItemTemplateDirective=["$sce","$compile",function(a,b){return{restrict:"E",require:["?^caphContextMenu"],tranclude:!0,link:function(c,d){c.$parent.$watch("item",function(b){for(var d in b)"content"===d?c[d]=a.trustAsHtml(b[d]+""):c[d]=b[d]},!0),d.replaceWith(b("<span>"+d.html()+"</span>")(c))}}}],caphContextMenuArrowUpTemplateDirective=function(){return{restrict:"E",require:["?^caphContextMenu"],tranclude:!0}},caphContextMenuArrowDownTemplateDirective=function(){return{restrict:"E",require:["?^caphContextMenu"],tranclude:!0}},caphContextMenuDirective=["$parse","focusController","FocusConstant","$timeout","$window",function(a,b,c,d,e){var f={FOCUSABLE_DEPTH:1e4},g={translateTo:function(a,b,c){a&&a.css("transform","translate3d("+b+"px,"+c+"px, 0)")},getSuitablePosition:function(a,b,c){var d=a.offset();for(var f in b)if(d.left+b[f].x>0&&d.left+b[f].x+a.outerWidth()<angular.element(e).width()&&(c||d.top+b[f].y>0&&d.top+b[f].y+a.outerHeight()<angular.element(e).height()))return b[f];return b.length>0?b[0]:void 0},getCalculatedOffset:function(a,b){var c=a.offset();return{x:b.x-c.left,y:b.y-c.top}}};return{restrict:"E",template:'<div class="caph-context-menu {{menuList[\'root\'].option.class}}" ng-class="{{menuList[\'root\'].option.class}}"><div class="arrow-up" ng-show="menuList[\'root\'].option.visibleItemCount > 0 && menuList[\'root\'].option.visibleItemCount < menuList[\'root\'].itemList.length" ng-click="onSelectUpButton($event)" caph-transclude="caph-context-menu-arrow-up-template"></div><ul ng-style="menuList[\'root\'].option.style" data-visible-item-count="{{menuList[\'root\'].option.visibleItemCount}}" data-scroll-count="0" data-submenu-id="root"><li ng-repeat="item in menuList[\'root\'].itemList" id="{{item.id}}" focusable data-focusable-depth="{{menuList[\'root\'].focusableDepth}}" data-focusable-initial-focus="{{$index===0}}" ng-class="{hasSubMenu:menuList[item.id], opened:(menuList[item.id] && menuList[item.id].show), disabled:item.disabled}"  data-focusable-disabled="{{item.disabled || checkItemExist(menuList[\'root\'].itemList, item)}}" on-selected="onSelectItem($event, (menuList[item.id])?item.id:false)" ng-click="onClickItem((menuList[item.id])?item.id:false)"  on-focused="focusItem($event, $originalEvent)" on-blurred="blurItem($event, $originalEvent)" caph-transclude="caph-context-menu-item-template"></li></ul><div class="arrow-down" ng-show="menuList[\'root\'].option.visibleItemCount > 0 && menuList[\'root\'].option.visibleItemCount < menuList[\'root\'].itemList.length" ng-click="onSelectDownButton($event)" caph-transclude="caph-context-menu-arrow-down-template"></div></div><div class="caph-context-menu {{submenu.option.class}}" ng-repeat="(menuId, submenu) in menuList" ng-if="menuId != \'root\'" ng-show="submenu.show" id="sub_{{menuId}}" data-submenu-id="{{menuId}}"><div class="arrow-up" ng-show="submenu.option.visibleItemCount > 0 && submenu.option.visibleItemCount < submenu.itemList.length" ng-click="onSelectUpButton($event)" caph-transclude="caph-context-menu-arrow-up-template"></div><ul ng-style="submenu.option.style" data-visible-item-count="{{submenu.option.visibleItemCount}}" data-scroll-count="0" data-submenu-id="{{menuId}}"><li ng-repeat="item in submenu.itemList" id="{{item.id}}" focusable data-focusable-depth="{{submenu.focusableDepth}}" data-focusable-initial-focus="{{$index===0}}"  data-focusable-disabled="{{item.disabled || checkItemExist(submenu.itemList, item)}}" on-selected="onSelectItem($event, (menuList[item.id])?item.id:false)" ng-click="onClickItem((menuList[item.id])?item.id:false)"  on-focused="focusItem($event, $originalEvent)" on-blurred="blurItem($event, $originalEvent)" data-previous-depth="{{subMenu.previousDepth}}" ng-class="{hasSubMenu:menuList[item.id], opened:(menuList[item.id] && menuList[item.id].show), disabled:item.disabled}" caph-transclude="caph-context-menu-item-template"></li></ul><div class="arrow-down" ng-show="submenu.option.visibleItemCount > 0 && submenu.option.visibleItemCount < submenu.itemList.length" ng-click="onSelectDownButton($event)" caph-transclude="caph-context-menu-arrow-down-template"></div></div>',transclude:!0,scope:!0,link:function(e,h,i){e.focusableDepth=angular.isNumber(1*i.focusableDepth)?1*i.focusableDepth:f.FOCUSABLE_DEPTH,e.show=!0,e.menuList={};var j,k=b.getCurrentDepth();e.checkItemExist=function(a,b){return $.inArray(b,a)<0},e.onSelectItem=function(b,c){var d=angular.element(b.currentTarget);c?e.menuList[c].show?y(c):x(c,d):(a(i.onSelectItem)||angular.noop)(e.$parent,{$itemId:d.attr("id"),$event:b})},e.focusItem=function(b,c){(a(i.onFocusItem)||angular.noop)(e.$parent,{$event:b,$originalEvent:c})},e.blurItem=function(b,c){(a(i.onBlurItem)||angular.noop)(e.$parent,{$event:b,$originalEvent:c})},e.onClickItem=function(a){a&&(w[a]=d(function(){y(a),delete w[a]},700))},e.onSelectUpButton=function(a){var b=angular.element(a.currentTarget).next();z(b,"up",b.data("visibleItemCount"))},e.onSelectDownButton=function(a){var b=angular.element(a.currentTarget).prev();z(b,"down",b.data("visibleItemCount"))};var l=function(a){b.setDepth(angular.element(a.currentTarget).data("focusableDepth")),b.focus(a.currentTarget)},m=function(a){var b=angular.element(a.currentTarget).data("submenuId");b&&(w[b]=d(function(){y(b),delete w[b]},700))},n=function(a){var b=angular.element(a.currentTarget).data("submenuId"),c=e.menuList[b]?e.menuList[b].parentId:void 0;b&&w[b]&&(d.cancel(w[b]),delete w[b]),c&&w[c]&&(d.cancel(w[c]),delete w[c])},o=function(){B()},p=function(a){var b,d,e;if(a.event.keyCode===c.DEFAULT.KEY_MAP.LEFT){var f=angular.element(a.currentFocusItem).parent().data("submenuId");"root"===f?B():y(f)}else if(a.event.keyCode===c.DEFAULT.KEY_MAP.DOWN){if(b=angular.element(a.currentFocusItem).parent(),b.data("visibleItemCount")){d=b.find("li"),e=jQuery.inArray(a.currentFocusItem,d);var g=e-b.data("scrollCount")-b.data("visibleItemCount")+1;e-b.data("scrollCount")>=b.data("visibleItemCount")&&z(b,"down",b.data("visibleItemCount"),g)}}else a.event.keyCode===c.DEFAULT.KEY_MAP.UP&&(b=angular.element(a.currentFocusItem).parent(),b.data("visibleItemCount")&&(d=b.find("li"),e=jQuery.inArray(a.currentFocusItem,d),e-b.data("scrollCount")<0&&z(b,"up",b.data("visibleItemCount"),b.data("scrollCount")-e)))},q=function(){angular.element(document).off("click",o)},r=function(){angular.isNumber(k)&&(b.setDepth(k),angular.element(document).on("click",o))},s=function(a,b){var c={};for(var d in a){if(a[d].parent||(a[d].parent="root"),!a[d].id||!a[d].content)throw new Error("Each data should have properties 'id' and 'content'");if(c[a[d].id])throw new Error("Item's id is duplicated. (id = '"+a[d].id+"')");c[a[d].id]=a[d]}var e={},f=function(a,b){e[a]={focusableDepth:b+Object.keys(e).length,previousDepth:void 0,menuDepth:void 0,itemList:[],option:{},show:!1}};f("root",b);for(var g in a)e[a[g].parent]||f(a[g].parent,b),e[a[g].parent].itemList.push(a[g]);for(var h in e)if("root"===h)e[h].menuDepth=0;else{if(!c[h])throw Error("Parent item is not exist for the item (id = '"+h+"')");for(var i=h,j=1,k=e[c[i].parent].focusableDepth;c[i]&&"root"!==c[i].parent;)i=c[i].parent,j++;e[h].previousDepth=k,e[h].menuDepth=j,e[h].parentId=c[h].parent}return e},t=function(a){if(a)for(var b in e.menuList)a[e.menuList[b].menuDepth]&&(e.menuList[b].option=a[e.menuList[b].menuDepth])};e.$watch(i.items,function(a){e.menuList=s(a,e.focusableDepth),j=e.$eval(i.menuOption)||{},t(j)},!0),e.$watch(i.menuOption,function(a){j=a,t(j)},!0);var u;e.$watch(i.position,function(a){u=a;var b=h.find(".caph-context-menu:first-child");if(u&&angular.isNumber(u.x)&&angular.isNumber(u.y)){g.translateTo(b,0,0);var c=g.getCalculatedOffset(b,u);g.translateTo(b,c.x,c.y)}});var v=h.offset(),w={},x=function(a,c){e.menuList[a].show=!0;var d=angular.element(c).offset(),f=e.menuList[a].option.offset||{x:0,y:0},h=angular.element("#sub_"+a);h.removeClass("ng-hide");var i=g.getSuitablePosition(h,[{x:angular.element(c).outerWidth()+d.left-v.left+f.x,y:d.top-v.top+f.y},{x:d.left-v.left-h.outerWidth()-f.x,y:d.top-v.top+f.y}],!0);g.translateTo(h,i.x,i.y),b.setDepth(e.menuList[a].focusableDepth);var j=angular.element("#sub_"+a+">ul>li");e.menuList[a].option.visibleItemCount=Math.min(j.length,e.menuList[a].option.visibleItemCount),e.menuList[a].option.visibleItemCount&&(e.menuList[a].option.style.height=j.eq(0).outerHeight()*e.menuList[a].option.visibleItemCount,e.menuList[a].option.style.overflow="hidden")},y=function(a){if(a){e.menuList[a].show=!1;for(var c in e.menuList)e.menuList[c].parentId===a&&(e.menuList[c].show=!1);b.setDepth(e.menuList[a].previousDepth)}else{for(var f in e.menuList)e.menuList[f].show=!1,w[f]&&(d.cancel(w[f]),delete w[f]);b.setDepth(e.menuList.root.focusableDepth)}},z=function(a,b,c,d){var e=a.find("li");d=Math.abs(d)||1,"up"===b&&a.data("scrollCount")>0?a.data("scrollCount",a.data("scrollCount")-d):"down"===b&&a.data("scrollCount")<e.length-c&&a.data("scrollCount",a.data("scrollCount")+d),g.translateTo(e,0,a.data("scrollCount")*e.eq(0).outerHeight()*-1)};e.$watch(i.show,function(a){a===!0?A():B()});var A=function(){if(!e.$eval(i.show)){var c=a(i.show);c.assign(e,!0),e.$applyAsync()}h.removeClass("ng-hide");var d=h.find(".caph-context-menu:first-child");if(u&&angular.isNumber(u.x)&&angular.isNumber(u.y)){g.translateTo(d,0,0);var f=g.getCalculatedOffset(d,u);g.translateTo(d,f.x,f.y)}var j=d.find(">ul>li");e.menuList.root.option.visibleItemCount=Math.min(j.length,e.menuList.root.option.visibleItemCount),e.menuList.root.option.visibleItemCount&&(e.menuList.root.option.style.height=j.eq(0).outerHeight()*e.menuList.root.option.visibleItemCount,e.menuList.root.option.style.overflow="hidden"),angular.isNumber(e.focusableDepth)&&b.setDepth(e.focusableDepth),b.addAfterKeydownHandler(p),angular.element(document).on("click",o);var k=h.find("div.caph-context-menu");k.on("mouseover",n).on("mouseleave",m),k.find("> ul > li").on("mouseover",l),h.on("mouseover",q).on("mouseleave",r),e.$applyAsync()},B=function(){h.addClass("ng-hide"),y(),angular.isNumber(k)&&b.setDepth(k),b.removeAfterKeydownHandler(p),angular.element(document).off("click",o);var c=h.find("div.caph-context-menu");if(c.off("mouseover",n).off("mouseleave",m),c.find("> ul > li").off("mouseover",l),h.off("mouseover",q).off("mouseleave",r),e.$eval(i.show)){var d=a(i.show);d.assign(e,!1),e.$applyAsync()}};if("undefined"!=typeof window.Hammer){var C,D,E=h.find(".caph-context-menu > ul"),F=new Hammer.Manager(E[0],{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]}),G=0;F.on("panmove",function(a){var b=$(a.target).parents("div.caph-context-menu>ul");return b.data("submenuId")&&H(b.data("visibleItemCount"),e.menuList[b.data("submenuId")].itemList.length)?void g.translateTo(D,0,G+a.deltaY):!1}),F.on("panstart",function(a){var b=$(a.target).parents("div.caph-context-menu>ul");return b.data("submenuId")&&H(b.data("visibleItemCount"),e.menuList[b.data("submenuId")].itemList.length)?(D=E.find("> li"),G=E.data("scrollCount")*D.outerHeight()*-1,C=D.css("transition"),void D.css("transition","transform 0s ease")):!1}),F.on("panend",function(a){var b=$(a.target).parents("div.caph-context-menu>ul");if(!b.data("submenuId")||!H(b.data("visibleItemCount"),e.menuList[b.data("submenuId")].itemList.length))return!1;var c=D.outerHeight();if(a.deltaY>0)var d=-1*Math.ceil(a.deltaY/c);else var d=-1*Math.floor(a.deltaY/c);var f=b.find("li").length-b.data("visibleItemCount");E.data("scrollCount")+d<0?(d=0,E.data("scrollCount",0)):E.data("scrollCount")+d>f&&(d=0,E.data("scrollCount",f));var h=(E.data("scrollCount")+d)*c*-1;g.translateTo(D,0,h),E.data("scrollCount",E.data("scrollCount")+d),C&&D.css("transition",C)});var H=function(a,b){return $.isNumeric(a)&&$.isNumeric(b)?b>a:!1}}}}}],caphDialogTitleDirective=function(){return{restrict:"E",require:"?^caphDialog",template:'<div class="title-area"><div class="title-wrapper"><div class="title" ng-transclude></div></div></div>',transclude:!0}},caphDialogContentDirective=function(){return{restrict:"E",require:"?^caphDialog",transclude:!0,template:'<div class="content-area"><div class="content" ng-transclude></div></div>'}},caphDialogButtonsDirective=["DialogUtil","$parse",function(a,b){return{restrict:"E",require:"^caphDialog",scope:!0,template:'<div class="caph-dialog-button-area"><div class="button-wrapper" ng-if="btnTypeConfirm"><div class="caph-dialog-button" on-selected="onSelectButton(0, $event)" focusable="{depth: {{focusOption.depth}}, initialFocus: true}" data-focusable-group="{{focusOption.group}}" on-focused="focus($event)" on-blurred="blur($event)"><div class="button-text">Yes</div></div><div class="caph-dialog-button" on-selected="onSelectButton(1, $event)" focusable="{depth: {{focusOption.depth}}}" on-focused="focus($event)" data-focusable-group="{{focusOption.group}}" on-blurred="blur($event)"><div class="button-text">No</div></div></div><div class="button-wrapper" ng-if="btnTypeAlert"><div class="caph-dialog-button" on-selected="onSelectButton(0, $event)" focusable="{depth: {{focusOption.depth}}, initialFocus: true}" data-focusable-group="{{focusOption.group}}" on-focused="focus($event)" on-blurred="blur($event)"><div class="button-text">OK</div></div></div></div>',link:function(a,c,d,e){var f=d.buttonType;f&&"confirm"===f?a.btnTypeConfirm=!0:f&&"alert"===f&&(a.btnTypeAlert=!0),a.focusOption=e.getFocusOption(),a.onSelectButton=function(c,e){(b(d.onSelectButton)||angular.noop)(a.$parent,{$buttonIndex:c,$event:e})}}}}],caphDialogDirective=["dialogManager","$parse","DialogUtil","DialogConstant","focusController","$timeout",function(a,b,c,d,e,f){return{restrict:"E",template:'<div class="caph-dialog" ng-transclude></div>',transclude:!0,scope:!1,controller:["$scope","$element","$attrs",function(a,b,c){var e=a.$eval(c.focusOption)||{depth:d.DEFAULT.focusableDepth};e.group=e.group||"default",this.getFocusOption=function(){return e}}],link:function(g,h,i){var j={};j.timeout=g.$eval(i.timeout),j.center=g.$eval(i.center),j.position=g.$eval(i.position),j.focusOption=g.$eval(i.focusOption)||{depth:d.DEFAULT.focusableDepth},j.focusOption.group=j.focusOption.group||"default",j.modal=!0;var k,l=a.generateDialogId();a.addDialog(l,h,j);var m=e.getCurrentDepth(),n=h.find("> :first-child"),o=function(){if(!g.$eval(i.show)){var d=b(i.show);d.assign(g,!0)}j.center===!0?c.moveToCenter(n):j.position&&c.translateTo(n,j.position.x,j.position.y),e.setDepth(j.focusOption.depth,j.focusOption.group),a.manageModal(l,!0),(b(i.onOpen)||angular.noop)(g),k&&(f.cancel(k),k=null),angular.isNumber(j.timeout)&&(k=f(function(){h.addClass("ng-hide"),p(),k=null},j.timeout))},p=function(){if(g.$eval(i.show)){var c=b(i.show);c.assign(g,!1)}k&&(f.cancel(k),k=null),angular.isNumber(m)&&e.setDepth(m),a.manageModal(l,!1),(b(i.onClose)||angular.noop)(g)};g.$watch(i.center,function(a,b){a&&b&&a===!0&&c.moveToCenter(n)}),g.$watch(i.position,function(a,b){a&&b&&a&&c.translateTo(n,a.x,a.y)}),h.addClass("caph-dialog"),g.$watch(i.show,function(a){a===!0?(h.removeClass("ng-hide"),o()):a===!1&&(h.addClass("ng-hide"),p())})}}}],dialogManagerProvider=function(){var a,b={},c=0,d={generateDialogId:function(){return c++ +"_"+(new Date).getTime()},addDialog:function(a,c,d){if(this.getDialog(a))throw new Error("Dialog ID ("+a+") is already registered.");b[a]={element:c,option:d,isOpened:!1}},getDialog:function(a){return b[a]},createDim:function(){a||(a=document.createElement("div"),a.classList.add("caph-dim-init"),document.getElementsByTagName("body")[0].appendChild(a));
},activateDim:function(){a||this.createDim(),a.classList.add("caph-dim-translucent")},deactivateDim:function(){a&&a.classList.remove("caph-dim-translucent")},manageModal:function(a,c){var e=this.getDialog(a);if(!e)throw new Error("Dialog ("+a+") is not registered. Is this id correct?");if(e.isOpened=c,e.option.modal){c?d.activateDim():d.deactivateDim();for(var f in b)f!==a&&b[f].option.modal&&b[f].isOpened&&(b[f].element.addClass("ng-hide"),b[f].isOpened=!1)}}};return{$get:function(){return{generateDialogId:d.generateDialogId,addDialog:d.addDialog,getDialog:d.getDialog,manageModal:d.manageModal}}}},caphDropdownListItemTemplateDirective=["$sce","$compile",function(a,b){return{restrict:"E",require:["?^caphDropdownList"],tranclude:!0,link:function(c,d){c.$parent.$watch("item",function(b){for(var d in b)"content"===d?c[d]=a.trustAsHtml(b[d]+""):c[d]=b[d]},!0),d.replaceWith(b("<span>"+d.html()+"</span>")(c))}}}],caphDropdownListPlaceholderTemplateDirective=["$compile",function(a){return{restrict:"E",require:"?^caphDropdownList",tranclude:!0,link:function(b,c){c.replaceWith(a("<span>"+c.html()+"</span>")(b))}}}],caphDropdownArrowUpTemplateDirective=[function(){return{restrict:"E",require:"?^caphDropdownList",tranclude:!0}}],caphDropdownArrowDownTemplateDirective=[function(){return{restrict:"E",require:"?^caphDropdownList",tranclude:!0}}],caphDropdownListDirective=["$parse","focusController","FocusConstant","FocusUtil","$timeout",function(a,b,c,d,e){var f={FOCUSABLE_DEPTH:2e4},g={translateTo:function(a,b,c){a&&a.css("transform","translate3d("+b+"px,"+c+"px, 0)")}};return{restrict:"E",template:'<div class="caph-dropdown-list"><div class="placeholder" ng-class="{focused: focused, selected: showList}" focusable="focusForPlaceholder" caph-transclude="caph-dropdown-list-placeholder-template"></div><div class="list-container" ng-show="showList"><div class="textbox arrow-up" ng-show="showArrowUp" ng-click="onSelectUpButton($event)"><div class="label center" caph-transclude="caph-dropdown-list-arrow-up-template"></div></div><div class="list-items" ng-style="listContainerStyle" data-scroll-count="0" data-visible-item-count="{{visibleItemCount}}"><div class="textbox" ng-repeat="item in items" focusable="focusForList" data-disabled="{{item.disabled}}" on-selected="onSelectItem($event, item.id)"><div class="label" caph-transclude="caph-dropdown-list-item-template"></div></div></div><div class="textbox arrow-down" ng-show="showArrowDown" ng-click="onSelectDownButton($event)"><div class="label center" caph-transclude="caph-dropdown-list-arrow-down-template"></div></div></div></div>',transclude:!0,scope:!0,link:function(d,h,i){d.visibleItemCount=d.$eval(i.visibleItemCount)||0,d.focusForPlaceholder=d.$eval(i.focusOption)||{depth:b.getCurrentDepth()},d.focusForList={depth:d.focusForPlaceholder.depth+f.FOCUSABLE_DEPTH||f.FOCUSABLE_DEPTH,group:d.focusForPlaceholder.group,disabled:!0},d.showList=d.focused=d.selected=d.disabled=!1;var j=h.find(".placeholder"),k=h.find(".list-container"),l=k.find(".list-items"),m=function(){d.$applyAsync(function(a){a.showList=!0}),d.visibleItemCount>0&&d.visibleItemCount<d.items.length&&(d.listContainerStyle={height:d.visibleItemCount*h.find(".list-items>.textbox").outerHeight(),overflow:"hidden"},d.showArrowUp=h.find("caph-dropdown-list-arrow-up-template").length>0,d.showArrowDown=h.find("caph-dropdown-list-arrow-down-template").length>0),b.addBeforeKeydownHandler(p),b.addAfterKeydownHandler(q),k.on("mouseover",s).on("mouseleave",t),e(function(){h.find(".list-items>.textbox").each(function(){angular.element(this).data("disabled")!==!0&&b.enable(this)}),b.setDepth(d.focusForList.depth),angular.element(document).on("click",r)},0)},n=function(){h.find(".list-items>.textbox").each(function(){b.disable(this)}),d.showList=!1,b.setDepth(d.focusForPlaceholder.depth),b.removeBeforeKeydownHandler(p),b.removeAfterKeydownHandler(q),k.off("mouseover",s).off("mouseleave",t),angular.element(document).off("click",r)},o=function(a,b,c,d){var e=a.find(".textbox");d=Math.abs(d)||1,"up"===b&&a.data("scrollCount")>0?a.data("scrollCount",a.data("scrollCount")-d):"down"===b&&a.data("scrollCount")<e.length-c&&a.data("scrollCount",a.data("scrollCount")+d),g.translateTo(e,0,a.data("scrollCount")*e.eq(0).outerHeight()*-1)};d.$watch(i.items,function(a){d.items=a},!0);var p=function(a){return a.event.keyCode===c.DEFAULT.KEY_MAP.LEFT||a.event.keyCode===c.DEFAULT.KEY_MAP.RIGHT?(n(),!1):void 0},q=function(a){var b,d,e;if(a.event.keyCode===c.DEFAULT.KEY_MAP.DOWN){if(b=angular.element(a.currentFocusItem).parent(),b.data("visibleItemCount")){d=b.find(".textbox"),e=jQuery.inArray(a.currentFocusItem,d);var f=e-b.data("scrollCount")-b.data("visibleItemCount")+1;e-b.data("scrollCount")>=b.data("visibleItemCount")&&o(b,"down",b.data("visibleItemCount"),f)}}else a.event.keyCode===c.DEFAULT.KEY_MAP.UP&&(b=angular.element(a.currentFocusItem).parent(),b.data("visibleItemCount")&&(d=b.find(".textbox"),e=jQuery.inArray(a.currentFocusItem,d),e-b.data("scrollCount")<0&&o(b,"up",b.data("visibleItemCount"),b.data("scrollCount")-e)))},r=function(){n()},s=function(){angular.element(document).off("click",r)},t=function(){angular.element(document).on("click",r)};if(d.onSelectItem=function(b,c){(a(i.onSelectItem)||angular.noop)(d.$parent,{$itemId:c,$event:b}),n()},d.onSelectUpButton=function(a){var b=angular.element(a.currentTarget).next();o(b,"up",b.data("visibleItemCount"))},d.onSelectDownButton=function(a){var b=angular.element(a.currentTarget).prev();o(b,"down",b.data("visibleItemCount"))},j.on("focused",function(){d.focused=!0}),j.on("blurred",function(){d.focused=!1}),j.on("selected",function(){d.showList?n():m()}),"undefined"!=typeof window.Hammer){var u,v,w=new Hammer.Manager(l[0],{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]}),x=0;w.on("panmove",function(a){g.translateTo(v,0,x+a.deltaY)}),w.on("panstart",function(){return y(d.visibleItemCount,d.items.length)?(v=l.find(".textbox"),x=l.data("scrollCount")*l.find(".textbox").outerHeight(),u=v.css("transition"),void v.css("transition","transform 0s ease")):!1}),w.on("panend",function(a){var b=l.find(".textbox").outerHeight();if(a.deltaY>0)var c=Math.ceil(a.deltaY/b);else var c=Math.floor(a.deltaY/b);c+l.data("scrollCount")>0&&(c=0,l.data("scrollCount",0));var e=d.items.length-d.visibleItemCount;e<Math.abs(l.data("scrollCount")+c)&&(c=0,l.data("scrollCount",-1*e)),g.translateTo(v,0,(l.data("scrollCount")+c)*b),l.data("scrollCount",l.data("scrollCount")+c),u&&v.css("transition",u)});var y=function(a,b){return $.isNumeric(a)&&$.isNumeric(b)&&a>0?b>a:!1}}}}}],caphInputDirective=["$parse","focusController","FocusConstant","FocusUtil",function(a,b,c,d){return{restrict:"E",transclude:!0,template:'<input type="{{inputType}}" placeholder={{placeHolder}} value={{inputValue}} maxLength={{maxLength}} class="{{inputClass}}" focusable on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)">',scope:!0,link:function(e,f,g){e.inputClass=g.inputClass||"caph-input",e.inputType=g.type||"text",e.maxLength=e.$eval(g.maxLength)||40,e.placeHolder=g.placeHolder||"";var h=!1;g.$observe("inputClass",function(a){e.inputClass=a}),e.$watch("inputValue",function(){a(g.value).assign(e.$parent,e.inputValue)}),e.$parent.$watch(g.value,function(){e.inputValue=e.$eval(g.value)}),b.addBeforeKeydownHandler(function(a){var b=i[0],d=a.currentFocusItem;if(!h)return!0;if(b!==d)return!1;var e=b.selectionStart,f=b.value.length,g=a.event.keyCode;return g===c.DEFAULT.KEY_MAP.RIGHT&&f>e||g===c.DEFAULT.KEY_MAP.LEFT&&e>0?!1:void 0});var i=f.find("> input"),j=e.$eval(g.focusOption);j&&d.setData(i,j),e.focus=function(b,d){(a(g.onFocused)||angular.noop)(e.$parent,{$event:b,$originalEvent:d}),d&&"keydown"===d.type&&d.keyCode===c.DEFAULT.KEY_MAP.ENTER&&i.focus()},e.blur=function(b,c){(a(g.onBlurred)||angular.noop)(e.$parent,{$event:b,$originalEvent:c}),c&&"keydown"===c.type&&i.blur()},e.select=function(b,c){i.blur(),i.focus(),(a(g.onSelected)||angular.noop)(e.$parent,{$event:b,$originalEvent:c})},i.on("focus",function(a){h=!0}),i.on("blur",function(a){h=!1}),i.on("change",function(b){e.$applyAsync(function(c){var d=b.target.value;c.inputValue=d,(a(g.onChanged)||angular.noop)(e.$parent,{$event:b,value:e.inputValue})})})}}}],caphListDirective=["$parse","$document","$window","$timeout","$interval","VendorUtil","FocusConstant","FocusUtil","focusController","listItemLoader",function(a,b,c,d,e,f,g,h,i,j){function k(a){return a>0&&a!==1/0}var l=".caph-list",m={ROW_COUNT:1,COLUMN_COUNT:1,DIRECTION:"horizontal",CONTAINER_CLASS:"caph-list-container",WRAPPER_CLASS:"caph-list-wrapper",DURATION:"0.5s",EASE:"ease-out",LOOP:!1,DELAY:100,MOUSE_SCROLL_AREA_SIZE:20,PAGE_BUFFER_SIZE:1,KEY:"item"},n=[{name:"containerClass",defaultValue:m.CONTAINER_CLASS},{name:"wrapperClass",defaultValue:m.WRAPPER_CLASS},{name:"initialized",defaultValue:!1}],o=i.getKeyMap();return{restrict:"E",transclude:!0,scope:!0,template:'<div class="{{containerClass}}" ng-show="initialized"><div class="{{wrapperClass}}" style="position: absolute"></div></div>',compile:function(g,p){function q(a,b){var c,d,e,f,g=B.width,h=B.height,i=C.width,j=C.height,l=h/j,m=g/i;if(!k(l)||!k(m))throw new Error("The caph-list's container and template view should have their own size such as width and height.");if(c=Math.floor(l),d=Math.floor(m),1>c||1>d)throw new Error("Please check the container and template view size. The calculated row or column count is less than 1.");e=Math.ceil(l),f=Math.ceil(m);var n={getMaxItemViewCount:function(){return this.getItemViewCountPerPage()*(2*b+1)},getMaxPageIndex:function(a){return Math.floor((a-1)/this.getItemViewCountPerPage())},getPageIndex:function(a){return Math.floor(a/this.getItemViewCountPerPage())},getStartItemIndex:function(a){return(a-b)*this.getItemViewCountPerPage()},getNextStartItemIndex:function(a){return(a+b+1)*this.getItemViewCountPerPage()},getPosition:function(a){var b=this.getRowIndex(a),c=this.getColumnIndex(a);return{top:b*j,left:c*i,rowIndex:b,columnIndex:c}},getNextPosition:function(a,b){var c=this.getPosition(a);switch(b){case o.LEFT:c.left-=i,c.columnIndex--;break;case o.RIGHT:c.left+=i,c.columnIndex++;break;case o.UP:c.top-=j,c.rowIndex--;break;case o.DOWN:c.top+=j,c.rowIndex++}return c}};return{horizontal:angular.extend({},n,{getItemViewCountPerPage:function(){return c*(d+1)},getRowIndex:function(a){return a%c},getColumnIndex:function(a){return Math.floor(a/c)},getTranslate:function(a,b,c){return c=angular.isNumber(c)?c:0,"translate3d("+(b*-i+c)+"px, 0px, 0px)"},getScrollIndex:function(a,b){return Math.max(0,this.getColumnIndex(a)-b)},getNextScrollIndex:function(a,b,c){var e=Math.ceil(b/i),f=a-e;return 0>b&&f++,f>c-d?f=c-d:0>f&&(f=0),f},isVisibleItem:function(a,b,c){return b>=c&&c+f>b},getMouseScrollKeyCode:function(b,c){var d=Math.abs(b-A.left);return a>d?o.LEFT:d>g-a?o.RIGHT:0},isScrollDirection:function(a){switch(a){case o.LEFT:case o.RIGHT:return!0}return!1},getRotateItemIndex:function(a,b,d){return b>0?a:Math.min(d-1,this.getMaxColumnIndex(d)*c+a)},getMaxRowIndex:function(){return c-1},getMaxColumnIndex:function(a){return Math.floor((a-1)/c)},getScrollStartCount:function(){return d},getInitialScrollCount:function(a){return Math.min(this.getScrollStartCount(),this.getColumnIndex(a))},isPreviousDirection:function(a){return a===o.LEFT},isNextDirection:function(a){return a===o.RIGHT},getScrollCountVariation:function(a,b){return this.getColumnIndex(b)-this.getColumnIndex(a)},isReachedStart:function(a){return 0===this.getColumnIndex(a)},isReachedEnd:function(a,b){return this.getColumnIndex(a)===this.getMaxColumnIndex(b)}}),vertical:angular.extend({},n,{getItemViewCountPerPage:function(){return(c+1)*d},getRowIndex:function(a){return Math.floor(a/d)},getColumnIndex:function(a){return a%d},getTranslate:function(a,b,c){return c=angular.isNumber(c)?c:0,"translate3d(0px, "+(b*-j+c)+"px, 0px)"},getScrollIndex:function(a,b){return Math.max(0,this.getRowIndex(a)-b)},getNextScrollIndex:function(a,b,d){var e=Math.ceil(b/j),f=a-e;return 0>b&&f++,f>d-c?f=d-c:0>f&&(f=0),f},isVisibleItem:function(a,b,c){return a>=c&&c+e>a},getMouseScrollKeyCode:function(b,c){var d=Math.abs(c-A.top);return a>d?o.UP:d>h-a?o.DOWN:0},isScrollDirection:function(a){switch(a){case o.UP:case o.DOWN:return!0}return!1},getRotateItemIndex:function(a,b,c){return a>0?b:Math.min(c-1,this.getMaxRowIndex(c)*d+b)},getMaxRowIndex:function(a){return Math.floor((a-1)/d)},getMaxColumnIndex:function(){return d-1},getScrollStartCount:function(){return c},getInitialScrollCount:function(a){return Math.min(this.getScrollStartCount(),this.getRowIndex(a))},isPreviousDirection:function(a){return a===o.UP},isNextDirection:function(a){return a===o.DOWN},getScrollCountVariation:function(a,b){return this.getRowIndex(b)-this.getRowIndex(a)},isReachedStart:function(a){return 0===this.getRowIndex(a)},isReachedEnd:function(a,b){return this.getRowIndex(a)===this.getMaxRowIndex(b)}})}}function r(a,b,c){function d(a,b){var d;w.append(a.addClass("ng-hide")),d=a.filter(function(){return this.nodeType===Node.ELEMENT_NODE}).on("focused"+l,c),b.$on("$destroy",function(){d.off(l)}),f.push({element:d,scope:b})}var e,f=[];for(e=0;b>e;e++)a(d);return f}var s,t,u,v,w,x,y,z,A,B,C,D=p.items,E=p.itemLoader,F=m.KEY;if(D&&E)throw new Error('The "items" and "item-loader" option cannot be used together.');if(D){if(t=D.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)\s*$/),!t)throw new Error('Expected expression in form of "_item_ in _array_" but got "'+D+'".');F=t[1],u=t[2]}return v=g.find("> :first-child"),w=v.find("> :first-child"),x=p.direction||m.DIRECTION,y=p.duration||m.DURATION,z=p.ease||m.EASE,function(g,k,p,t,D){function G(){Ba=s.getItemViewCountPerPage(),Ca=s.getMaxItemViewCount(),Pa=s.getScrollStartCount()}function H(a){Da=a,Ea=a.length}function I(){return{width:v.width(),height:v.height()}}function J(){var a,b;return D(function(b,c){a={element:b,scope:c},ia(a),w.append(a.element)}),b=w.find("> :first-child"),g.$applyAsync(function(){a.scope.$destroy(),a.element.remove()}),{width:b.outerWidth(!0),height:b.outerHeight(!0)}}function K(a){if(Ta>=Ea)throw new Error('Item Count is too small. It\'s should be greater than or equals to "initial-item-index value (default:0)".');A=k.offset(),Ia=s.getMaxPageIndex(Ea),Qa=s.getInitialScrollCount(Ta),Aa=r(D,Ca,function(a,b){var c,d,e,f;b&&(c=b.type,d=jQuery(a.currentTarget).data(),e=d.listItemIndex,Ta!==e&&("mouseover"!==c&&"keydown"!==c||(f=s.getPageIndex(e),ra(e),ma(Ha,f),U(e,d.listItemRowIndex,d.listItemColumnIndex,f),"keydown"===c&&T(e))),fa(e))}),U(Ta),N(s.getStartItemIndex(Ha),s.getNextStartItemIndex(Ha),a),T(Ta),g.initialized=!0}function L(){return(Ca+(Ra-1))%Ca}function M(){return(Ra+1)%Ca}function N(a,b,c){for(var d;b>a&&(d=Aa[Ra],Q(d,F,Sa.get(a),a++,Sa.getTotalCount()),Ra=M(),(c||angular.noop)(d)!==!1););}function O(a,b,c){for(var d;a>b;)if(Ra=L(),d=Aa[Ra],(c||angular.noop)(d,a--)===!1){Ra=M();break}}function P(a,b,c){O(a,b,function(a,b){return Q(a,F,Sa.get(b),b,Sa.getTotalCount()),(c||angular.noop)(a)})}function Q(a,b,c,d,e){c=d>-1&&e>d?c:null,R(a.scope,b,c,d,e),S(a.element,d,s.getPosition(d),c),c&&ia(a)}function R(a,b,c,d,e){a[b]=c||{},a.$index=d,a.$first=0===d,a.$last=d===e-1,a.$odd=!(a.$even=0===(1&d))}function S(a,b,c,d){a.css({position:"absolute",transform:"translate3d("+c.left+"px, "+c.top+"px, 0px)"}).data({listItem:!0,listItemIndex:b,listItemRowIndex:c.rowIndex,listItemColumnIndex:c.columnIndex,isVisibleListItem:function(a,b){return s.isVisibleItem(a,b,Oa)}}),d?a.removeClass("ng-hide"):a.addClass("ng-hide")}function T(a,b){var c;b?Oa=s.getScrollIndex(a,0):0===Qa?Oa=s.getScrollIndex(a,Qa):Qa===Pa&&(Oa=s.getScrollIndex(a,Qa-1)),za||(za=s.getTranslate(a,Oa),w.css("transform",za)),c=s.getTranslate(a,Oa),(c!==za||b)&&(b&&ta("touched"),w.css("transform",c),za=c,La||(La=!0,ha("on-scroll-start")))}function U(a,b,c,d){Ta=a,Fa=b||s.getRowIndex(a),Ga=c||s.getColumnIndex(a),Ha=d||s.getPageIndex(a)}function V(a){var b,c=-1;Ia=s.getMaxPageIndex(Ea),H(a),Ha>=Ia-1&&(b=s.getNextStartItemIndex(Ha),O(b-1,-1,function(a,b){return a.element.hasClass("ng-hide")?void 0:(c=b,!1)}),N(c+1,b))}function W(a){var b,c,d,e=!1;H(a),b=Ea-1,Ia=s.getMaxPageIndex(Ea),Ha>Ia?(N(s.getStartItemIndex(Ia),s.getNextStartItemIndex(Ia),function(a){var b;c||(b=a.element,b.data().listItemIndex+1===Ea&&(c=b))}),ra(b),U(b),T(b),Z(i.getCurrentFocusItem())&&i.focus(c)):Ha>=Ia-1&&(d=s.getNextStartItemIndex(Ha),O(d-1,-1,function(a,d){var f=a.element;return f.hasClass("focused")&&(e=!0,d!==b&&i.blur(f)),d===b?(c=f,!1):void 0}),N(b+1,d),Ta>b?(ra(b),U(b),T(b),e&&i.focus(c),fa(b)):s.isReachedEnd(Ta,Ea)&&ha("on-reach-end"))}function X(){var a=Z(i.getCurrentFocusItem());a&&i.blur(),oa(),K(function(b){var c=b.element;a&&Ta===c.data().listItemIndex&&d(function(){i.focus(c)})})}function Y(){var a=Z(i.getCurrentFocusItem());a&&i.blur(),oa(),Ta=va;var b;a?K(function(a){var c=a.element;0!==c.data().listItemIndex&&c.data().focusableInitialFocus!==!0||(b=c)}):K(),b&&d(function(){i.focus(b)})}function Z(a){return a?(a=jQuery(a),a.data().listItem&&w[0]===a.parent()[0]):!1}function $(){return Ma}function _(){Ma=!0,da()}function aa(){xa=d(function(){Ma=!1},Na)}function ba(){return ya}function ca(a){ba()||(ya=e(function(){var b=Ta;$()||Sa.isLoading()||(sa(),ea(s.getNextPosition(Ta,a),!0),b!==Ta&&ga(Ta))},Na))}function da(){ba()&&(e.cancel(ya),ya=null)}function ea(a,b){var c=la(a);if(c){if(c.index===Ta)return!1;if(U(c.index,c.rowIndex,c.columnIndex,c.pageIndex),T(c.index),Sa.isNeededForPrevious(Ta)?(Sa.setOffset(Sa.getOffset()-3*Sa.getLoadingCount()),Sa.request(function(a,b){Sa.setOffset(Sa.getOffset()+2*Sa.getLoadingCount()),Sa.prepend(a)})):Sa.isNeededForNext(Ta)&&Sa.request(function(a,b){Sa.append(a),Sa.setOffset(Sa.getOffset()+Sa.getLoadingCount())}),(b||c.force)&&c.element)return i.focus(c.element),!1}else{if(La)return!1;Ja&&!b&&(oa(),Ta=s.getRotateItemIndex(Fa,Ga,Ea),K(function(a){var b=a.element;Ta===b.data().listItemIndex&&d(function(){i.focus(b)})}))}}function fa(a){ha("on-focus-item-view"),ga(a)}function ga(a){s.isReachedStart(a)?ha("on-reach-start"):s.isReachedEnd(a,Ea)&&ha("on-reach-end")}function ha(b){g.$applyAsync(function(c){(a(p[p.$normalize(b)])||angular.noop)(c,{$context:{itemIndex:Ta,rowIndex:Fa,columnIndex:Ga,pageIndex:Ha,maxPageIndex:Ia,itemCount:Ea,itemViewCountPerPage:Ba}})})}function ia(b){(a(p[p.$normalize("on-decorate-item-view")])||angular.noop)(g,{$itemView:b})}function ja(a){return 0>a||s.getMaxRowIndex(Ea)<a}function ka(a){return 0>a||s.getMaxColumnIndex(Ea)<a}function la(a){var b,c,d,e,f,g,h,i,j=Ea-1;return b=a.rowIndex,c=a.columnIndex,ja(b)||ka(c)?i:(Aa.forEach(function(a){d=a.element,h=d.data(),h.listItemIndex===j&&(g=d),b===h.listItemRowIndex&&c===h.listItemColumnIndex&&(d.hasClass("ng-hide")?(e=j,i={rowIndex:s.getRowIndex(e),columnIndex:s.getColumnIndex(e),force:!0}):(e=h.listItemIndex,i={rowIndex:b,columnIndex:c,element:d}),f=s.getPageIndex(e),ma(Ha,f),i.index=e,i.pageIndex=f)}),i&&i.force&&(i.element=g),i)}function ma(a,b){var c;b>a?(c=(b+Ka)*Ba,N(c,c+Ba)):a>b&&(c=(b-Ka+1)*Ba-1,P(c,c-Ba))}function na(){var a=I(),b=J();B.width===a.width&&B.height===a.height&&C.width===b.width&&C.height===b.height||g.$applyAsync(function(){_(),B=a,C=b,s=q(wa,Ka)[x],G(),X(),aa()})}function oa(){Aa.forEach(function(a){a.scope.$destroy(),a.element.remove()}),Aa=null}function pa(a){b.trigger({type:"keydown",keyCode:a})}function qa(a){s.isPreviousDirection(a)&&Qa>0?Qa--:s.isNextDirection(a)&&Pa>Qa&&Qa++}function ra(a){Qa=Math.max(0,Math.min(Pa,Qa+s.getScrollCountVariation(Ta,a)))}function sa(){1===Qa?Qa=0:Qa===Pa-1&&(Qa=Pa)}function ta(a){switch(a){case"touched":w.css("transition","transform 1s ease-out");break;default:w.css("transition",[f.getVendorStyle("transform"),y,z].join(" "))}}function ua(a){var b,c=a.event.keyCode;if($()||Sa.isLoading())return!1;if(Z(a.currentFocusItem)&&s.isScrollDirection(c))return _(),qa(c),b=ea(s.getNextPosition(Ta,c)),aa(),b;if(La){if(h.isVisible(w))return!1;void(La=!1)}}var va=g.$eval(p.initialItemIndex)||0,wa=g.$eval(p.mouseScrollAreaSize);angular.isNumber(wa)||(wa=m.MOUSE_SCROLL_AREA_SIZE);var xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja=g.$eval(p.loop)||m.LOOP,Ka=g.$eval(p.pageBufferSize)||m.PAGE_BUFFER_SIZE,La=!1,Ma=!1,Na=g.$eval(p.delay)||m.DELAY,Oa=0,Pa=0,Qa=0,Ra=0,Sa={getTotalCount:function(){return Ea},get:function(a){return Da[a]},isNeededForPrevious:angular.noop,isNeededForNext:angular.noop,isLoading:angular.noop,request:angular.noop,prepend:angular.noop,append:angular.noop},Ta=va;if(E&&Ja)throw new Error('Cannot use continuous circular loop mode when using "item-loader".');if(i.addBeforeKeydownHandler(ua),n.forEach(function(a){g[a.name]=p[a.name]||a.defaultValue}),u&&g.$watchCollection(u,function(a){var b=a.length;_(),g.initialized?b>Ea?V(a):Ea>b?W(a):H(a):b>0&&(H(a),B=I(),C=J(),s=q(wa,Ka)[x],G(),K()),aa()}),k.on("moveleft"+l,function(a){pa(o.LEFT),a.stopPropagation()}).on("moveright"+l,function(a){pa(o.RIGHT),a.stopPropagation()}).on("moveup"+l,function(a){pa(o.UP),a.stopPropagation()}).on("movedown"+l,function(a){pa(o.DOWN),a.stopPropagation()}).on("reload"+l,function(a){g.$applyAsync(function(){_(),X(),aa()}),a.stopPropagation()}).on("reset"+l,function(a){g.$applyAsync(function(){_(),Y(),aa()}),a.stopPropagation()}).on("resize"+l,na),v.on("mousemove"+l,function(a){var b=s.getMouseScrollKeyCode(a.clientX,a.clientY);0!==b?ca(b):da()}).on("mouseout"+l,function(a){Z(a.relatedTarget)||(da(),i.blur())}),w.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(){La=!1,ha("on-scroll-finish")}),"undefined"!=typeof window.Hammer){var Ua,Va=new Hammer.Manager(w[0],{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});Va.on("panmove",function(a){var b="horizontal"===x?a.deltaX:a.deltaY,c=s.getTranslate(Oa,Oa,b);w.css("transform",c);var d=s.getNextScrollIndex(Oa,b,Ea);Ta!==d&&g.$applyAsync(function(){var a=s.getPageIndex(d);ma(Ha,a),ra(d),U(d)})}),Va.on("panstart",function(a){Ua=w.css("transition"),w.css("transition","transform 0s ease")}),Va.on("panend",function(a){var b="horizontal"===x?a.deltaX:a.deltaY,c=s.getNextScrollIndex(Oa,b,Ea);T(c,!0),Ua&&w.css("transition",Ua)})}jQuery(c).on("resize"+l,na),d(function(){if(ta(),E){if(Sa=j.get(E),!Sa)throw new Error("No such item loader: "+E);B=I(),C=J(),s=q(wa,Ka)[x],G(),Sa.setLoadingCount(Ca+Ba),Sa.setThresholdCount(Ba*Ka+Ba),Sa.initialize(function(a,b,c,d){_(),Ea=b,K(),aa()})}}),g.$on("$destroy",function(){La=!1,Ma=!1,oa(),v.off(l),k.off(l),jQuery(c).off(l),i.removeBeforeKeydownHandler(ua)})}}}}];ListItemLoaderProvider.$inject=["focusControllerProvider"];var caphRadioButtonDirective=["radiobuttonManager","$parse","focusController","FocusUtil",function(a,b,c,d){return{restrict:"E",transclude:!0,template:'<div ng-class="radiobuttonClass" focusable ng-transclude on-focused="focus($event, $originalEvent)" on-selected="select($event, $originalEvent)" on-blurred="blur($event, $originalEvent)"></div>',scope:!0,link:function(c,e,f){c.radiobuttonClass=f.radiobuttonclass||"caph-radiobutton";var g=c.$eval(f.focusOption),h=f.group||"default",i=e.find("> div");a.addRadio(i,h),void 0!==f.selected&&a.selectRadio(i,h),g&&d.setData(i,g),f.$observe("radiobuttonClass",function(a){c.radiobuttonClass=a}),c.focus=function(a,d){(b(f.onFocused)||angular.noop)(c.$parent,{$event:a,$originalEvent:d})},c.blur=function(a,d){(b(f.onBlurred)||angular.noop)(c.$parent,{$event:a,$originalEvent:d})},c.select=function(d,e){a.selectRadio(i,h),(b(f.onSelected)||angular.noop)(c.$parent,{$event:d,$originalEvent:e})}}}}],radiobuttonManagerProvider=function(){var a={},b={addRadio:function(b,c){a[c]=a[c]||[],a[c].push(b)},selectRadio:function(b,c){for(var d in a[c])void 0!==a[c][d].parent().attr("selected")&&(a[c][d].removeClass("selected"),a[c][d].parent().removeAttr("selected"));void 0===b.parent().attr("selected")&&b.parent().attr("selected",""),b.addClass("selected")}};return{$get:function(){return{addRadio:b.addRadio,selectRadio:b.selectRadio}}}};angular.module("caph.ui",["caph.focus"],["$provide","$compileProvider","nearestFocusableFinderProvider",function(a,b,c){function d(a){var b,c,d=a.charAt(0).toUpperCase()+a.substr(1);return null===g?(b=f.style,a in b?(g="",a):(e.some(function(a){return c=a+d,c in b?(g=a,!0):void 0}),f=null,c)):g?g+d:a}var e=["Webkit","Moz","O","ms"],f=document.createElement("div"),g=null,h={DEFAULT:{focusableDepth:9999}},i={translateTo:function(a,b,c){a&&a.css("transform","translate3d("+b+"px,"+c+"px, 0)")},moveToCenter:function(a){if(a){var b=window.innerWidth/2-a[0].clientWidth/2,c=window.innerHeight/2-a[0].clientHeight/2;0>c&&(c=0),0>b&&(b=0),b-=1*a[0].offsetLeft,this.translateTo(a,b,c)}}},j={getVendorProperty:d,getVendorStyle:function(a){var b=d(a);return b!==a?"-"+b.replace(/[A-Z]/g,function(a,b){var c=a.toLowerCase();return 0===b?c:"-"+c}):b}};["transform","transition"].forEach(function(a){var b=d(a);b!==a&&(jQuery.cssHooks[a]={get:function(a){return jQuery.css(a,b)},set:function(a,c){a.style[b]=c}})}),a.constant("DialogConstant",h),a.constant("DialogUtil",i),a.constant("VendorUtil",j),a.provider({dialogManager:dialogManagerProvider,radiobuttonManager:radiobuttonManagerProvider,listItemLoader:ListItemLoaderProvider}),b.directive({caphDialogTitle:caphDialogTitleDirective,caphDialogContent:caphDialogContentDirective,caphDialogButtons:caphDialogButtonsDirective,caphDialog:caphDialogDirective,caphList:caphListDirective,caphButton:caphButtonDirective,caphTransclude:caphTranscludeDirective,caphContextMenuItemTemplate:caphContextMenuItemTemplateDirective,caphContextMenuArrowUpTemplate:caphContextMenuArrowUpTemplateDirective,caphContextMenuArrowDownTemplate:caphContextMenuArrowDownTemplateDirective,caphContextMenu:caphContextMenuDirective,caphCheckbox:caphCheckboxDirective,caphRadiobutton:caphRadioButtonDirective,caphDropdownListItemTemplate:caphDropdownListItemTemplateDirective,caphDropdownListPlaceholderTemplate:caphDropdownListPlaceholderTemplateDirective,caphDropdownListArrowUpTemplate:caphDropdownArrowUpTemplateDirective,caphDropdownListArrowDownTemplate:caphDropdownArrowDownTemplateDirective,caphDropdownList:caphDropdownListDirective,caphInput:caphInputDirective}),c.addBeforeDistanceCalculationHandler(function(a){var b=jQuery(a).data()||{};return b.listItem!==!0||b.isVisibleListItem(b.listItemRowIndex,b.listItemColumnIndex)?void 0:!1})}]),function($){$.fn.smartTvKeyboard=function(opts){var smartTvKeyboards=this,noKeyBoard=smartTvKeyboards.length;return this.each(function(index){function init(){$.extend(options,opts),lang=options.defLang||getLangKeys()[0],mode=options.defMode||getModeKeys()[0],cursorPosition=that.val().length,parentElement="inline"===options.type?that.parent():$("body"),bind()}function bind(){that.on(options.openOn,showKeyboard)}function showKeyboard(){if(!keyboardElement){var title=that.attr("title");inputElement=that.clone().addClass("smart-tv-keyboard-input"),that.parent().addClass("focused"),inputElement.offset({top:that.offset().top+25,left:that.offset().left}),keyboardElement=$(keyboardTemplate),keyboardElement.find(".smart-tv-keyboard-input-section").append(inputElement),inputElement.val(that.val()),setCursorPosition(cursorPosition),setMainCursorPosition(cursorPosition),options.title?keyboardElement.find(".smart-tv-keyboard-title").text(options.title):keyboardElement.find(".smart-tv-keyboard-title").text(title),"inline"===options.type?that.after(keyboardElement):(backdropElement=$(backdropTemplate),parentElement.append(keyboardElement),parentElement.append(backdropElement),keyboardElement.toggleClass("smart-tv-keyboard-modal",!0)),renderGrid(),keepFocus(),bindInputKeydown()}}function processKeydown(evt){evt=evt||window.event,options.useNavKeys&&processKeyCode(evt.keyCode),!options.useDirectEdit&&evt.preventDefault()}function bindInputKeydown(){document.addEventListener("keydown",processKeydown)}function keepFocus(){inputElement.focus(),inputElement.on("blur",function(){this.focus()})}function renderGrid(){var x,language=options.layouts[lang],gridElement=keyboardElement.find(".smart-tv-keyboard-grid").empty(),y=0;for(var rowIndex in language[mode]){x=0;var rowValue=language[mode][rowIndex],rowElement=$(rowTemplate);for(var colIndex in rowValue){var value=rowValue[colIndex],button=$(buttonTemplate);button.attr("data-size",value.length),button.addClass("smart-tv-keyboard-button-length-"+value.length),button.addClass("smart-tv-keyboard-button-color-"+value.color),0===kbIndex&&"&&previous"===value.value?(value.value="&&close",value.text="Đóng"):"&&previous"===value.value?(value.value="&&previous",value.text="Quay lại"):kbIndex===noKeyBoard-1&&"&&next"===value.value?(value.value="&&login",value.text="Đăng nhập"):kbIndex===noKeyBoard-1&&"&&login"===value.value?(value.value="&&next",value.text="Tiếp theo"):kbIndex!==noKeyBoard-1||"&&previous"!==value.value&&"&&close"!==value.value?noKeyBoard-2>=kbIndex&&"&&login"===value.value?(value.value="&&next",value.text="Tiếp theo"):noKeyBoard-1>=kbIndex&&"&&next"===value.value&&(value.value="&&next",value.text="Tiếp theo"):(value.value="&&previous",value.text="Quay lại"),button.text(value.text),bindBtnClick(button,value.value),rowElement.append(button);for(var i=0;i<value.length;i++)button.addClass(x+"-"+y),x++}y++,gridElement.append(rowElement)}x=0,y=0,selectBtn()}function bindBtnClick(btn,value){value&&btn&&btn.on("click",function(){processKeyValue(value),selectBtn(btn)})}function selectBtn(btn){if(selectedButtonElement&&selectedButtonElement.toggleClass("smart-tv-keyboard-button-selected",!1),btn){var coord=/\d+\-\d+/.exec(btn.attr("class"));if(coord&&coord[0]){var xy=coord[0].split("-");x=parseInt(xy[0],10),y=parseInt(xy[1],10),selectedButtonElement=btn}}else selectedButtonElement=keyboardElement.find("."+x+"-"+y);selectedButtonElement.toggleClass("smart-tv-keyboard-button-selected",!0)}function processKeyValue(value){var currentValue;switch(value){case"&&cursorMoveLeft":cursorMove(-1);break;case"&&cursorMoveRight":cursorMove(1);break;case"&&clear":inputElement.val(""),that.val(""),that.trigger("input"),that.trigger("change"),cursorPosition=0;break;case"&&back":cursorMove(-1),currentValue=inputElement.val(),currentValue=currentValue.slice(0,cursorPosition)+currentValue.slice(cursorPosition+1),inputElement.val(currentValue),that.val(currentValue),that.trigger("input"),that.trigger("change"),setCursorPosition(cursorPosition);break;case"&&switchMode":toggleMode(),renderGrid();break;case"&&switchLanguage":toggleLanguage(),renderGrid();break;case"&&enter":that.val(inputElement.val()),that.trigger("input"),that.trigger("change"),options.onEnter&&options.onEnter(inputElement.val()),that.show();break;case"&&next":options.onEnter&&options.onEnter(inputElement.val()),that.parent().removeClass("focused"),destroy(),smartTvKeyboards[kbIndex+1].click();break;case"&&previous":options.onEnter&&options.onEnter(inputElement.val()),that.parent().removeClass("focused"),destroy(),smartTvKeyboards[kbIndex-1].click();break;case"&&login":that.val(inputElement.val()),that.trigger("input"),that.trigger("change"),options.onEnter&&options.onEnter(inputElement.val()),removeKeyboardListenerFunc=removeEventListener,$(".btn-login").click();break;case"&&close":destroy(),$(".btn-login-cancel").click();break;case"&&cancel":options.onCancel&&options.onCancel(inputElement.val()),that.show();break;default:cursorPosition++,currentValue=inputElement.val(),currentValue=currentValue.slice(0,cursorPosition)+value+currentValue.slice(cursorPosition),inputElement.val(currentValue),that.val(currentValue),that.trigger("input"),that.trigger("change"),setCursorPosition(cursorPosition)}}function processKeyCode(code){var KEYS=options.navKeys;switch(code){case KEYS.UP:move("UP");break;case KEYS.DOWN:move("DOWN");break;case KEYS.LEFT:move("LEFT");break;case KEYS.RIGHT:move("RIGHT");break;case KEYS.RETURN:options.onCancel&&options.onCancel(inputElement.val()),destroy(),smartTvKeyboards.removeClass("focused");break;case KEYS.EXIT:
options.onCancel&&options.onCancel(inputElement.val()),destroy(),$(".btn-login-cancel").click();break;case KEYS.ENTER:keyboardElement.find("."+x+"-"+y).click()}}function move(direction){var matrix=options.layouts[lang][mode],maxY=matrix.length-1,maxX=-1;for(var index in matrix[y])maxX+=matrix[y][index].length;switch(direction){case"LEFT":x=--x<0?maxX:x;break;case"RIGHT":x=++x>maxX?0:x;break;case"UP":y=--y<0?maxY:y;break;case"DOWN":y=++y>maxY?0:y}var newButtonElement=keyboardElement.find("."+x+"-"+y);return newButtonElement.hasClass("smart-tv-keyboard-button-color-disabled")||selectedButtonElement&&selectedButtonElement.hasClass(x+"-"+y)?move(direction):void selectBtn()}function cursorMove(step){var value=inputElement.val();cursorPosition+=step,0>cursorPosition?cursorPosition=0:cursorPosition>value.length&&(cursorPosition=value.length),setCursorPosition(cursorPosition)}function setCursorPosition(pos){var el=inputElement[0];if(el.setSelectionRange)el.setSelectionRange(pos,pos);else if(el.createTextRange){var range=el.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function setMainCursorPosition(pos){var el=that;if(el.setSelectionRange)el.setSelectionRange(pos,pos);else if(el.createTextRange){var range=el.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}function getLangKeys(){return Object.keys(options.layouts)}function getModeKeys(){return Object.keys(options.layouts[lang])}function toggleMode(){for(var modes=getModeKeys(),newMode=modes[0],i=0;i<modes.length;i++)mode===modes[i]&&modes[i+1]&&(newMode=modes[i+1]);return mode=newMode,newMode}function toggleLanguage(){for(var layouts=getLangKeys(),newLang=layouts[0],i=0;i<layouts.length;i++)lang===layouts[i]&&layouts[i+1]&&(newLang=layouts[i+1]);return lang=newLang,newLang}function destroy(){backdropElement&&backdropElement.remove(),keyboardElement&&keyboardElement.remove(),keyboardElement=null,removeEventListener()}function removeEventListener(){document.removeEventListener?document.removeEventListener("keydown",processKeydown):document.detachEvent&&document.detachEvent("keydown",processKeydown)}var lang,mode,keyboardElement,parentElement,inputElement,selectedButtonElement,backdropElement,kbIndex=index,that=$(this),cursorPosition=0,x=0,y=0,keyboardTemplate='<div class="smart-tv-keyboard"><div class="smart-tv-keyboard-title"></div><div class="smart-tv-keyboard-input-section"></div><div class="smart-tv-keyboard-grid"></div></div>',rowTemplate='<div class="smart-tv-keyboard-row"></div>',buttonTemplate='<div class="smart-tv-keyboard-button"></div>',backdropTemplate='<div class="smart-tv-keyboard-backdrop"></div>',options={title:null,defLang:null,defMode:null,layouts:{},type:"inline",openOn:"click focus",onEnter:null,onCancel:null,useDirectEdit:!0,useNavKeys:!0,navKeys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,EXIT:8,RETURN:10009}};init()})}}(window.jQuery||window.Zepto),function(window,document){angular.module("toaster",[]).constant("toasterConfig",{limit:0,"tap-to-dismiss":!0,"close-button":!1,"close-html":'<button class="toast-close-button" type="button">&times;</button>',"newest-on-top":!0,"time-out":5e3,"icon-classes":{error:"toast-error",info:"toast-info",wait:"toast-wait",success:"toast-success",warning:"toast-warning"},"body-output-type":"","body-template":"toasterBodyTmpl.html","icon-class":"toast-info","position-class":"toast-top-center","title-class":"toast-title","message-class":"toast-message","prevent-duplicates":!1,"mouseover-timer-stop":!0}).run(["$templateCache",function($templateCache){$templateCache.put("angularjs-toaster/toast.html",'<div id="toast-container" ng-class="[config.position, config.animation]"><div ng-repeat="toaster in toasters" class="toast" ng-class="toaster.type" ng-click="click($event, toaster)" ng-mouseover="stopTimer(toaster)" ng-mouseout="restartTimer(toaster)"><div ng-if="toaster.showCloseButton" ng-click="click($event, toaster, true)" ng-bind-html="toaster.closeHtml"></div><div ng-class="config.title">{{toaster.title}}</div><div ng-class="config.message" ng-switch on="toaster.bodyOutputType"><div ng-switch-when="trustedHtml" ng-bind-html="toaster.html"></div><div ng-switch-when="template"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="templateWithData"><div ng-include="toaster.bodyTemplate"></div></div><div ng-switch-when="directive"><div directive-template directive-name="{{toaster.html}}" directive-data="{{toaster.directiveData}}"></div></div><div ng-switch-default >{{toaster.body}}</div></div></div></div>')}]).service("toaster",["$rootScope","toasterConfig",function($rootScope,toasterConfig){function createTypeMethod(toasterType){return function(title,body,timeout,bodyOutputType,clickHandler,toasterId,showCloseButton,toastId,onHideCallback){return angular.isString(title)?this.pop(toasterType,title,body,timeout,bodyOutputType,clickHandler,toasterId,showCloseButton,toastId,onHideCallback):this.pop(angular.extend(title,{type:toasterType}))}}var Guid=function(){var Guid={};return Guid.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})},Guid}();this.pop=function(type,title,body,timeout,bodyOutputType,clickHandler,toasterId,showCloseButton,toastId,onHideCallback){if(angular.isObject(type)){var params=type;this.toast={type:params.type,title:params.title,body:params.body,timeout:params.timeout,bodyOutputType:params.bodyOutputType,clickHandler:params.clickHandler,showCloseButton:params.showCloseButton,closeHtml:params.closeHtml,toastId:params.toastId,onShowCallback:params.onShowCallback,onHideCallback:params.onHideCallback,directiveData:params.directiveData,tapToDismiss:params.tapToDismiss},toasterId=params.toasterId}else this.toast={type:type,title:title,body:body,timeout:timeout,bodyOutputType:bodyOutputType,clickHandler:clickHandler,showCloseButton:showCloseButton,toastId:toastId,onHideCallback:onHideCallback};return this.toast.toastId&&this.toast.toastId.length||(this.toast.toastId=Guid.newGuid()),$rootScope.$emit("toaster-newToast",toasterId,this.toast.toastId),{toasterId:toasterId,toastId:this.toast.toastId}},this.clear=function(toasterId,toastId){angular.isObject(toasterId)?$rootScope.$emit("toaster-clearToasts",toasterId.toasterId,toasterId.toastId):$rootScope.$emit("toaster-clearToasts",toasterId,toastId)};for(var type in toasterConfig["icon-classes"])this[type]=createTypeMethod(type)}]).factory("toasterEventRegistry",["$rootScope",function($rootScope){var toasterFactory,deregisterNewToast=null,deregisterClearToasts=null,newToastEventSubscribers=[],clearToastsEventSubscribers=[];return toasterFactory={setup:function(){deregisterNewToast||(deregisterNewToast=$rootScope.$on("toaster-newToast",function(event,toasterId,toastId){for(var i=0,len=newToastEventSubscribers.length;len>i;i++)newToastEventSubscribers[i](event,toasterId,toastId)})),deregisterClearToasts||(deregisterClearToasts=$rootScope.$on("toaster-clearToasts",function(event,toasterId,toastId){for(var i=0,len=clearToastsEventSubscribers.length;len>i;i++)clearToastsEventSubscribers[i](event,toasterId,toastId)}))},subscribeToNewToastEvent:function(onNewToast){newToastEventSubscribers.push(onNewToast)},subscribeToClearToastsEvent:function(onClearToasts){clearToastsEventSubscribers.push(onClearToasts)},unsubscribeToNewToastEvent:function(onNewToast){var index=newToastEventSubscribers.indexOf(onNewToast);index>=0&&newToastEventSubscribers.splice(index,1),0===newToastEventSubscribers.length&&(deregisterNewToast(),deregisterNewToast=null)},unsubscribeToClearToastsEvent:function(onClearToasts){var index=clearToastsEventSubscribers.indexOf(onClearToasts);index>=0&&clearToastsEventSubscribers.splice(index,1),0===clearToastsEventSubscribers.length&&(deregisterClearToasts(),deregisterClearToasts=null)}},{setup:toasterFactory.setup,subscribeToNewToastEvent:toasterFactory.subscribeToNewToastEvent,subscribeToClearToastsEvent:toasterFactory.subscribeToClearToastsEvent,unsubscribeToNewToastEvent:toasterFactory.unsubscribeToNewToastEvent,unsubscribeToClearToastsEvent:toasterFactory.unsubscribeToClearToastsEvent}}]).directive("directiveTemplate",["$compile","$injector",function($compile,$injector){return{restrict:"A",scope:{directiveName:"@directiveName",directiveData:"@directiveData"},replace:!0,link:function(scope,elm,attrs){scope.$watch("directiveName",function(directiveName){if(angular.isUndefined(directiveName)||directiveName.length<=0)throw new Error("A valid directive name must be provided via the toast body argument when using bodyOutputType: directive");var directive;try{directive=$injector.get(attrs.$normalize(directiveName)+"Directive")}catch(e){throw new Error(directiveName+" could not be found. The name should appear as it exists in the markup, not camelCased as it would appear in the directive declaration, e.g. directive-name not directiveName.")}var directiveDetails=directive[0];if(directiveDetails.scope!==!0&&directiveDetails.scope)throw new Error("Cannot use a directive with an isolated scope. The scope must be either true or falsy (e.g. false/null/undefined). Occurred for directive "+directiveName+".");if(directiveDetails.restrict.indexOf("A")<0)throw new Error('Directives must be usable as attributes. Add "A" to the restrict option (or remove the option entirely). Occurred for directive '+directiveName+".");scope.directiveData&&(scope.directiveData=angular.fromJson(scope.directiveData));var template=$compile("<div "+directiveName+"></div>")(scope);elm.append(template)})}}}]).directive("toasterContainer",["$parse","$rootScope","$interval","$sce","toasterConfig","toaster","toasterEventRegistry",function($parse,$rootScope,$interval,$sce,toasterConfig,toaster,toasterEventRegistry){return{replace:!0,restrict:"EA",scope:!0,link:function(scope,elm,attrs){function setTimeout(toast,time){toast.timeoutPromise=$interval(function(){scope.removeToast(toast.toastId)},time,1)}function addToast(toast,toastId){if(toast.type=mergedConfig["icon-classes"][toast.type],toast.type||(toast.type=mergedConfig["icon-class"]),mergedConfig["prevent-duplicates"]===!0&&scope.toasters.length){if(scope.toasters[scope.toasters.length-1].body===toast.body)return;var i,len,dupFound=!1;for(i=0,len=scope.toasters.length;len>i;i++)if(scope.toasters[i].toastId===toastId){dupFound=!0;break}if(dupFound)return}var closeButton=mergedConfig["close-button"];if("boolean"==typeof toast.showCloseButton);else if("boolean"==typeof closeButton)toast.showCloseButton=closeButton;else if("object"==typeof closeButton){var closeButtonForType=closeButton[toast.type];"undefined"!=typeof closeButtonForType&&null!==closeButtonForType&&(toast.showCloseButton=closeButtonForType)}else toast.showCloseButton=!1;switch(toast.showCloseButton&&(toast.closeHtml=$sce.trustAsHtml(toast.closeHtml||scope.config.closeHtml)),toast.bodyOutputType=toast.bodyOutputType||mergedConfig["body-output-type"],toast.bodyOutputType){case"trustedHtml":toast.html=$sce.trustAsHtml(toast.body);break;case"template":toast.bodyTemplate=toast.body||mergedConfig["body-template"];break;case"templateWithData":var fcGet=$parse(toast.body||mergedConfig["body-template"]),templateWithData=fcGet(scope);toast.bodyTemplate=templateWithData.template,toast.data=templateWithData.data;break;case"directive":toast.html=toast.body}scope.configureTimer(toast),mergedConfig["newest-on-top"]===!0?(scope.toasters.unshift(toast),mergedConfig.limit>0&&scope.toasters.length>mergedConfig.limit&&scope.toasters.pop()):(scope.toasters.push(toast),mergedConfig.limit>0&&scope.toasters.length>mergedConfig.limit&&scope.toasters.shift()),angular.isFunction(toast.onShowCallback)&&toast.onShowCallback()}function removeToast(toastIndex){var toast=scope.toasters[toastIndex];toast.timeoutPromise&&$interval.cancel(toast.timeoutPromise),scope.toasters.splice(toastIndex,1),angular.isFunction(toast.onHideCallback)&&toast.onHideCallback()}function removeAllToasts(toastId){for(var i=scope.toasters.length-1;i>=0;i--)isUndefinedOrNull(toastId)?removeToast(i):scope.toasters[i].toastId==toastId&&removeToast(i)}function isUndefinedOrNull(val){return angular.isUndefined(val)||null===val}var mergedConfig;mergedConfig=angular.extend({},toasterConfig,scope.$eval(attrs.toasterOptions)),scope.config={toasterId:mergedConfig["toaster-id"],position:mergedConfig["position-class"],title:mergedConfig["title-class"],message:mergedConfig["message-class"],tap:mergedConfig["tap-to-dismiss"],closeButton:mergedConfig["close-button"],closeHtml:mergedConfig["close-html"],animation:mergedConfig["animation-class"],mouseoverTimer:mergedConfig["mouseover-timer-stop"]},scope.$on("$destroy",function(){toasterEventRegistry.unsubscribeToNewToastEvent(scope._onNewToast),toasterEventRegistry.unsubscribeToClearToastsEvent(scope._onClearToasts)}),scope.configureTimer=function(toast){var timeout=angular.isNumber(toast.timeout)?toast.timeout:mergedConfig["time-out"];"object"==typeof timeout&&(timeout=timeout[toast.type]),timeout>0&&setTimeout(toast,timeout)},scope.removeToast=function(toastId){var i,len;for(i=0,len=scope.toasters.length;len>i;i++)if(scope.toasters[i].toastId===toastId){removeToast(i);break}},scope.toasters=[],scope._onNewToast=function(event,toasterId,toastId){(isUndefinedOrNull(scope.config.toasterId)&&isUndefinedOrNull(toasterId)||!isUndefinedOrNull(scope.config.toasterId)&&!isUndefinedOrNull(toasterId)&&scope.config.toasterId==toasterId)&&addToast(toaster.toast,toastId)},scope._onClearToasts=function(event,toasterId,toastId){("*"==toasterId||isUndefinedOrNull(scope.config.toasterId)&&isUndefinedOrNull(toasterId)||!isUndefinedOrNull(scope.config.toasterId)&&!isUndefinedOrNull(toasterId)&&scope.config.toasterId==toasterId)&&removeAllToasts(toastId)},toasterEventRegistry.setup(),toasterEventRegistry.subscribeToNewToastEvent(scope._onNewToast),toasterEventRegistry.subscribeToClearToastsEvent(scope._onClearToasts)},controller:["$scope","$element","$attrs",function($scope,$element,$attrs){$scope.stopTimer=function(toast){$scope.config.mouseoverTimer===!0&&toast.timeoutPromise&&($interval.cancel(toast.timeoutPromise),toast.timeoutPromise=null)},$scope.restartTimer=function(toast){$scope.config.mouseoverTimer===!0?toast.timeoutPromise||$scope.configureTimer(toast):null===toast.timeoutPromise&&$scope.removeToast(toast.toastId)},$scope.click=function(event,toast,isCloseButton){event.stopPropagation();var tapToDismiss="boolean"==typeof toast.tapToDismiss?toast.tapToDismiss:$scope.config.tap;if(tapToDismiss===!0||toast.showCloseButton===!0&&isCloseButton===!0){var removeToast=!0;toast.clickHandler&&(angular.isFunction(toast.clickHandler)?removeToast=toast.clickHandler(toast,isCloseButton):angular.isFunction($scope.$parent.$eval(toast.clickHandler))&&(removeToast=$scope.$parent.$eval(toast.clickHandler)(toast,isCloseButton))),removeToast&&$scope.removeToast(toast.toastId)}}}],templateUrl:"angularjs-toaster/toast.html"}}])}(window,document);var app=angular.module("vietteltv",["ngSanitize","caph.ui","ui.router","ngResource","caph.media","http-auth-interceptor","toaster","LocalStorageModule"]).config(["focusControllerProvider",function(focusControllerProvider){focusControllerProvider.setInitialDepth(1),focusControllerProvider.setInitialGroupOfDepth(3,"SIDEBAR_CATEGORY")}]);app.value("SETTINGS",{guest_access_token:"00536aefb1f78bca51f8b3fde6f643c5",access_token:"00536aefb1f78bca51f8b3fde6f643c5",refresh_token_expiration_date:"",expiration_date:"",login_access_token:"",token_secret:"",client_id:"viettelSdpClient2",app_secret:"viettelSdpUserprofile1"}),app.run(["SETTINGS","localStorageService","Auth","$rootScope",function(SETTINGS,localStorageService,Auth,$rootScope){Auth.authorize(!0,function(){if(localStorageService.get("token")){var token=localStorageService.get("token");SETTINGS.access_token=token.access_token,SETTINGS.token_secret=token.token_secret,SETTINGS.login_access_token=token.login_access_token,SETTINGS.refresh_token=token.refresh_token,SETTINGS.expiration_date=token.expiration_date,SETTINGS.refresh_token_expiration_date=token.refresh_token_expiration_date,$rootScope.isAppLoadedAfterLogin=!0}else SETTINGS.access_token="00536aefb1f78bca51f8b3fde6f643c5",SETTINGS.token_secret="",$rootScope.isAppLoadedAfterLogin=!1}),localStorageService.get("deviceUdid")||(new Fingerprint2).get(function(result,components){localStorageService.set("deviceUdid",result)})}]),app.config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push(["$q","$timeout","$injector",function($q,$timeout,$injector){return{response:function(response){return null===response||null===response.data?$timeout(function(){var $http=$injector.get("$http");return $http(response.config)},5e3):response}}}]),$httpProvider.interceptors.push("authInterceptor"),$httpProvider.interceptors.push("tokenExpiredInterceptor")}]);var isLoginOK=!1,removeKeyboardListenerFunc,linkFn=function($scope,$element,$attr){$scope.title=$attr.title,$scope.id=1*$attr.id,$scope.listCategory=1*$attr.id,$attr.focusOption?$scope.focusable=$scope.$eval($attr.focusOption):$scope.focusable={depth:1,group:$attr.id}};app.directive("playList",function(){return{restrict:"E",templateUrl:"views/templates/playlist.html",scope:!0,link:linkFn}}),app.directive("categoryMenuList",function(){return{restrict:"E",templateUrl:"views/templates/categoryMenuList.html",scope:!0,link:function($scope,$element,$attr){$scope.title=$attr.title,$attr.focusOption?$scope.focusable=$scope.$eval($attr.focusOption):$scope.focusable={depth:1,group:$attr.id}}}}),app.directive("channelList",function(){return{restrict:"E",templateUrl:"views/templates/channelList.html",scope:!0,link:linkFn}}),app.directive("playListSm",function(){return{restrict:"E",templateUrl:"views/templates/playlistSm.html",scope:!0,link:linkFn}}).directive("relatedPlayList",function(){return{restrict:"E",templateUrl:"views/templates/relatedPlaylist.html",scope:!0}}).directive("episodePlayList",function(){return{restrict:"E",templateUrl:"views/templates/episodePlaylist.html",scope:!0}}),angular.module("caph.media",["caph.ui"],["$provide","$compileProvider",function($provide,$compileProvider){$compileProvider.directive({caphMedia:["$parse","$document",function($parse,$document){function invokeMethod(media,index,method,param){angular.isNumber(index)?media[index][method].apply(media[index],param):media.each(function(){this[method].apply(this,param)})}function setProperty(media,index,property,value){angular.isNumber(index)?media[index][property]=value:media.each(function(){this[property]=value})}function forEachProperty(media,index,property,callback){angular.isNumber(index)?callback(media[index][property]):media.each(function(){callback(this[property])})}function forEachTextTracks(media,callback,index){forEachProperty(media,index,"textTracks",function(textTracks){for(var i=0,length=textTracks.length;length>i;i++)callback(textTracks[i])})}var isFullScreen,requestFullScreen,exitFullScreen,CONSTANT={FORWARD_INTERVAL:15,FAST_FORWARD_INTERVAL:120},document=$document[0],documentElement=document.documentElement,isFullScreenEnabled=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled;return isFullScreenEnabled&&(["fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"].some(function(property){return void 0!==document[property]?(isFullScreen=property,!0):void 0}),["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"].some(function(method){return documentElement[method]?(requestFullScreen=method,!0):void 0}),["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"].some(function(method){return document[method]?(exitFullScreen=method,!0):void 0})),{restrict:"E",transclude:!0,scope:!0,controller:function($scope,$element,$attrs,$transclude){function doFullScreen(callback){isFullScreenEnabled&&callback($element[0])}var media,originalStyle={},isPlaying=!1,isChannel=!1;$scope.$watch($attrs.subtitle,function(subtitle){subtitle===!0?this.subTitle(!0):this.subTitle(!1)}.bind(this)),$scope.$watch($attrs.ischannel,function(ischannel){isChannel=ischannel}.bind(this)),$transclude(function(clone){$element.append(clone),media=$element.find("video, audio"),media.on("abort error stalled suspend loadstart durationchange loadedmetadata loadeddata progress canplay canplaythrough ended pause play playing ratechange seeked seeking timeupdate volumechange waiting",function(event){switch(event.type){case"play":case"playing":isPlaying=!0;break;case"pause":case"ended":isPlaying=!1}($parse($attrs[$attrs.$normalize("on-"+event.type)])||angular.noop)($scope,{$event:event})}),forEachTextTracks(media,function(textTrack){textTrack.oncuechange=function(event){($parse($attrs[$attrs.$normalize("on-"+event.type)])||angular.noop)($scope,{$event:event})}})}),$scope.$on("$destroy",function(){$element.remove()}),$element.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",function(){document[isFullScreen]?(this.style.display="block",this.style.width="100%",this.style.height="100%"):(this.style.display=originalStyle.display,this.style.width=originalStyle.width,this.style.height=originalStyle.height)}),["load","play","pause"].forEach(function(method){this[method]=function(index){invokeMethod(media,index,method)}},this),this.togglePlay=function(index){isChannel&&(isPlaying=!1);var methodType=isPlaying?"pause":"play";invokeMethod(media,index,methodType)},this.restart=function(index){angular.isNumber(index)?setProperty(media,index,"currentTime",media[index].currentTime-CONSTANT.FAST_FORWARD_INTERVAL):media.each(function(i){setProperty(media,i,"currentTime",media[i].currentTime-CONSTANT.FAST_FORWARD_INTERVAL)})},this.rewind=function(index){angular.isNumber(index)?setProperty(media,index,"currentTime",media[index].currentTime-CONSTANT.FORWARD_INTERVAL):media.each(function(i){setProperty(media,i,"currentTime",media[i].currentTime-CONSTANT.FORWARD_INTERVAL)})},this.forward=function(index){angular.isNumber(index)?setProperty(media,index,"currentTime",media[index].currentTime+CONSTANT.FORWARD_INTERVAL):media.each(function(i){setProperty(media,i,"currentTime",media[i].currentTime+CONSTANT.FORWARD_INTERVAL)})},this.next=function(index){angular.isNumber(index)?setProperty(media,index,"currentTime",media[index].currentTime+CONSTANT.FAST_FORWARD_INTERVAL):media.each(function(i){setProperty(media,i,"currentTime",media[i].currentTime+CONSTANT.FAST_FORWARD_INTERVAL)})},["autoplay","controls","currentTime","loop","mediaGroup","muted","playbackRate","preload","src","volume"].forEach(function(property){this[$attrs.$normalize("set-"+property)]=function(value,index){setProperty(media,index,property,value)}},this),this.subTitle=function(show,language,index){forEachTextTracks(media,function(textTrack){!show||language&&language!==textTrack.language?textTrack.mode="hidden":textTrack.mode="showing"},index)},this.requestFullScreen=function(){doFullScreen(function(element){originalStyle.display=element.style.display,originalStyle.width=element.style.width,originalStyle.height=element.style.height,element[requestFullScreen]()})},this.exitFullScreen=function(){doFullScreen(function(){document[exitFullScreen]()})},this.isFullScreen=function(){return document[isFullScreen]},this.toggleFullScreen=function(){this.isFullScreen()?this.exitFullScreen():this.requestFullScreen()}}}}],caphMediaControls:[function(){return{restrict:"E",require:"^caphMedia",transclude:!0,link:function($scope,$element,$attrs,controller,$transclude){$scope.controls=controller,$transclude(function(clone){$element.append(clone)})}}}]})}]),app.factory("CONSTANT",function(){var ITEM={loaded:!1},SERIES_CATEGORIES_BY_NAME=["PHIM BỘ","PHIM BỘ MIỄN PHÍ","KHU VƯỜN PHIM BỘ","Tiếng Anh lớp 6","Luyện Thi Toeic","YanTV","TV Show","Toán lớp 6","Tiếng Việt lớp 6","Toán lớp 10","Ngữ văn lớp 10","Tiếng Anh lớp 10","Toán THPTQG","Lý THPTQG","Hóa THPTQG","Giáo dục"];return{API_HOST:"http://otttv.viettel.com.vn",HTTPS_API_HOST:"https://otttv.viettel.com.vn",RECOMMENDATION_API_HOST:"http://otttv.viettel.com.vn",SERIES_CATEGORIES_BY_NAME:SERIES_CATEGORIES_BY_NAME,ITEM:ITEM,ITEMS:[ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM,ITEM],CATEGORY:{MENU:0,CHANNEL:1,COLORS:2,ALPHABETS:3,NUMBERS:4,RELATED_PLAY_LIST:5,RELATED_PLAY_LIST2:6},EFFECT_DELAY_TIME:500,SCROLL_HEIGHT_OF_INDEX:380,MEDIA_CONTROLLER_TIMEOUT:3500,KEY_CODE:{RETURN:10009,ESC:27,UP:38,DOWN:40,BACK:461},SPOTLIGHT_BG_GRADIENT1:"linear-gradient(to right, rgba(0, 0, 0, 1) 5%, transparent)",SPOTLIGHT_BG_GRADIENT2:"linear-gradient(to top, rgba(0, 0, 0, 1) 5%, transparent)",SPOTLIGHT_BG_SIZE:"80% 100%, 60% 0%, 100% 100%",SPOTLIGHT_BG_IMG_URL:"images/spotlight_movie.jpg",CATEGORY_PAGE_BG_GRADIENT1:"linear-gradient(to right, rgba(0, 0, 0, 1) 0%, transparent)",CATEGORY_PAGE_BG_GRADIENT2:"linear-gradient(to top, rgba(0, 0, 0, 1) 0%, transparent)",CATEGORY_PAGE_BG_SIZE:"40% 100%, 0% 0%, 100% 100%",CATEGORY_PAGE_BG_IMG_URL:"images/spotlight_movie.jpg",CATEGORY_CHANNEL_PAGE_BG_GRADIENT1:"linear-gradient(to right, rgb(0, 0, 0) 0%, transparent)",CATEGORY_CHANNEL_PAGE_BG_GRADIENT2:"linear-gradient(to bottom, rgba(0, 0, 0, 0.75) 0%, transparent)",CATEGORY_CHANNEL_PAGE_BG_SIZE:"100% 100%, 100% 100%, 100% 100%",CATEGORY_CHANNEL_PAGE_BG_IMG_URL:"images/menu_bg_focused_1.jpg",MENU_BG_GRADIENT1:"linear-gradient(to right, rgba(0, 0, 0, 1) 0%, transparent)",MENU_BG_GRADIENT2:"linear-gradient(to top, rgba(0, 0, 0, 1) 0%, transparent)",MENU_BG_SIZE:"50% 100%, 60% 0%, 100% 100%",MENU_BG_IMG_URL:"images/spotlight_movie.jpg",CATEGORY_BG_GRADIENT1:"linear-gradient(to right, rgb(0, 0, 0) 40%, transparent)",CATEGORY_BG_GRADIENT2:"linear-gradient(to top, rgb(0, 0, 0) 60%, transparent)",CATEGORY_BG_SIZE:"100% 100%, 60% 40%, 60% 100%",CATEGORY_VOD_BG_GRADIENT1:"linear-gradient(to right, rgb(0, 0, 0) 40%, transparent)",CATEGORY_VOD_BG_GRADIENT2:"linear-gradient(to top, rgb(0, 0, 0) 0%, transparent)",CATEGORY_VOD_BG_SIZE:"100% 100%, 60% 40%, 60% 100%",VOD_DETAIL_BG_GRADIENT1:"linear-gradient(to right, rgba(0, 0, 0, 1) 50%, transparent)",VOD_DETAIL_BG_GRADIENT2:"linear-gradient(to top, rgba(0, 0, 0, 1) 0%, transparent)",VOD_DETAIL_BG_SIZE:"80% 100%, 100% 40%, 60% 100%",VOD_DETAIL_BG_IMG_URL:"images/spotlight_movie.jpg",CHANNEL_BG_SIZE:"100% 100%, 100% 100%, 100%",CHANNEL_CATEGORY_LIST:[{name:"Tất cả các kênh",CONFIG_SERVICES:"154,193,194,150,141,20,9,157,158,133,196,197,205,229,210,31,32,30,226,159,214,215,223,37,145,221,222"},{name:"Tin tức tổng hợp",CONFIG_SERVICES:"154,193,194,150,141,20,9,157,158,133,196,197"},{name:"Phim truyện",CONFIG_SERVICES:"205,229,210,31,32,30,226,159"},{name:"Thể thao",CONFIG_SERVICES:"214,215,223,37,145,221,222"},{name:"Giải trí tổng hợp",CONFIG_SERVICES:"155,225,206,227,228,231,232,213,48,277,47,156,54,71,25,59,56,57,46,58,152,209,28,29,14,50,211,212,216,219,220,160"},{name:"Thiếu nhi",CONFIG_SERVICES:"207,72,234"},{name:"Khoa giáo",CONFIG_SERVICES:"192,195,181,198"},{name:"Du lịch Khám phá",CONFIG_SERVICES:"237,60"},{name:"Kinh tế Tài chính",CONFIG_SERVICES:"177,208"},{name:"Địa phương",CONFIG_SERVICES:"136,128,84,78,126,92,131,111,123,124,121,118,125,137,77,107,116,115,86,127,132,112,76,97,10,103,93,94,138,100,96,102,140,110,85,119,83,88,129,98,114,99,117,90,122,104,108,109,81,82,105,139,87,120,95,80,101,106,130,135,79,91,134,89"}],SPOTLIGHT_VOD_LIST:[{img:"images/spotlight/spotlight_0.jpg",vodId:"58c9e3f7718cf34ecbcf9c95"},{img:"images/spotlight/spotlight_1.jpg",vodId:"58268148718c8a23a4b3645a"}],PREPARED_DATA:{COLORS:[{description:"Bộ phim là câu chuyện xoay quanh luật sư James Donovan. Xuất thân là luật sư bảo hiểm, có ít kinh nghiệm về các vụ án hình sự, nhưng CIA đã lựa chọn và giao cho ông một nhiệm vụ an ninh tầm cỡ quốc gia vô cùng quan trọng trong thời kỳ cao điểm của Chiến tranh lạnh giữa Mỹ và Liên Xô những năm 60.",id:"color_1",name:"Người Đàm Phán",photo_urls:[{size:"144x206",url:"http://otttv.viettel.com.vn/api1/contents/pictures/586da1d9718cde303c37a8d5"}],color:"rgba(0, 0, 255,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_2",name:"BROWN color",photo_urls:[{size:"144x206",url:"images/brown.png"}],color:"rgba(165, 42, 24,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_3",name:"CITRUS color",photo_urls:[{size:"144x206",url:"images/citrus.png"}],color:"rgba(161, 197, 10,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_4",name:"Deep Green color",photo_urls:[{size:"144x206",url:"images/deepGreen.png"}],color:"rgba(2, 89, 15,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_5",name:"Dusk color",photo_urls:[{size:"144x206",url:"images/dusk.png"}],color:"rgba(78, 84, 129,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_6",name:"Lime color",photo_urls:[{size:"144x206",url:"images/lime.png"}],color:"rgba(153, 255, 153,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_7",name:"Maroon color",photo_urls:[{size:"144x206",url:"images/maroon.png"}],color:"rgba(101, 0,1,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_8",name:"Merlot color",photo_urls:[{size:"144x206",url:"images/merlot.png"}],color:"rgba(102, 0, 51,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_9",name:"Mint color",photo_urls:[{size:"144x206",url:"images/mint.png"}],color:"rgba(159, 254, 176,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_10",name:"Mustard color",photo_urls:[{size:"144x206",url:"images/mustard.png"}],color:"rgba(255, 204, 102,1)"}],CHANNEL:[{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_0",name:"RED color",photo_urls:[{size:"144x206",url:"http://otttv.viettel.com.vn/api1/contents/pictures/586da1d9718cde303c37a8d5"}],color:"rgba(255, 0, 0,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_1",
name:"BLUE color",photo_urls:[{size:"144x206",url:"http://otttv.viettel.com.vn/api1/contents/pictures/586da1d9718cde303c37a8d5"}],color:"rgba(0, 0, 255,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_2",name:"BROWN color",photo_urls:[{size:"144x206",url:"images/brown.png"}],color:"rgba(165, 42, 24,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_3",name:"CITRUS color",photo_urls:[{size:"144x206",url:"images/citrus.png"}],color:"rgba(161, 197, 10,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_4",name:"Deep Green color",photo_urls:[{size:"144x206",url:"images/deepGreen.png"}],color:"rgba(2, 89, 15,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_5",name:"Dusk color",photo_urls:[{size:"144x206",url:"images/dusk.png"}],color:"rgba(78, 84, 129,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_6",name:"Lime color",photo_urls:[{size:"144x206",url:"images/lime.png"}],color:"rgba(153, 255, 153,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_7",name:"Maroon color",photo_urls:[{size:"144x206",url:"images/maroon.png"}],color:"rgba(101, 0,1,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_8",name:"Merlot color",photo_urls:[{size:"144x206",url:"images/merlot.png"}],color:"rgba(102, 0, 51,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_9",name:"Mint color",photo_urls:[{size:"144x206",url:"images/mint.png"}],color:"rgba(159, 254, 176,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_10",name:"Mustard color",photo_urls:[{size:"144x206",url:"images/mustard.png"}],color:"rgba(255, 204, 102,1)"}],ALPHABETS:[{description:"This is alphabet description.",id:"alphabet_0",name:"Alphabet A",photo_urls:[{size:"144x206",url:"images/alphabet_a.png"}],color:"rgba(200, 191,11,1)"},{description:"This is alphabet description.",id:"alphabet_1",name:"Alphabet B",photo_urls:[{size:"144x206",url:"images/alphabet_b.png"}],color:"rgba(200, 191,11,1)"},{description:"This is alphabet description.",id:"alphabet_2",name:"Alphabet C",photo_urls:[{size:"144x206",url:"images/alphabet_c.png"}],color:"rgba(200, 191,11,1)"},{description:"This is alphabet description.",id:"alphabet_3",name:"Alphabet D",photo_urls:[{size:"144x206",url:"images/alphabet_d.png"}],color:"rgba(78, 84, 129,1)"},{description:"This is alphabet description.",id:"alphabet_4",name:"Alphabet E",photo_urls:[{size:"144x206",url:"images/alphabet_e.png"}],color:"rgba(78, 84, 129,1)"},{description:"This is alphabet description.",id:"alphabet_5",name:"Alphabet F",photo_urls:[{size:"144x206",url:"images/alphabet_f.png"}],color:"rgba(78, 84, 129,1)"},{description:"This is alphabet description.",id:"alphabet_6",name:"Alphabet G",photo_urls:[{size:"144x206",url:"images/alphabet_g.png"}],color:"rgba(63, 72, 204,1)"},{description:"This is alphabet description.",id:"alphabet_7",name:"Alphabet H",photo_urls:[{size:"144x206",url:"images/alphabet_h.png"}],color:"rgba(63, 72, 204,1)"},{description:"This is alphabet description.",id:"alphabet_8",name:"Alphabet I",photo_urls:[{size:"144x206",url:"images/alphabet_i.png"}],color:"rgba(63, 72, 204,1)"},{description:"This is alphabet description.",id:"alphabet_9",name:"Alphabet J",photo_urls:[{size:"144x206",url:"images/alphabet_j.png"}],color:"rgba(2, 89, 15,1)"},{description:"This is alphabet description.",id:"alphabet_10",name:"Alphabet K",photo_urls:[{size:"144x206",url:"images/alphabet_k.png"}],color:"rgba(2, 89, 15,1)"},{description:"This is alphabet description.",id:"alphabet_11",name:"Alphabet L",photo_urls:[{size:"144x206",url:"images/alphabet_l.png"}],color:"rgba(2, 89, 15,1)"},{description:"This is alphabet description.",id:"alphabet_12",name:"Alphabet M",photo_urls:[{size:"144x206",url:"images/alphabet_m.png"}],color:"rgba(102, 0, 51,1)"},{description:"This is alphabet description.",id:"alphabet_13",name:"Alphabet N",photo_urls:[{size:"144x206",url:"images/alphabet_n.png"}],color:"rgba(102, 0, 51,1)"},{description:"This is alphabet description.",id:"alphabet_14",name:"Alphabet O",photo_urls:[{size:"144x206",url:"images/alphabet_o.png"}],color:"rgba(102, 0, 51,1)"},{description:"This is alphabet description.",id:"alphabet_15",name:"Alphabet P",photo_urls:[{size:"144x206",url:"images/alphabet_p.png"}],color:"rgba(101, 55, 0,1)"},{description:"This is alphabet description.",id:"alphabet_16",name:"Alphabet Q",photo_urls:[{size:"144x206",url:"images/alphabet_q.png"}],color:"rgba(101, 55, 0,1)"},{description:"This is alphabet description.",id:"alphabet_17",name:"Alphabet R",photo_urls:[{size:"144x206",url:"images/alphabet_r.png"}],color:"rgba(101, 55, 0,1)"},{description:"This is alphabet description.",id:"alphabet_18",name:"Alphabet S",photo_urls:[{size:"144x206",url:"images/alphabet_s.png"}],color:"rgba(136, 0, 21,1)"},{description:"This is alphabet description.",id:"alphabet_19",name:"Alphabet T",photo_urls:[{size:"144x206",url:"images/alphabet_t.png"}],color:"rgba(136, 0, 21,1)"},{description:"This is alphabet description.",id:"alphabet_20",name:"Alphabet U",photo_urls:[{size:"144x206",url:"images/alphabet_u.png"}],color:"rgba(136, 0, 21,1)"}],NUMBERS:[{description:"NUMBER Description",id:"number_1",name:"Number 1",photo_urls:[{size:"268x268",url:"images/1.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_2",name:"Number 2",photo_urls:[{size:"268x268",url:"images/2.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_3",name:"Number 3",photo_urls:[{size:"268x268",url:"images/3.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_4",name:"Number 4",photo_urls:[{size:"268x268",url:"images/4.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_5",name:"Number 5",photo_urls:[{size:"268x268",url:"images/5.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_6",name:"Number 6",photo_urls:[{size:"268x268",url:"images/6.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_7",name:"Number 7",photo_urls:[{size:"268x268",url:"images/7.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_8",name:"Number 8",photo_urls:[{size:"268x268",url:"images/8.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_9",name:"Number 9",photo_urls:[{size:"268x268",url:"images/9.png"}],color:"rgba(0, 162,12,1)"},{description:"NUMBER Description",id:"number_10",name:"Number 10",photo_urls:[{size:"268x268",url:"images/10.png"}],color:"rgba(0, 162,12,1)"}],CATEGORY_MENUS:[{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_0",name:"Tìm kiếm",photo_urls:[{size:"144x206",url:"images/deepGreen.png"}],color:"rgba(255, 0, 0,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_1",name:"Phim",photo_urls:[{size:"144x206",url:"images/deepGreen.png"}],color:"rgba(0, 0, 255,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_2",name:"Thiếu nhi",photo_urls:[{size:"144x206",url:"images/brown.png"}],color:"rgba(165, 42, 24,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_3",name:"Nhạc",photo_urls:[{size:"144x206",url:"images/deepGreen.png"}],color:"rgba(161, 197, 10,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_4",name:"Hài - Dân gian",photo_urls:[{size:"144x206",url:"images/deepGreen.png"}],color:"rgba(2, 89, 15,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_5",name:"Dusk color",photo_urls:[{size:"144x206",url:"images/dusk.png"}],color:"rgba(78, 84, 129,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_6",name:"Lime color",photo_urls:[{size:"144x206",url:"images/lime.png"}],color:"rgba(153, 255, 153,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_7",name:"Maroon color",photo_urls:[{size:"144x206",url:"images/maroon.png"}],color:"rgba(101, 0,1,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_8",name:"Merlot color",photo_urls:[{size:"144x206",url:"images/merlot.png"}],color:"rgba(102, 0, 51,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_9",name:"Mint color",photo_urls:[{size:"144x206",url:"images/mint.png"}],color:"rgba(159, 254, 176,1)"},{description:"Put the description of color here. Put the description of blue color here. Put the description of color here. Put the description of color here. Put the description of blue color here. Put the description of color here.",id:"color_10",name:"Mustard color",photo_urls:[{size:"144x206",url:"images/mustard.png"}],color:"rgba(255, 204, 102,1)"}]}}}),function(){function DataService($rootScope,$http,$q,CONSTANT,SETTINGS,UltilService){function getCategorySeriesVodListByCategoryId(categoryId,limit,offset,shortBy){var url="";url="undefined"!=typeof limit&&limit>0?"undefined"!=typeof limit&&0!==offset?"popular"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?popular=true&offset="+offset+"&limit="+limit:"recent"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?offset="+offset+"&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?offset="+offset+"&limit="+limit:"popular"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?popular=true&limit="+limit:"recent"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?offset=0&limit=16";var seriesVodList=[],def=$q.defer();return $http.get(url).then(function(response){response.data.data?(seriesVodList=UltilService.transformSeriesVODList(response.data.data),def.resolve(seriesVodList)):def.resolve(seriesVodList)},function(response){def.resolve(seriesVodList)}),def.promise}function getEpisodesInSeries(seriesId,seriesSort,offset){var url="";url=offset?seriesSort?CONSTANT.API_HOST+"/api1/contents/programs/series?include=product&include=multilang&include=purchase&include=fpackage&id="+seriesId+"&format=long&offset="+offset+"&until=now&&series="+seriesSort:CONSTANT.API_HOST+"/api1/contents/programs/series?include=product&include=multilang&include=purchase&include=fpackage&id="+seriesId+"&format=long&offset="+offset+"&until=now&&series=asc":seriesSort?CONSTANT.API_HOST+"/api1/contents/programs/series?include=product&include=multilang&include=purchase&include=fpackage&id="+seriesId+"&format=long&offset=0&until=now&series="+seriesSort:CONSTANT.API_HOST+"/api1/contents/programs/series?include=product&include=multilang&include=purchase&include=fpackage&id="+seriesId+"&format=long&offset=0&until=now&series=asc";var def=$q.defer(),episodeVodList=[];return $http.get(url).then(function(response){response.data.data?(episodeVodList=UltilService.transformVODList(response.data.data),def.resolve(episodeVodList)):def.resolve(episodeVodList)},function(){def.resolve(episodeVodList)}),def.promise}function getVodDetails(vodId){var url=CONSTANT.API_HOST+"/api1/contents/programs/"+vodId+"?include=product&include=multilang&include=purchase&include=fpackage&format=long",def=$q.defer();return $http.get(url).then(function(response){def.resolve(UltilService.transformVOD(response.data))},function(){def.reject("Failed to get getVodDetails")}),def.promise}function getVodURL(programId,productId,isFreeNoPair){var url;$rootScope.token.access_token;url=isFreeNoPair?CONSTANT.API_HOST+"/api1/watches/fvod/prepare?access_token="+SETTINGS.guest_access_token+"&id="+programId+"&product_id="+productId:CONSTANT.API_HOST+"/api1/watches/vod/prepare?id="+programId+"&product_id="+productId;var def=$q.defer();return $http.get(url).then(function(response){def.resolve(response)},function(){def.reject("Failed to get getVodURL")}),def.promise}function getEpisodeListBySeriesId(categoryId,limit,offset){var url="";url=limit?offset?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?format=long&offset="+offset+"&until=now&include=product&include=purchase&include=fpackage&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?format=long&offset=0&until=now&include=product&include=purchase&include=fpackage&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?format=long&offset=0&until=now&include=product&include=purchase&include=fpackage&limit=-1";var def=$q.defer();return $http.get(url).then(function(response){var episodeVodList=UltilService.transformVODList(response.data.data);def.resolve(episodeVodList)},function(){def.reject("Failed to get getEpisodeListInSeries")}),def.promise}function getEpisodeListInSeries(seriesId,offset){var url="",seriesSort="desc";url=offset?CONSTANT.API_HOST+"/api1/contents/programs/series?id="+seriesId+"&include=purchase&include=fpackage&format=long&offset="+offset+"&until=now&series="+seriesSort:CONSTANT.API_HOST+"/api1/contents/programs/series?id="+seriesId+"&include=purchase&include=fpackage&format=long&offset=0&until=now&series="+seriesSort;var def=$q.defer();return $http.get(url).then(function(response){var episodeVodList=response.data.data;def.resolve(episodeVodList)},function(){def.reject("Failed to get getEpisodeListInSeries")}),def.promise}function getRelatedVodList(vodId){var url=CONSTANT.RECOMMENDATION_API_HOST+"/so-web-app/so/recommend?frmt=json&dp=VT_PHONE_016_VODINFO_AR_VOD&pc=1&cust=&program_id="+vodId+"&hot_max=12",def=$q.defer(),relatedVodList=[];return $http.get(url).then(function(response){if("NoScenarioResult"!==response.data.dp.status){var programIds="";angular.forEach(response.data.dp.itemList.items,function(vodItem,key){programIds=programIds+vodItem.basisInfo.basisList[0].value+","}),getVodByProgramIdList(programIds).then(function(response){relatedVodList=response,def.resolve(relatedVodList)},function(response){def.resolve(relatedVodList)})}else def.resolve(relatedVodList)},function(response){def.resolve(relatedVodList)}),def.promise}function getVodByProgramIdList(programIds){var url=CONSTANT.API_HOST+"/api1/contents/programs?id="+programIds+"&format=long&include=product&include=purchase&include=fpackage",def=$q.defer();return $http.get(url).then(function(response){var vodList=UltilService.transformVODList(response.data.data);def.resolve(vodList)},function(){def.reject("Failed to get getVodByProgramIdList")}),def.promise}function getVodMoreInfoByProgramIdList(programIds){var url=CONSTANT.API_HOST+"/api1/contents/programs?id="+programIds+"&format=long&include=product&include=purchase&include=fpackage",def=$q.defer();return $http.get(url).then(function(response){var vodList=new Array(response.data.data.length),index1=0,index2=0;angular.forEach(response.data.data,function(vod,key){if(vodList[key]=UltilService.transformVOD(vod),vodList[key].episodes=[],vod.program&&vod.program.series){vod.program.series.episodeName=vod.program.series.episode.replace(/^0+/,"");var seriesId=vod.program.series.id;getEpisodesInSeries(seriesId).then(function(episodeVodList){return index2++,vodList[key].episodes=episodeVodList,index1===vodList.length&&index2===vodList.length?def.resolve(vodList):void 0})}else index2++;getRelatedVodList(vod.program.id).then(function(res){return index1++,vodList[key].relateds=res,index1===vodList.length&&index2===vodList.length?def.resolve(vodList):void 0})}),def.resolve(vodList)},function(){def.reject("Failed to get getVodByProgramIdList")}),def.promise}function getSeriesVodList(categoryId,offset,limit,shortBy){var url="";url=limit?offset?"popular"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?popular=true&offset="+offset+"&limit="+limit:"recent"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?offset="+offset+"&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?offset="+offset+"&limit="+limit:"popular"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?popular=true&limit="+limit:"recent"===shortBy?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/categories?offset=0&limit=10";var def=$q.defer();return $http.get(url).then(function(response){var vodList=new Array(response.data.data.length),index=0;angular.forEach(response.data.data,function(seriesVOD,key){vodList[key]=seriesVOD,getEpisodeListBySeriesId(seriesVOD.id).then(function(episodeVodList){vodList[key]=episodeVodList[0],vodList[key].episodes=episodeVodList,vodList[key]=UltilService.transformVOD(vodList[key]),getRelatedVodList(vodList[key].program.id).then(function(res){index++,vodList[key].relateds=res,index===vodList.length&&def.resolve(vodList)})},function(response){})})},function(){def.reject("Failed to get albums")}),def.promise}function getChannelList(){var url=CONSTANT.API_HOST+"/api1/contents/channels?region=OTT&child=all&offset=0&limit=500",def=$q.defer();return $http.get(url).then(function(response){service.channelList=response.data.data.map(function(item,index){var photoUrl=CONSTANT.API_HOST+"/api1/contents/pictures/"+item.channel.id+"?type=original";return item.photoUrl=photoUrl,item.name=item.channel.name[0].text,item.firstTitle=item.channel.name[0].text,item.serviceId=item.service_id,item.channelId=item.id,item}),def.resolve(service.channelList)},function(error,status){def.reject("Failed to get Channel list")}),def.promise}function getPrepareChannel(param){var url="http://otttv.viettel.com.vn/api1/watches/handheld/live/prepare";$http.defaults.headers.post["Content-Type"]="application/json";var def=$q.defer();return $http.post(url,param).then(function(data,status,headers,config){def.resolve(data)},function(error,status){def.reject("Failed to get getPrepareChannel")}),def.promise}function getVodListByCategoryId(categoryId,offset,limit){var url=CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset=0&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit=16";url=(offset||0===offset)&&limit?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset="+offset+"&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset=0&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit=16";var def=$q.defer();return $http.get(url).then(function(response){var vodList=new Array(response.data.data.length),index1=0,index2=0;angular.forEach(response.data.data,function(vod,key){if(vodList[key]=UltilService.transformVOD(vod),vodList[key].episodes=[],vod.program&&vod.program.series){vod.program.series.episodeName=vod.program.series.episode.replace(/^0+/,"");var seriesId=vod.program.series.id;getEpisodesInSeries(seriesId).then(function(episodeVodList){return index2++,vodList[key].episodes=episodeVodList,index1===vodList.length&&index2===vodList.length?def.resolve(vodList):void 0})}else index2++;getRelatedVodList(vod.program.id).then(function(res){return index1++,vodList[key].relateds=res,index1===vodList.length&&index2===vodList.length?def.resolve(vodList):void 0})})},function(error,status){def.reject("Failed to get getVodListByCategoryId")}),def.promise}function getCategoryVodListByCategoryId(categoryId,limit,offset){var url=CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset=0&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit=16";url="undefined"!=typeof limit&&limit>0?"undefined"!=typeof offset?CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset="+offset+"&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset=0&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit="+limit:CONSTANT.API_HOST+"/api1/contents/categories/"+categoryId+"/programs?child=all&format=long&offset=0&include=product&include=purchase&include=fpackage&include=purchase&include=fpackage&until=now&limit=16";var def=$q.defer();return $http.get(url).then(function(response){var vodList=UltilService.transformVODList(response.data.data);return def.resolve(vodList)},function(error,status){def.reject("Failed to get getVodListByCategoryId")}),def.promise}function getMenuCategories(){var url=CONSTANT.API_HOST+"/api1/contents/menus?version=Web_Live&child=all",def=$q.defer(),menuArray=[];return $http.get(url).then(function(response){var menuListLevel2=[],menuListLevel3=[],menuMap={};angular.forEach(response.data.data,function(item,key){var isItemHidden=!1;if(angular.forEach(item.config,function(config,key){"hidden"===config.name&&"true"===config.value&&(isItemHidden=!0)}),"__root"!==item.type&&isItemHidden===!1){if(1===(item.path_id.match(/\//g)||[]).length){var menuitem={"this":item,children:[]};menuArray.push(menuitem),menuMap[item.id]=menuitem}2===(item.path_id.match(/\//g)||[]).length&&angular.forEach(menuArray,function(menu1,key){if(-1!==item.path_id.indexOf(menu1["this"].path_id+"/")){var menuitem={"this":item,children:[]};menu1.children.push(menuitem),menuListLevel2.push(menuitem),menuMap[item.id]=menuitem}}),3===(item.path_id.match(/\//g)||[]).length&&angular.forEach(menuListLevel2,function(menu2,key){if(-1!==item.path_id.indexOf(menu2["this"].path_id+"/")){var menuitem={"this":item,children:[]};menu2.children.push(menuitem),menuListLevel3.push(menuitem),menuMap[item.id]=menuitem}}),4===(item.path_id.match(/\//g)||[]).length&&angular.forEach(menuListLevel3,function(menu3,key){if(-1!==item.path_id.indexOf(menu3["this"].path_id+"/")){var menuitem={"this":item,children:[]};menu3.children.push(menuitem),menuMap[item.id]=menuitem}})}}),def.resolve(menuArray)},function(error,status){def.reject("Failed to get getMenuCategories")}),def.promise}var service={vodList:[],channelList:[],seriesVodList:[],getChannelList:getChannelList,getPrepareChannel:getPrepareChannel,getMenuCategories:getMenuCategories,getVodListByCategoryId:getVodListByCategoryId,getCategoryVodListByCategoryId:getCategoryVodListByCategoryId,getSeriesVodList:getSeriesVodList,getRelatedVodList:getRelatedVodList,getEpisodeListInSeries:getEpisodeListInSeries,getEpisodeListBySeriesId:getEpisodeListBySeriesId,getVodURL:getVodURL,getVodDetails:getVodDetails,getEpisodesInSeries:getEpisodesInSeries,getCategorySeriesVodListByCategoryId:getCategorySeriesVodListByCategoryId,getVodByProgramIdList:getVodByProgramIdList,getVodMoreInfoByProgramIdList:getVodMoreInfoByProgramIdList};return service}app.factory("DataService",DataService),DataService.inject=["$rootScope","$http","$q","CONSTANT","SETTINGS","UltilService"],DataService.$inject=["$rootScope","$http","$q","CONSTANT","SETTINGS","UltilService"]}(),function(){function UltilService($http,$q,CONSTANT,SETTINGS){function isSeriesCategory(menu){var isLeaf=!0;return menu["this"].config&&menu["this"].config.length>0?(angular.forEach(menu["this"].config,function(config,key2){"__leaf_category"===config.name&&"false"===config.value&&(isLeaf=!1,angular["break"])}),"general"!==menu["this"].type&&isLeaf?!1:!0):!1}function getVodCategoryId(menu){var flag="";return menu["this"].config?(angular.forEach(menu["this"].config,function(config,key2){"__category"===config.name&&(flag=config.value,angular["break"])}),flag):""}function checkFreeProduct(product){var temp=!1;return angular.forEach(product.locations,function(location,key){angular.forEach(location.parameter,function(parameter,key){"Audience"===parameter.name&&"private:All"===parameter.value&&(temp=!0)}),temp||angular.forEach(product.price,function(price,key){"VND"===price.currency&&0===price.value&&(temp=!0)})}),temp}function getLiteProduct(product){var temp={};temp.id=product.id,temp.type=product.type,temp.name=product.name,temp.description=product.description;var priceObj={},priceObjs=[];return product.rental_periods.length>0?angular.forEach(product.rental_periods,function(rental_period,key){angular.forEach(rental_period.price,function(price,key){priceObj={},"VND"===price.currency&&(priceObj.price=Math.ceil(price.value-product.discount_rate*price.value),priceObj.period=rental_period.period,priceObj.unit=rental_period.unit,priceObjs.push(priceObj))})}):angular.forEach(product.price,function(price,key){priceObj={},"VND"===price.currency&&(priceObj.price=Math.ceil(price.value-product.discount_rate*price.value),priceObjs.push(priceObj))}),temp.price=priceObjs,temp}function transformVOD(vod){var svod=vod;svod.isVisiable=!1,svod.isPublish=!1,svod.isVtvCab=!1,svod.isWifiPackage=!1,svod.isSingleVOD=!1,svod.isPurchasedPackage=!1,svod.isExclusivePackage=!1,svod.isPurchasedExclusive=!1,svod.isEncrypted=!1,svod.purchased_products=[],svod.purchasable_products=[],svod.photoUrl=CONSTANT.API_HOST+"/api1/contents/pictures/"+vod.program.id+"?width=215.000000&height=307.000000",svod.bigPhotoUrl=CONSTANT.API_HOST+"/api1/contents/pictures/"+vod.program.id,svod.name=vod.program.title[0].text;var des=vod.program.synopsis[0].text,tm="Thuyết minh - ";0===des.indexOf(tm)&&(des=des.substring(tm.length-1,des.length-1)),svod.description=des.substring(0,398),svod.shortDescription=des.substring(0,300),vod.program.series?svod.isVodInSeries=!0:svod.isVodInSeries=!1,svod.name=svod.name.replace("–","-");var nameSplit=[];nameSplit=svod.name.indexOf(" - ")>0?svod.name.split(" - "):svod.name.indexOf(" – ")>0?svod.name.split(" – "):svod.name.indexOf("–")>0?svod.name.split("–"):svod.name.indexOf("-")>0?svod.name.split("-"):[svod.name],nameSplit.length>1?nameSplit[0].toUpperCase().indexOf("TẬP")>=0?4===nameSplit.length?(svod.firstTitle=nameSplit[2].trim()+" - "+nameSplit[3].trim(),svod.secondTitle=nameSplit[0].trim()+" : "+nameSplit[1].trim()):3===nameSplit.length?(svod.firstTitle=nameSplit[2].trim(),svod.secondTitle=nameSplit[0].trim()+" : "+nameSplit[1].trim()):2===nameSplit.length?(svod.firstTitle=nameSplit[1].trim(),svod.secondTitle=nameSplit[0].trim()):(svod.firstTitle=nameSplit[1],svod.secondTitle=""):nameSplit[0].toUpperCase().indexOf("PHẦN")>=0&&3===nameSplit.length?(svod.firstTitle=nameSplit[2].trim(),svod.secondTitle=nameSplit[0].trim()+" : "+nameSplit[1].trim()):2===nameSplit.length?(svod.firstTitle=nameSplit[1].trim(),svod.secondTitle=nameSplit[0].trim()):(svod.firstTitle="",svod.secondTitle=""):(svod.firstTitle=nameSplit[0].trim(),svod.secondTitle=""),"undefined"!=typeof vod.program.directors_text&&vod.program.directors_text.length>0&&""!==vod.program.directors_text[0].text?svod.directors=vod.program.directors_text[0].text:svod.directors="","undefined"!=typeof vod.program.actors_text&&vod.program.actors_text.length>0&&""!==vod.program.actors_text[0].text?svod.actors=vod.program.actors_text[0].text:svod.actors="",svod.genres="","undefined"!=typeof vod.program.genres&&null!==vod.program.genres?vod.program.genres.length>1?angular.forEach(vod.program.genres,function(genres,key){key===vod.program.genres.length-1?svod.genres=svod.genres+genres:svod.genres=svod.genres+genres+","}):svod.genres=vod.program.genres[0]:svod.genres="","undefined"!=typeof vod.program.production_country&&""!==vod.program.production_country?svod.country=vod.program.production_country.substring(0,vod.program.production_country.length-1):svod.country="","undefined"!=typeof vod.program&&(svod.program_id=vod.program.id),"undefined"!=typeof vod.visible&&vod.visible&&(svod.isVisiable=!0),"undefined"!=typeof vod.config&&angular.forEach(vod.config,function(item,key){"Public"===item.name&&"1"===item.value&&(svod.isPublish=!0)}),"undefined"!=typeof vod.channel&&"undefined"!=typeof vod.channel.genres&&angular.forEach(vod.channel.genres,function(item,key){"1:11:0:0"===item&&(svod.isVtvCab=!0)}),angular.forEach(vod.product,function(product,key){svod.isFreeNoPair=checkFreeProduct(product),"undefined"!=typeof product.purchase&&"false"===product.purchasable&&(svod.isWifiPackage=!0),"single"!==product.type&&"true"===product.purchasable&&0===product.cclass.indexOf("HANDHELD")&&("undefined"!=typeof product.exclusive&&"true"===product.exclusive&&"true"===product.purchasable&&(svod.isExclusivePackage=!0,"undefined"!=typeof product.purchase&&(svod.isPurchasedExclusive=!0)),
"undefined"!=typeof product.purchase?(svod.isPurchasedPackage=!0,svod.purchased_products.push(getLiteProduct(product))):svod.purchasable_products.push(getLiteProduct(product))),"single"===product.type&&product.cclass.indexOf("HANDHELD")>=0&&(svod.isSingleVOD=!0,svod.singleProductId=product.id,1===product.cclass.length?"undefined"!=typeof product.location&&("handheld"===product.location.device&&(svod.vodLocator=product.location.locator),"handheld"===product.location.device&&"true"===product.location.encryption&&(svod.isEncrypted=!0)):angular.forEach(product.locations,function(location,key){"handheld"===location.device&&(svod.vodLocator=location.locator),"handheld"===location.device&&"true"===location.encryption&&(svod.isEncrypted=!0)})),vod.contentFormat&&"HD"===vod.contentFormat.toUpperCase()?svod.contentFormat="HD":svod.contentFormat="SD"});var take=vod.program.display_runtime.split(":"),minutes=0;return take.length>1?minutes=60*parseFloat(take[0])+parseFloat(take[1]):1===take.length&&(minutes=parseFloat(take[0])),svod.duration=minutes,svod}function transformSeriesVOD(seriesVod){var svod=seriesVod;return svod.isSeries=!0,svod.photoUrl=CONSTANT.API_HOST+"/api1/contents/categories/"+seriesVod.id+"/picture?width=215.000000&height=307.000000",svod.name=seriesVod.name[0].text,svod.firstTitle=seriesVod.name,svod.secondTitle="",svod.description=svod.description[0].text,svod.isSeriesEnd=!1,angular.forEach(seriesVod.config,function(config,key){"seriesend"===config.name&&"true"===config.value&&(svod.isSeriesEnd=!0)}),svod}function transformSeriesVODList(seriesVodList){var arrayTemp=[];return angular.forEach(seriesVodList,function(vod,key){var svod=transformSeriesVOD(vod);arrayTemp.push(svod)}),arrayTemp}function transformVODList(vodList){var arrayTemp=[];return angular.forEach(vodList,function(vod,key){var svod=transformVOD(vod);arrayTemp.push(svod)}),arrayTemp}var service={vodList:[],channelList:[],getVodCategoryId:getVodCategoryId,checkFreeProduct:checkFreeProduct,getLiteProduct:getLiteProduct,transformVOD:transformVOD,transformVODList:transformVODList,isSeriesCategory:isSeriesCategory,transformSeriesVOD:transformSeriesVOD,transformSeriesVODList:transformSeriesVODList};return service}app.factory("UltilService",UltilService),UltilService.inject=["$http","$q","CONSTANT","SETTINGS"],UltilService.$inject=["$http","$q","CONSTANT","SETTINGS"]}(),function(){function VideoService($timeout,$http,$q,CONSTANT,SETTINGS,DataService){function playStream(stream,video,def){defferStream=def,hls&&(hls.destroy(),hls.bufferTimer&&(clearInterval(hls.bufferTimer),hls.bufferTimer=void 0),hls=null),recoverDecodingErrorDate=recoverSwapAudioCodecDate=null,hls=new Hls({}),hls.loadSource(stream),hls.attachMedia(video),hls.on(Hls.Events.MANIFEST_PARSED,function(){}),hls.on(Hls.Events.LEVEL_LOADED,function(event,data){}),hls.on(Hls.Events.ERROR,function(event,data){switch(data.details){case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:try{0===data.response.code}catch(err){}break;case Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT:break;case Hls.ErrorDetails.MANIFEST_PARSING_ERROR:break;case Hls.ErrorDetails.LEVEL_LOAD_ERROR:break;case Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT:break;case Hls.ErrorDetails.LEVEL_SWITCH_ERROR:break;case Hls.ErrorDetails.FRAG_LOAD_ERROR:break;case Hls.ErrorDetails.FRAG_LOAD_TIMEOUT:break;case Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR:break;case Hls.ErrorDetails.FRAG_DECRYPT_ERROR:break;case Hls.ErrorDetails.FRAG_PARSING_ERROR:break;case Hls.ErrorDetails.KEY_LOAD_ERROR:errorData.name="ENCRYPTED_CONTENT_ERROR",errorData.description="error while loading key "+data.frag.decryptdata.uri,def.reject(errorData);break;case Hls.ErrorDetails.KEY_LOAD_TIMEOUT:errorData.name="ENCRYPTED_CONTENT_ERROR",errorData.description="error while loading key "+data.frag.decryptdata.uri,def.reject(errorData);break;case Hls.ErrorDetails.BUFFER_APPEND_ERROR:break;case Hls.ErrorDetails.BUFFER_ADD_CODEC_ERROR:break;case Hls.ErrorDetails.BUFFER_APPENDING_ERROR:}if(data.fatal)switch(data.type){case Hls.ErrorTypes.MEDIA_ERROR:handleMediaError();break;case Hls.ErrorTypes.NETWORK_ERROR:hls.destroy(),$timeout(function(params){playStream(param,video)},100);break;default:hls.destroy()}}),video.addEventListener("resize",handleVideoEvent),video.addEventListener("seeking",handleVideoEvent),video.addEventListener("seeked",handleVideoEvent),video.addEventListener("pause",handleVideoEvent),video.addEventListener("play",handleVideoEvent),video.addEventListener("canplay",handleVideoEvent),video.addEventListener("canplaythrough",handleVideoEvent),video.addEventListener("ended",handleVideoEvent),video.addEventListener("playing",handleVideoEvent),video.addEventListener("error",handleVideoEvent),video.addEventListener("loadedmetadata",handleVideoEvent),video.addEventListener("loadeddata",handleVideoEvent),video.addEventListener("durationchange",handleVideoEvent)}function playChannelStream(channel,video){var param={version:1,regionId:"GUEST",assetId:channel.serviceId,filename:channel.serviceId+".m3u8",clientIP:"220.231.127.1",manifestType:"HLS",userId:""},def=$q.defer();return DataService.getPrepareChannel(param).then(function(response){if("undefined"!=typeof response.data.glbAddress&&response.data.glbAddress.length>0){if(response.data.glbAddress.length>0){for(var i=0;i<response.data.glbAddress.length;i++)var stream="http://"+response.data.glbAddress[i]+"/"+param.assetId+".m3u8?AdaptiveType=HLS&VOD_RequestID="+response.data.requestId;playStream(stream,video,def)}}},function(data,status){}),def.promise}function playVODStream(vod,video){var def=$q.defer(),playable=!1;return vod.isExclusivePackage?vod.isPurchasedExclusive&&(playable=!0):(vod.isFreeNoPair||vod.isWifiPackage||vod.isPurchasedPackage)&&(playable=!0),playable&&DataService.getVodURL(vod.program.id,vod.singleProductId,vod.isFreeNoPair).then(function(response){var vodRequestId=response.data.gsdm.vod_request_id,stream="";if(response.data.gsdm.glb_addresses.length>0)for(var i=0;i<response.data.gsdm.glb_addresses.length;i++)stream="http://"+response.data.gsdm.glb_addresses[i]+"/"+vod.vodLocator+"?AdaptiveType=HLS&VOD_RequestID="+vodRequestId;playStream(stream,video,def)},function(response){}),def.promise}function stopStream(){hls&&(hls.destroy(),hls.bufferTimer&&(clearInterval(hls.bufferTimer),hls.bufferTimer=void 0),hls=null)}function handleVideoEvent(evt){var data="";switch(evt.type){case"durationchange":break;case"resize":break;case"loadedmetadata":defferStream.resolve("PLAYING");break;case"loadeddata":case"canplay":case"canplaythrough":case"ended":case"seeking":case"play":case"playing":break;case"pause":case"waiting":case"stalled":case"error":if(data=Math.round(1e3*evt.target.currentTime),"error"===evt.type){var errorTxt,mediaError=evt.currentTarget.error;switch(mediaError.code){case mediaError.MEDIA_ERR_ABORTED:errorTxt="You aborted the video playback";break;case mediaError.MEDIA_ERR_DECODE:errorTxt="The video playback was aborted due to a corruption problem or because the video used features your browser did not support",handleMediaError();break;case mediaError.MEDIA_ERR_NETWORK:errorTxt="A network error caused the video download to fail part-way";break;case mediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:errorTxt="The video could not be loaded, either because the server or network failed or because the format is not supported",errorData.name="ENCRYPTED_CONTENT_ERROR",errorData.description=errorTxt,defferStream.reject(errorData)}}}}function handleMediaError(){var now=performance.now();!recoverDecodingErrorDate||now-recoverDecodingErrorDate>3e3?(recoverDecodingErrorDate=performance.now(),hls.recoverMediaError()):(!recoverSwapAudioCodecDate||now-recoverSwapAudioCodecDate>3e3)&&(recoverSwapAudioCodecDate=performance.now(),hls.swapAudioCodec(),hls.recoverMediaError())}var hls,errorData={name:"",code:"",description:""},service={vodList:[],channelList:[],playStream:playStream,playChannelStream:playChannelStream,playVODStream:playVODStream,stopStream:stopStream};return service;var defferStream,recoverDecodingErrorDate,recoverSwapAudioCodecDate}app.factory("VideoService",VideoService),VideoService.inject=["$timeout","$http","$q","CONSTANT","SETTINGS","DataService"],VideoService.$inject=["$timeout","$http","$q","CONSTANT","SETTINGS","DataService"]}(),function(){function Account(){function getAccount(){return""}var service={getAccount:getAccount};return service}angular.module("vietteltv").factory("Account",Account)}(),function(){function AuthServerProvider($http,localStorageService,$q,SETTINGS,CONSTANT){function renewToken(){var token=localStorageService.get("token"),param={refresh_token:token.refresh_token,client_id:SETTINGS.client_id,hash:CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA1(token.refresh_token+SETTINGS.client_id,SETTINGS.app_secret))},requestUrl=CONSTANT.API_HOST+"/ott/accounts/delegation";$http.defaults.headers.post["Content-Type"]="application/json";var def=$q.defer();return $http.post(requestUrl,param).then(function(response){if("undefined"!=typeof response.access_token&&"undefined"!=typeof response.expiration_date&&"undefined"!=typeof response.refresh_token&&"undefined"!=typeof response.refresh_token_expiration_date){var token={access_token:response.access_token,token_secret:response.token_secret,login_access_token:response.access_token,refresh_token:response.refresh_token,expiration_date:response.expiration_date,refresh_token_expiration_date:response.refresh_token_expiration_date,temp_password:response.temp_password};localStorageService.set("token",token)}else logout();def.resolve(response)},function(){def.reject("Failed to get renewToken")}),def.promise}function getToken(){return localStorageService.get("accessToken")}function hasValidToken(){var token=this.getToken();return token&&token.expires&&token.expires>(new Date).getTime()}function login(credentials){function authenticateSuccess(response){if(response.data.error){var def=$q.defer();def.reject("Loi Dang nhap")}else{var token={access_token:response.data.access_token,token_secret:response.data.token_secret,login_access_token:response.data.access_token,refresh_token:response.data.refresh_token,expiration_date:response.data.expiration_date,refresh_token_expiration_date:response.data.refresh_token_expiration_date,temp_password:response.data.temp_password};localStorageService.set("token",token)}return response}var requestObj={};requestObj.client_id=SETTINGS.client_id,requestObj.id=credentials.username,requestObj.password=CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA1(requestObj.id+credentials.password,credentials.password));var deviceObject={};if(localStorageService.get("deviceUdid")){deviceObject.id=localStorageService.get("deviceUdid"),deviceObject.model="PC_WINDOWS",deviceObject.model_no="PC_WINDOWS",deviceObject.type="others",requestObj.device=deviceObject;var url=CONSTANT.API_HOST+"/ott/accounts/login";return $http.post(url,requestObj,{headers:{Accept:"application/json"}}).then(authenticateSuccess,function(error){return error})}(new Fingerprint2).get(function(result,components){localStorageService.set("deviceUdid",result),deviceObject.id=localStorageService.get("deviceUdid"),deviceObject.model="PC_WINDOWS",deviceObject.model_no="PC_WINDOWS",deviceObject.type="others",requestObj.device=deviceObject;var url=CONSTANT.API_HOST+"/ott/accounts/login";return $http.post(url,requestObj,{headers:{Accept:"application/json"}}).then(authenticateSuccess,function(error){return error})})}function logout(){localStorageService.clearAll()}var service={getToken:getToken,hasValidToken:hasValidToken,login:login,logout:logout,renewToken:renewToken};return service}app.factory("AuthServerProvider",AuthServerProvider),AuthServerProvider.$inject=["$http","localStorageService","$q","SETTINGS","CONSTANT"]}(),function(){function Auth($rootScope,localStorageService,$q,Principal,AuthServerProvider,Account,LoginService){function authorize(force,callback){function authThen(){Principal.isAuthenticated();return cb()}var cb=callback||angular.noop,authReturn=Principal.identity(force).then(authThen);return authReturn}function login(credentials,callback){function loginThen(data){return Principal.identity(!0).then(function(account){deferred.resolve(data)}),cb()}var cb=callback||angular.noop,deferred=$q.defer();return AuthServerProvider.login(credentials).then(loginThen)["catch"](function(err){return this.logout(),deferred.reject(err),cb(err)}.bind(this)),deferred.promise}function renewToken(credentials,callback){function renewTokenThen(data){return deferred.resolve(data),cb()}var cb=callback||angular.noop,deferred=$q.defer();return AuthServerProvider.renewToken().then(renewTokenThen)["catch"](function(err){return this.logout(),deferred.reject(err),cb(err)}.bind(this)),deferred.promise}function logout(){AuthServerProvider.logout(),Principal.authenticate(null)}var service={authorize:authorize,login:login,logout:logout,renewToken:renewToken};return service}app.factory("Auth",Auth),Auth.$inject=["$rootScope","localStorageService","$q","Principal","AuthServerProvider","Account","LoginService"]}(),function(){function LoginService(focusController,$timeout){function openLoginPage(callback){var cb=callback||angular.noop;return $("#login-page").addClass("login-page-show"),$timeout(function(){$("#username").click()},1e3),cb()}function closeLoginPage(callback){var cb=callback||angular.noop;return $("#login-page").removeClass("login-page-show"),$(".login-row").removeClass("focused"),cb()}var service={openLoginPage:openLoginPage,closeLoginPage:closeLoginPage};return service}angular.module("vietteltv").factory("LoginService",LoginService),LoginService.$inject=["focusController","$timeout"]}(),function(){function Principal($q,Account,localStorageService){function authenticate(identity){_identity=identity,_authenticated=null!==identity}function hasAnyAuthority(authorities){if(!_authenticated||!_identity||!_identity.authorities)return!1;for(var i=0;i<authorities.length;i++)if(-1!==_identity.authorities.indexOf(authorities[i]))return!0;return!1}function hasAuthority(authority){return _authenticated?this.identity().then(function(_id){return _id.authorities&&-1!==_id.authorities.indexOf(authority)},function(){return!1}):$q.when(!1)}function identity(force){var deferred=$q.defer();return force===!0&&(_identity=void 0),angular.isDefined(_identity)?(deferred.resolve(_identity),deferred.promise):(localStorageService.get("token")?(_identity="LOGIN_SUCCESS",_authenticated=!0):(_identity="LOGIN_FAILED",_authenticated=!1),deferred.resolve(_identity),deferred.promise)}function isAuthenticated(){return _authenticated}function isIdentityResolved(){return angular.isDefined(_identity)}var _identity,_authenticated=!1,service={authenticate:authenticate,hasAnyAuthority:hasAnyAuthority,hasAuthority:hasAuthority,identity:identity,isAuthenticated:isAuthenticated,isIdentityResolved:isIdentityResolved};return service}angular.module("vietteltv").factory("Principal",Principal),Principal.$inject=["$q","Account","localStorageService"]}(),app.factory("authInterceptor",["$rootScope","$q","$location","$injector","localStorageService","SETTINGS","CONSTANT",function($rootScope,$q,$location,$injector,localStorageService,SETTINGS,CONSTANT){var inFlightAuthRequest=null;return{request:function(config){config.headers=config.headers||{};var token=localStorageService.get("token");return $rootScope.token=token,token?(config.url.indexOf("watches/fvod/prepare")<0&&(config.headers.Authorization="Bearer "+token.access_token),config):(config.headers.Authorization="Bearer "+SETTINGS.guest_access_token,config)},responseError:function(response){if(401===response.status&&"C0202"==response.data.error.code){var deferred=$q.defer();if(!inFlightAuthRequest){var Auth=$injector.get("Auth");inFlightAuthRequest=Auth.renewToken()}return inFlightAuthRequest.then(function(r){inFlightAuthRequest=null,$injector.get("$http")(response.config).then(function(resp){deferred.resolve(resp)},function(resp){deferred.reject()})},function(response){inflightAuthRequest=null,deferred.reject()}),deferred.promise}return response||$q.when(response)}}}]),app.factory("tokenExpiredInterceptor",["$rootScope","$q","$location","$injector","localStorageService","SETTINGS","CONSTANT",function($rootScope,$q,$location,$injector,localStorageService,SETTINGS,CONSTANT){var count=0;return{requestError:function(reject){$injector.get("Auth");if(count++,count>8)return $q.reject("");var token=localStorageService.get("token"),param={refresh_token:token.refresh_token,client_id:SETTINGS.client_id,hash:CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA1(token.refresh_token+SETTINGS.client_id,SETTINGS.app_secret))},requestUrl=CONSTANT.API_HOST+"/ott/accounts/delegation";$injector.get("$http").post(requestUrl,{data:param,headers:{"Content-Type":"application/json"}}).then(function(response){if("undefined"!=typeof response.access_token&&"undefined"!=typeof response.expiration_date&&"undefined"!=typeof response.refresh_token&&"undefined"!=typeof response.refresh_token_expiration_date){var token={access_token:response.access_token,token_secret:response.token_secret,login_access_token:response.access_token,refresh_token:response.refresh_token,expiration_date:response.expiration_date,refresh_token_expiration_date:response.refresh_token_expiration_date,temp_password:response.temp_password};localStorageService.set("token",token)}},function(response){})}}}]),angular.module("vietteltv").controller("Controller",Controller),Controller.$inject=["$rootScope","$scope","$state","$timeout","$document","FocusUtil","FocusConstant","focusController","CONSTANT","DataService","$http","UltilService","VideoService","Principal","LoginService","Auth","toaster"],$("document").ready(function(){$(".login-input").smartTvKeyboard({title:null,defLang:null,defMode:null,layouts:{en:smartTvKeyboardLayouts.enBoxed},type:"inline",openOn:"click focus",onEnter:null,onCancel:null,useDirectEdit:!0,useNavKeys:!0,navKeys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,EXIT:8,RETURN:10009}})}),angular.module("vietteltv").run(["$templateCache",function($templateCache){$templateCache.put("views/about.html","<p>This is the about view.</p>"),$templateCache.put("views/main.html",'<div ng-style="{\'opacity\':bgImgCoverOpacity,\'width\':bgImgCoverWidth}" class="bg-img-cover" ng-hide="currentDepth===DEPTH.CATEGORY"></div> <div id="menu-container" class="move-container menu-container" ng-show="currentDepth===DEPTH.INDEX"> <div class="logo"></div> <div class="category-menu-header"> <h1 class="category-menu-header-h1" ng-bind-html="focusedMenu.this.name[0].text"></h1> </div> <div class="category-menu-list"> <category-menu-list id="11" title="Thư mục"></category-menu-list> </div> <div class="spotlight-overview"> <img src="images/spotlight_movie.jpg" alt="" class="spotlight-overview-img"> </div> </div> <div class="home-page"> <div id="move-container" class="move-container overview-container" ng-class="{ \'opacity-dark\':isOverviewDark, \'opacity-light\':!isOverviewDark,\'reset-position\':currentDepth===DEPTH.DETAIL}"> <div class="spotlight-page" ng-show="currentDepth===DEPTH.INDEX && currentDepthZone===DEPTH_ZONE.INDEX.SPOTLIGHT"> <div class="logo"></div> <!-- OVERVIEW --> <div class="overview" ng-class="{ \'spotlight\':currentDepth===DEPTH.INDEX && currentDepthZone===DEPTH_ZONE.INDEX.SPOTLIGHT}"> <div class="font-header" ng-bind-html="overview.firstTitle"></div> <div class="font-header-small" ng-bind-html="overview.secondTitle"></div> </div> <!-- page: SPOTLIGHT  --> <div class="overview desc font-body" ng-show="currentDepth===DEPTH.INDEX && currentDepthZone===DEPTH_ZONE.INDEX.SPOTLIGHT" ng-bind-html="overview.description"></div> <div class="btn-wrapper" ng-show="currentDepth===DEPTH.INDEX && currentDepthZone===DEPTH_ZONE.INDEX.SPOTLIGHT"> <div focusable="{depth: DEPTH.INDEX,initialFocus: true, name: \'btnView\'}" class="btn btn-gap" ng-class="{ \'btn-view\':true, \'btn-resume\': false}" on-selected="btnViewMoreSelected($event,overview)" on-focused="buttonFocusInSpotLight($event, $originalEvent)"> <div class="btn-icon"></div> <!--<div class="btn-icon icon-caph icon-caph-view"></div>--> </div> </div> </div> <div class="channel-page" ng-show="currentDepth===DEPTH.INDEX && currentDepthZone===DEPTH_ZONE.INDEX.CHANNEL"> <!--<div class="overview" ng-class="{ \'channel\':currentDepth===DEPTH.INDEX && currentDepthZone===DEPTH_ZONE.INDEX.CHANNEL}">--> <div class="overview channel-headline"> <div class="font-header" ng-bind-html="overview.name"></div> </div> <div class="headline-program"> <ul class="headline-program-ul"> <li class="headline-program-li"> <div class="live-label"><span class="live-label-span">Đang phát</span></div> <div class="live-program"><span class="live-program-span">Giọng hát Việt</span></div> </li> <li class="headline-program-li"> <div class="next-label"><span class="next-label-span">Tiếp theo</span></div> <div class="next-program"><span class="next-program-span">Ơi giời cậu đây rồi</span></div> </li> </ul> </div> <!--<div class="channel-prewatch-wraper">\r\n            <div class="channel-prewatch">\r\n                <div class="loader" ng-show="channelWatchPreviewLoaded !== true"></div>\r\n                <video id="videoPrewatch" autoplay ng-hide="channelWatchPreviewLoaded !== true"></video>\r\n            </div>\r\n        </div>--> </div> <div class="category-section" ng-show="(currentDepth===DEPTH.INDEX  &&  currentDepthZone===DEPTH_ZONE.INDEX.CATEGORY) || currentDepth===DEPTH.DETAIL"> <!-- OVERVIEW --> <div class="overview" ng-show="overview.duration"> <div class="font-header" ng-bind-html="overview.firstTitle"></div> <div class="font-header-small" ng-bind-html="overview.secondTitle"></div> <ul class="short-info"> <li class="short-info-li short-info-1"><span class="short-info-1">{{overview.contentFormat}}</span></li> <li class="short-info-li short-info-2"><span class="short-info-2"> | {{overview.duration}} phút | </span></li> <li class="short-info-li short-info-3"><span class="short-info-3">{{overview.country}} | </span></li> <li class="short-info-li short-info-3"><span class="short-info-3">{{overview.genres}}</span></li> </ul> </div> <!-- page: INDEX (OVERVIEW) --> <div class="page" ng-class="{ \'page-fade-in\': currentDepth===DEPTH.INDEX}" ng-show="overview.duration"> <div class="overview desc font-body" ng-bind-html="overview.description.substring(0,300)"></div> </div> <div class="page" ng-class="{ \'page-fade-in\': currentDepth===DEPTH.DETAIL}" ng-show="overview.duration"> <!-- page: DETAIL (OVERVIEW) --> <div class="overview desc font-body" ng-show="currentDepth===DEPTH.DETAIL" ng-bind-html="overview.description"></div> <div class="vod-directors" ng-show="currentDepth===DEPTH.DETAIL" ng-bind-html="overview.directors"></div> <div class="vod-actors" ng-show="currentDepth===DEPTH.DETAIL" ng-bind-html="overview.actors"></div> <div class="vod-detail-btnGroup"> <div class="btn-wrapper vod-detail-play" ng-show="currentDepth===DEPTH.DETAIL"> <div focusable="{depth: DEPTH.DETAIL, initialFocus: true,name: \'btnPlay\'}" class="btn btn-gap" ng-class="{ \'btn-play\':true, \'btn-resume\': false}" on-focused="btnVodPlayFocusInDetail($event, $originalEvent)" on-selected="btnVodPlaySelected($event)"> <div class="btn-icon"></div> <!--<div class="btn-icon icon-caph icon-caph-play"></div>--> </div> </div> <div class="btn-wrapper vod-detail-episode" ng-show="currentDepth===DEPTH.DETAIL && (overview.isSeries || overview.isVodInSeries) && !isEpisodeBtnNotShown"> <div focusable="{depth: DEPTH.DETAIL, name: \'btnEpisode\'}" class="btn btn-gap" ng-class="{ \'btn-vod-episode\':true, \'btn-resume\': false}" on-focused="btnVodEpisodeFocusInDetail($event, $originalEvent)" on-selected="selectPlayButton()"> <div class="btn-icon"></div> <!--<div class="btn-icon icon-caph icon-caph-play"></div>--> </div> </div> </div> <!-- page: Related VOD (LIST) --> </div> </div> </div> <div class="related-play-list" ng-class="{\'related-show\':isRelatedShown,\'related-hide\':!isRelatedShown}" ng-show="isRelatedShown"> <related-play-list ng-show="currentDepth===DEPTH.DETAIL" title="Nội dung liên quan"></related-play-list> </div> <div class="episode-play-list" ng-class="{\'episode-show\':isEpisodeShown,\'episode-hide\':!isEpisodeShown}"> <episode-play-list ng-show="currentDepth===DEPTH.DETAIL" title="Danh sách tập phim"></episode-play-list> </div> <!-- page: INDEX (LIST)  --> <div class="list-wrapper page" ng-class="{ \'page-fade-in\': currentDepth===DEPTH.INDEX, \'list-wrapper-spotlight\': currentDepthZone===DEPTH_ZONE.INDEX.SPOTLIGHT}" ng-hide="currentDepth===DEPTH.DETAIL || currentDepth===DEPTH.PLAYER"> <div id="list-category" class="list-category"> <channel-list id="0" title="Kênh TV"></channel-list> <!--<play-list ng-repeat="category in homeCategoryList" id="{{category.index}}" title="{{category.name}}"></play-list>--> <!--<play-list id="1" title="homeCategoryList"></play-list>--> <play-list id="1"></play-list> <play-list id="2"></play-list> <play-list id="3"></play-list> <play-list id="4"></play-list> <play-list id="5"></play-list> <play-list id="6"></play-list> <play-list id="7"></play-list> <play-list id="8" ng-if="dataCategory.length <= 8"></play-list> <!--<play-list-sm id="{{CATEGORY.NUMBERS}}" title="Numbers"></play-list-sm>--> </div> </div> </div> <div class="category-page" ng-show="currentDepth===DEPTH.CATEGORY"> <div class="category-page-header"> <div class="overview" ng-show="overview && currentDepthZone === DEPTH_ZONE.CATEGORY.VOD"> <div class="font-header" ng-bind-html="overview.firstTitle"></div> <div class="font-header-small" ng-bind-html="overview.secondTitle"></div> <ul class="short-info" ng-show="overview.contentFormat"> <li class="short-info-li short-info-1"><span class="short-info-1">{{overview.contentFormat}}</span></li> <li class="short-info-li short-info-2"><span class="short-info-2"> | {{overview.duration}} phút | </span></li> <li class="short-info-li short-info-3"><span class="short-info-3">{{overview.country}} | </span></li> <li class="short-info-li short-info-3"><span class="short-info-3">{{overview.genres}}</span></li> </ul> </div> <div class="overview channel" ng-show="overview && currentDepthZone === DEPTH_ZONE.CATEGORY.CHANNEL"> <div class="font-header" ng-bind-html="overview.firstTitle"></div> <div class="font-header-small" ng-bind-html="overview.secondTitle"></div> </div> </div> <div class="w3-sidebar w3-bar-block w3-card-2 w3-animate-left category-sidebar" id="mySidebar" ng-class="{\'collapsed\':isVodCategoryOpened}"> <!--<button class="w3-bar-item w3-button w3-large" onclick="w3_close()">Close &times;</button>--> <a href="#" ng-if="currentDepthZone === DEPTH_ZONE.CATEGORY.CHANNEL" id="sidebar-category-item-{{$index}}" focusable="{depth: DEPTH.CATEGORY,initialFocus: {{$index === 0}},name:category-vod-item-{{$index}}}" data-focusable-group="SIDEBAR_CATEGORY" class="w3-bar-item w3-button" ng-repeat="item in sidebarCategories" on-focused="onSidebarCategoryFocused($event,item, $index)" ng-bind-html="item.name"></a> <a href="#" ng-if="currentDepthZone === DEPTH_ZONE.CATEGORY.VOD" id="sidebar-category-item-{{$index}}" focusable="{depth: DEPTH.CATEGORY,initialFocus: {{$index === 0}},name:category-vod-item-{{$index}}}" data-focusable-group="SIDEBAR_CATEGORY" class="w3-bar-item w3-button" ng-repeat="item in sidebarCategories" on-focused="onSidebarCategoryFocused($event,item, $index)" ng-bind-html="item.this.name[0].text"></a> </div> <div id=" main" class="category-container-wrapper" ng-class="{ \'opened\':isVodCategoryOpened}"> <div class="nav-category-title"> <div class="nav-category-icon"></div> <div class="category-title" ng-bind-html="selectedCategoryMenu"></div> </div> <div class="category-container"> <div id="category-vod-item-{{$index}}" class="item category-vod-item" ng-class="{ \'channel-item\':currentDepthZone === DEPTH_ZONE.CATEGORY.CHANNEL}" ng-repeat="item in vodListByCategory track by $index" focusable="{depth: DEPTH.CATEGORY}\r\n           " data-focusable-group="VOD_LIST_CATEGORY" data-focusable-next-focus-left="{{$index%8===0? \'group:SIDEBAR_CATEGORY\':null}}" on-focused="onCategoryVodFocused($event, item, this, $index)" on-blurred="onVodBlurred($event, listCategory, item)" on-selected="onCategoryVodSelected($event, item,\r\n            $index)"> <div class="loader" ng-show="item.loaded===false"></div> <div class="content" ng-hide="item.loaded===false" style="background: url({{item.photoUrl || \'\'}});-webkit-background-size:100% 100%"> </div> </div> </div> </div> </div>'),$templateCache.put("views/templates/categoryMenuList.html",'<div class="list-area-menu"> <div class="title font-label">{{title}}</div> <caph-list id="list-{{listCategory}}" container-class="list-container" wrapper-class="list-scroll-wrapper" items="item in menuArray" on-scroll-start="onScrollStart($context)" on-scroll-finish="onScrollFinish($context)" mouse-scroll-area-size="40"> <div id="item-{{$index}}" class="item item-playlist" focusable data-focusable-depth="1" on-focused="onCategoryMenuFocused($event, listCategory, this,$index)" on-blurred="onCategoryMenuBlurred($event, listCategory, this)" on-selected="onCategoryMenuSelected($event, listCategory, this,$index)"> <div class="loader" ng-show="item.loaded===false"></div> <div class="content" ng-hide="item.loaded===false" style="background: {{item.color || \'\'}};-webkit-background-size:100% 100%"> <div class="playlist-text font-label"> <h2> {{item.this.name[0].text}} </h2> </div> </div> </div> </caph-list> </div>'),$templateCache.put("views/templates/channelList.html",'<div class="list-area channel-list" ng-class="{\'list-fadeout\': currentCategory !== listCategory && currentDepthZone !== DEPTH_ZONE.INDEX.SPOTLIGHT}"> <div class="title font-label" ng-class="{ \'title-opacity\': currentCategory !== listCategory}">{{title}}</div> <caph-list id="list-{{listCategory}}" container-class="channel-list-container" wrapper-class="list-scroll-wrapper" items="item in dataCategory[listCategory]" on-scroll-start="onScrollStart($context)" on-scroll-finish="onScrollFinish($context)" mouse-scroll-area-size="40"> <div id="item-{{$index}}" class="item channel" focusable data-focusable-depth="1" on-focused="onChannelFocused($event, listCategory, this)" on-blurred="onChannelBlurred($event, listCategory, this)" on-selected="onChannelSelected($event, listCategory, this)"> <div class="loader" ng-show="item.loaded===false"></div> <div class="content" ng-hide="item.loaded === false" style="background: url({{item.photoUrl || \'\'}});-webkit-background-size:100% 100%"> </div> </div> </caph-list> </div>'),$templateCache.put("views/templates/episodePlaylist.html",'<div class="list-area"> <div class="title font-label">{{title}} Tập phim</div> <caph-list id="list-episode-vod" container-class="list-container" wrapper-class="list-scroll-wrapper" items="item in episodePlaylist" mouse-scroll-area-size="30"> <div class="item" focusable="{depth: DEPTH.DETAIL}" on-focused="onEpisodeVodFocused($event, CATEGORY.EPISODE_PLAY_LIST, this)" on-selected="onEpisodeVodSelected($event, CATEGORY.EPISODE_PLAY_LIST, this,$index)"> <div class="loader" ng-show="item.loaded === false"></div> <div class="content" ng-hide="item.loaded === false" style="background: url({{item.photoUrl || \'\'}});-webkit-background-size:100% 100%"> <div class="text font-label"> <div class="font-info">{{item.name}}</div> </div> </div> </div> </caph-list> </div>'),$templateCache.put("views/templates/playlist.html",'<div class="list-area" ng-class="{\'list-fadeout\': currentCategory !== listCategory,\'second-category\':currentCategory === 0 && id === 1}"> <!-- opacity 0.2 --> <div class="title font-label" ng-class="{\'title-opacity\': currentCategory !== listCategory}">{{homeCategoryNameList[id-1].name}}</div> <caph-list id="list-{{listCategory}}" container-class="list-container" wrapper-class="list-scroll-wrapper" items="item in dataCategory[listCategory]" on-scroll-start="onScrollStart($context)" on-scroll-finish="onScrollFinish($context)" mouse-scroll-area-size="40" loop> <div id="{{listCategory}}-{{item.id}}" class="item" ng-class="{\'item-blank\': item.isBlank === true}" focusable data-focusable-depth="1" on-focused="onVodFocused($event, listCategory, item, $index)" on-blurred="onVodBlurred($event, listCategory, this)" on-selected="onVodSelected($event, listCategory, item, $index)"> <div class="loader" ng-show="item.loaded === false"></div> <div class="content" ng-hide="item.loaded === false" style="background: url({{item.photoUrl || \'\'}});-webkit-background-size:100% 100%"> <!--<div class="text font-label">\r\n                    <div class="font-info">{{item.name}}</div>\r\n                </div>--> </div> </div> </caph-list> </div>'),
$templateCache.put("views/templates/playlistSm.html",'<div class="list-area" ng-class="{\'list-fadeout\': currentCategory !== listCategory}"> <div class="title font-label" ng-class="{\'title-opacity\': currentCategory !== listCategory}">{{title}}</div> <caph-list id="list-{{listCategory}}" container-class="list-container" wrapper-class="list-scroll-wrapper" items="item in dataCategory[listCategory]" on-scroll-start="onScrollStart($context)" on-scroll-finish="onScrollFinish($context)" mouse-scroll-area-size="40"> <div id="item-{{$index}}" class="item item-playlist" focusable="{{focusable}}" on-focused="focus($event, listCategory, this)" on-blurred="blur($event, listCategory, this)" on-selected="selected($event, listCategory, this)"> <div class="loader" ng-show="item.loaded === false"></div> <div class="content" ng-hide="item.loaded === false" style="background: url({{item.photo_urls[0].url || \'\'}});-webkit-background-size:100% 100%"> <div class="playlist-text font-label"><div class="font-info">Small Item</div>{{item.name}}</div> </div> </div> </caph-list> </div>'),$templateCache.put("views/templates/relatedPlaylist.html",'<div class="list-area"> <div class="title font-label">{{title}} Nội dung liên quan</div> <caph-list id="list-related-vod" container-class="list-container" wrapper-class="list-scroll-wrapper" items="item in relatedPlaylist" mouse-scroll-area-size="30"> <div class="item" focusable="{depth: DEPTH.DETAIL,nextFocus:{up:\'btnPlay\'}}" on-focused="onRelatedVodFocused($event, CATEGORY.RELATED_PLAY_LIST, item,$index)" on-selected="onRelatedVodSelected($event, CATEGORY.RELATED_PLAY_LIST, item,$index)"> <div class="loader" ng-show="item.loaded === false"></div> <div class="content" ng-hide="item.loaded === false" style="background: url({{item.photoUrl || \'\'}});-webkit-background-size:100% 100%"> <div class="text font-label"> <!--<div class="font-info">{{item.name}}</div>{{item.name}}</div>\r\n            </div>--> </div> </div></div></caph-list> </div>')}]);